const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NotFound-B0m5iaQ3.js","assets/index-DgUKgk1k.js","assets/index-B46MRfdh.css","assets/ErrorPage-CBulQK1d.js"])))=>i.map(i=>d[i]);
import{r as e,f as t,R as n,e as r,s as o,Y as i,y as s,n as a,$ as l,g as c,V as d,K as u,h,o as p,A as f,i as m,G as g,k as b,l as x,m as y,v,T as w,t as k,p as C,w as S,q as N,x as j,B as E,u as M,j as T,C as O,D as A,E as D,H as I,I as R,J as P,L,N as $,O as z,P as F,Q as B,S as U,U as V,W as _,X as H,Z as W,a0 as q,a1 as K,a2 as J,a3 as Y,a4 as G,a5 as X,a6 as Q,a7 as Z,a8 as ee,a9 as te,aa as ne,ab as re,ac as oe,M as ie,ad as se,ae,af as le,ag as ce,ah as de,ai as ue,aj as he,ak as pe,al as fe,am as me,an as ge,ao as be,ap as xe,aq as ye,ar as ve,as as we,at as ke,au as Ce,av as Se,aw as Ne,ax as je,ay as Ee,d as Me,az as Te,aA as Oe,aB as Ae,aC as De,aD as Ie,_ as Re}from"./index-DgUKgk1k.js";import{g as Pe,a as Le,b as $e,c as ze}from"./templates-Deg9zX4d.js";import{P as Fe}from"./PreviewModal-DHgUa1PG.js";function Be({onFocus:i}){let[s,a]=e.useState(!0),l=t();return s?n.createElement(r,{as:"button",type:"button",features:o.Focusable,onFocus:e=>{e.preventDefault();let t,n=50;t=requestAnimationFrame(function e(){if(n--<=0)t&&cancelAnimationFrame(t);else if(i()){if(cancelAnimationFrame(t),!l.current)return;a(!1)}else t=requestAnimationFrame(e)})}}):null}const Ue=e.createContext(null);function Ve({children:t}){let n=e.useRef({groups:new Map,get(e,t){var n;let r=this.groups.get(e);r||(r=new Map,this.groups.set(e,r));let o=null!=(n=r.get(t))?n:0;return r.set(t,o+1),[Array.from(r.keys()).indexOf(t),function(){let e=r.get(t);e>1?r.set(t,e-1):r.delete(t)}]}});return e.createElement(Ue.Provider,{value:n},t)}function _e(t){let n=e.useContext(Ue);if(!n)throw new Error("You must wrap your component in a <StableCollection>");let r=e.useId(),[o,i]=n.current.get(t,r);return e.useEffect(()=>i,[]),o}var He,We,qe,Ke=((qe=Ke||{})[qe.Forwards=0]="Forwards",qe[qe.Backwards=1]="Backwards",qe),Je=((We=Je||{})[We.Less=-1]="Less",We[We.Equal=0]="Equal",We[We.Greater=1]="Greater",We),Ye=((He=Ye||{})[He.SetSelectedIndex=0]="SetSelectedIndex",He[He.RegisterTab=1]="RegisterTab",He[He.UnregisterTab=2]="UnregisterTab",He[He.RegisterPanel=3]="RegisterPanel",He[He.UnregisterPanel=4]="UnregisterPanel",He);let Ge={0(e,t){var n;let r=g(e.tabs,e=>e.current),o=g(e.panels,e=>e.current),i=r.filter(e=>{var t;return!(null!=(t=e.current)&&t.hasAttribute("disabled"))}),s={...e,tabs:r,panels:o};if(t.index<0||t.index>r.length-1){let n=m(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>m(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(0===i.length)return s;let o=m(n,{0:()=>r.indexOf(i[0]),1:()=>r.indexOf(i[i.length-1])});return{...s,selectedIndex:-1===o?e.selectedIndex:o}}let a=r.slice(0,t.index),l=[...r.slice(t.index),...a].find(e=>i.includes(e));if(!l)return s;let c=null!=(n=r.indexOf(l))?n:e.selectedIndex;return-1===c&&(c=e.selectedIndex),{...s,selectedIndex:c}},1(e,t){if(e.tabs.includes(t.tab))return e;let n=e.tabs[e.selectedIndex],r=g([...e.tabs,t.tab],e=>e.current),o=e.selectedIndex;return e.info.current.isControlled||(o=r.indexOf(n),-1===o&&(o=e.selectedIndex)),{...e,tabs:r,selectedIndex:o}},2:(e,t)=>({...e,tabs:e.tabs.filter(e=>e!==t.tab)}),3:(e,t)=>e.panels.includes(t.panel)?e:{...e,panels:g([...e.panels,t.panel],e=>e.current)},4:(e,t)=>({...e,panels:e.panels.filter(e=>e!==t.panel)})},Xe=e.createContext(null);function Qe(t){let n=e.useContext(Xe);if(null===n){let e=new Error(`<${t} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,Qe),e}return n}Xe.displayName="TabsDataContext";let Ze=e.createContext(null);function et(t){let n=e.useContext(Ze);if(null===n){let e=new Error(`<${t} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,et),e}return n}function tt(e,t){return m(t.type,Ge,e,t)}Ze.displayName="TabsActionsContext";let nt=f.RenderStrategy|f.Static;let rt=i(function(t,n){var r,o;let i=e.useId(),{id:h=`headlessui-tabs-tab-${i}`,disabled:f=!1,autoFocus:g=!1,...j}=t,{orientation:E,activation:M,selectedIndex:T,tabs:O,panels:A}=Qe("Tab"),D=et("Tab"),I=Qe("Tab"),[R,P]=e.useState(null),L=e.useRef(null),$=s(L,n,P);a(()=>D.registerTab(L),[D,L]);let z=_e("tabs"),F=O.indexOf(L);-1===F&&(F=z);let B=F===T,U=p(e=>{let t=e();if(t===b.Success&&"auto"===M){let e=x(L.current),t=I.tabs.findIndex(t=>t.current===e);-1!==t&&D.change(t)}return t}),V=p(e=>{let t=O.map(e=>e.current).filter(Boolean);if(e.key===y.Space||e.key===y.Enter)return e.preventDefault(),e.stopPropagation(),void D.change(F);switch(e.key){case y.Home:case y.PageUp:return e.preventDefault(),e.stopPropagation(),U(()=>v(t,w.First));case y.End:case y.PageDown:return e.preventDefault(),e.stopPropagation(),U(()=>v(t,w.Last))}return U(()=>m(E,{vertical:()=>e.key===y.ArrowUp?v(t,w.Previous|w.WrapAround):e.key===y.ArrowDown?v(t,w.Next|w.WrapAround):b.Error,horizontal:()=>e.key===y.ArrowLeft?v(t,w.Previous|w.WrapAround):e.key===y.ArrowRight?v(t,w.Next|w.WrapAround):b.Error}))===b.Success?e.preventDefault():void 0}),_=e.useRef(!1),H=p(()=>{var e;_.current||(_.current=!0,null==(e=L.current)||e.focus({preventScroll:!0}),D.change(F),k(()=>{_.current=!1}))}),W=p(e=>{e.preventDefault()}),{isFocusVisible:q,focusProps:K}=l({autoFocus:g}),{isHovered:J,hoverProps:Y}=C({isDisabled:f}),{pressed:G,pressProps:X}=S({disabled:f}),Q=c({selected:B,hover:J,active:G,focus:q,autofocus:g,disabled:f}),Z=d({ref:$,onKeyDown:V,onMouseDown:W,onClick:H,id:h,role:"tab",type:N(t,R),"aria-controls":null==(o=null==(r=A[F])?void 0:r.current)?void 0:o.id,"aria-selected":B,tabIndex:B?0:-1,disabled:f||void 0,autoFocus:g},K,Y,X);return u()({ourProps:Z,theirProps:j,slot:Q,defaultTag:"button",name:"Tabs.Tab"})}),ot=i(function(t,r){let{defaultIndex:o=0,vertical:i=!1,manual:l=!1,onChange:d,selectedIndex:f=null,...m}=t;const b=i?"vertical":"horizontal",x=l?"manual":"auto";let y=null!==f,v=h({isControlled:y}),w=s(r),[k,C]=e.useReducer(tt,{info:v,selectedIndex:null!=f?f:o,tabs:[],panels:[]}),S=c({selectedIndex:k.selectedIndex}),N=h(d||(()=>{})),j=h(k.tabs),E=e.useMemo(()=>({orientation:b,activation:x,...k}),[b,x,k]),M=p(e=>(C({type:1,tab:e}),()=>C({type:2,tab:e}))),T=p(e=>(C({type:3,panel:e}),()=>C({type:4,panel:e}))),O=p(e=>{A.current!==e&&N.current(e),y||C({type:0,index:e})}),A=h(y?t.selectedIndex:k.selectedIndex),D=e.useMemo(()=>({registerTab:M,registerPanel:T,change:O}),[]);a(()=>{C({type:0,index:null!=f?f:o})},[f]),a(()=>{if(void 0===A.current||k.tabs.length<=0)return;let e=g(k.tabs,e=>e.current);e.some((e,t)=>k.tabs[t]!==e)&&O(e.indexOf(k.tabs[A.current]))});let I={ref:w},R=u();return n.createElement(Ve,null,n.createElement(Ze.Provider,{value:D},n.createElement(Xe.Provider,{value:E},E.tabs.length<=0&&n.createElement(Be,{onFocus:()=>{var e,t;for(let n of j.current)if(0===(null==(e=n.current)?void 0:e.tabIndex))return null==(t=n.current)||t.focus(),!0;return!1}}),R({ourProps:I,theirProps:m,slot:S,defaultTag:"div",name:"Tabs"}))))}),it=i(function(e,t){let{orientation:n,selectedIndex:r}=Qe("Tab.List"),o=s(t),i=c({selectedIndex:r}),a=e,l={ref:o,role:"tablist","aria-orientation":n};return u()({ourProps:l,theirProps:a,slot:i,defaultTag:"div",name:"Tabs.List"})}),st=i(function(e,t){let{selectedIndex:n}=Qe("Tab.Panels"),r=s(t),o=c({selectedIndex:n}),i=e,a={ref:r};return u()({ourProps:a,theirProps:i,slot:o,defaultTag:"div",name:"Tabs.Panels"})}),at=i(function(t,o){var i,h,p,f;let m=e.useId(),{id:g=`headlessui-tabs-panel-${m}`,tabIndex:b=0,...x}=t,{selectedIndex:y,tabs:v,panels:w}=Qe("Tab.Panel"),k=et("Tab.Panel"),C=e.useRef(null),S=s(C,o);a(()=>k.registerPanel(C),[k,C]);let N=_e("panels"),j=w.indexOf(C);-1===j&&(j=N);let E=j===y,{isFocusVisible:M,focusProps:T}=l(),O=c({selected:E,focus:M}),A=d({ref:S,id:g,role:"tabpanel","aria-labelledby":null==(h=null==(i=v[j])?void 0:i.current)?void 0:h.id,tabIndex:E?b:-1},T),D=u();return E||null!=(p=x.unmount)&&!p||null!=(f=x.static)&&f?D({ourProps:A,theirProps:x,slot:O,defaultTag:"div",features:nt,visible:E,name:"Tabs.Panel"}):n.createElement(r,{"aria-hidden":"true",...A})}),lt=Object.assign(rt,{Group:ot,List:it,Panels:st,Panel:at});const ct="resume-builder-session-id";function dt(){let e=localStorage.getItem(ct);return e||(e="undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(ct,e)),e}const ut=e=>"experience"===e.type||!e.type&&"Experience"===e.name,ht=e=>"education"===e.type||!e.type&&"Education"===e.name,pt=e=>{const t=new Set;return e.forEach(e=>{(ut(e)||ht(e))&&Array.isArray(e.content)&&e.content.forEach(e=>{e.icon&&"string"==typeof e.icon&&""!==e.icon.trim()&&t.add(e.icon)}),"icon-list"===e.type&&Array.isArray(e.content)&&e.content.forEach(e=>{e.icon&&"string"==typeof e.icon&&""!==e.icon.trim()&&t.add(e.icon)})}),Array.from(t)};
/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */
function ft(e){return null==e}var mt={isNothing:ft,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:ft(e)?[]:[e]},repeat:function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,r,o,i;if(t)for(n=0,r=(i=Object.keys(t)).length;n<r;n+=1)e[o=i[n]]=t[o];return e}};function gt(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function bt(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=gt(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}bt.prototype=Object.create(Error.prototype),bt.prototype.constructor=bt,bt.prototype.toString=function(e){return this.name+": "+gt(this,e)};var xt=bt;function yt(e,t,n,r,o){var i="",s="",a=Math.floor(o/2)-1;return r-t>a&&(t=r-a+(i=" ... ").length),n-r>a&&(n=r+a-(s=" ...").length),{str:i+e.slice(t,n).replace(/\t/g,"â†’")+s,pos:r-t+i.length}}function vt(e,t){return mt.repeat(" ",t-e.length)+e}var wt=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,r=/\r?\n|\r|\0/g,o=[0],i=[],s=-1;n=r.exec(e.buffer);)i.push(n.index),o.push(n.index+n[0].length),e.position<=n.index&&s<0&&(s=o.length-2);s<0&&(s=o.length-1);var a,l,c="",d=Math.min(e.line+t.linesAfter,i.length).toString().length,u=t.maxLength-(t.indent+d+3);for(a=1;a<=t.linesBefore&&!(s-a<0);a++)l=yt(e.buffer,o[s-a],i[s-a],e.position-(o[s]-o[s-a]),u),c=mt.repeat(" ",t.indent)+vt((e.line-a+1).toString(),d)+" | "+l.str+"\n"+c;for(l=yt(e.buffer,o[s],i[s],e.position,u),c+=mt.repeat(" ",t.indent)+vt((e.line+1).toString(),d)+" | "+l.str+"\n",c+=mt.repeat("-",t.indent+d+3+l.pos)+"^\n",a=1;a<=t.linesAfter&&!(s+a>=i.length);a++)l=yt(e.buffer,o[s+a],i[s+a],e.position-(o[s]-o[s+a]),u),c+=mt.repeat(" ",t.indent)+vt((e.line+a+1).toString(),d)+" | "+l.str+"\n";return c.replace(/\n$/,"")},kt=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Ct=["scalar","sequence","mapping"];var St=function(e,t){var n,r;if(t=t||{},Object.keys(t).forEach(function(t){if(-1===kt.indexOf(t))throw new xt('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(n=t.styleAliases||null,r={},null!==n&&Object.keys(n).forEach(function(e){n[e].forEach(function(t){r[String(t)]=e})}),r),-1===Ct.indexOf(this.kind))throw new xt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function Nt(e,t){var n=[];return e[t].forEach(function(e){var t=n.length;n.forEach(function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)}),n[t]=e}),n}function jt(e){return this.extend(e)}jt.prototype.extend=function(e){var t=[],n=[];if(e instanceof St)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new xt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach(function(e){if(!(e instanceof St))throw new xt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new xt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new xt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(e){if(!(e instanceof St))throw new xt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(jt.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=Nt(r,"implicit"),r.compiledExplicit=Nt(r,"explicit"),r.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(r.compiledImplicit,r.compiledExplicit),r};var Et=jt,Mt=new St("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),Tt=new St("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),Ot=new St("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),At=new Et({explicit:[Mt,Tt,Ot]});var Dt=new St("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});var It=new St("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function Rt(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Pt(e){return 48<=e&&e<=55}function Lt(e){return 48<=e&&e<=57}var $t=new St("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n=e.length,r=0,o=!1;if(!n)return!1;if("-"!==(t=e[r])&&"+"!==t||(t=e[++r]),"0"===t){if(r+1===n)return!0;if("b"===(t=e[++r])){for(r++;r<n;r++)if("_"!==(t=e[r])){if("0"!==t&&"1"!==t)return!1;o=!0}return o&&"_"!==t}if("x"===t){for(r++;r<n;r++)if("_"!==(t=e[r])){if(!Rt(e.charCodeAt(r)))return!1;o=!0}return o&&"_"!==t}if("o"===t){for(r++;r<n;r++)if("_"!==(t=e[r])){if(!Pt(e.charCodeAt(r)))return!1;o=!0}return o&&"_"!==t}}if("_"===t)return!1;for(;r<n;r++)if("_"!==(t=e[r])){if(!Lt(e.charCodeAt(r)))return!1;o=!0}return!(!o||"_"===t)},construct:function(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!mt.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),zt=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var Ft=/^[-+]?[0-9]+e/;var Bt=new St("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!zt.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||mt.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(mt.isNegativeZero(e))return"-0.0";return n=e.toString(10),Ft.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),Ut=At.extend({implicit:[Dt,It,$t,Bt]}),Vt=Ut,_t=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Ht=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var Wt=new St("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==_t.exec(e)||null!==Ht.exec(e))},construct:function(e){var t,n,r,o,i,s,a,l,c=0,d=null;if(null===(t=_t.exec(e))&&(t=Ht.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,o=+t[3],!t[4])return new Date(Date.UTC(n,r,o));if(i=+t[4],s=+t[5],a=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(d=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(d=-d)),l=new Date(Date.UTC(n,r,o,i,s,a,c)),d&&l.setTime(l.getTime()-d),l},instanceOf:Date,represent:function(e){return e.toISOString()}});var qt=new St("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),Kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var Jt=new St("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,o=e.length,i=Kt;for(n=0;n<o;n++)if(!((t=i.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,r=e.replace(/[\r\n=]/g,""),o=r.length,i=Kt,s=0,a=[];for(t=0;t<o;t++)t%4==0&&t&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|i.indexOf(r.charAt(t));return 0===(n=o%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===n?(a.push(s>>10&255),a.push(s>>2&255)):12===n&&a.push(s>>4&255),new Uint8Array(a)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,r="",o=0,i=e.length,s=Kt;for(t=0;t<i;t++)t%3==0&&t&&(r+=s[o>>18&63],r+=s[o>>12&63],r+=s[o>>6&63],r+=s[63&o]),o=(o<<8)+e[t];return 0===(n=i%3)?(r+=s[o>>18&63],r+=s[o>>12&63],r+=s[o>>6&63],r+=s[63&o]):2===n?(r+=s[o>>10&63],r+=s[o>>4&63],r+=s[o<<2&63],r+=s[64]):1===n&&(r+=s[o>>2&63],r+=s[o<<4&63],r+=s[64],r+=s[64]),r}}),Yt=Object.prototype.hasOwnProperty,Gt=Object.prototype.toString;var Xt=new St("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,o,i,s=[],a=e;for(t=0,n=a.length;t<n;t+=1){if(r=a[t],i=!1,"[object Object]"!==Gt.call(r))return!1;for(o in r)if(Yt.call(r,o)){if(i)return!1;i=!0}if(!i)return!1;if(-1!==s.indexOf(o))return!1;s.push(o)}return!0},construct:function(e){return null!==e?e:[]}}),Qt=Object.prototype.toString;var Zt=new St("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,o,i,s=e;for(i=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],"[object Object]"!==Qt.call(r))return!1;if(1!==(o=Object.keys(r)).length)return!1;i[t]=[o[0],r[o[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,o,i,s=e;for(i=new Array(s.length),t=0,n=s.length;t<n;t+=1)r=s[t],o=Object.keys(r),i[t]=[o[0],r[o[0]]];return i}}),en=Object.prototype.hasOwnProperty;var tn=new St("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(en.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),nn=Vt.extend({implicit:[Wt,qt],explicit:[Jt,Xt,Zt,tn]}),rn=Object.prototype.hasOwnProperty,on=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,sn=/[\x85\u2028\u2029]/,an=/[,\[\]\{\}]/,ln=/^(?:!|!!|![a-z\-]+!)$/i,cn=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function dn(e){return Object.prototype.toString.call(e)}function un(e){return 10===e||13===e}function hn(e){return 9===e||32===e}function pn(e){return 9===e||32===e||10===e||13===e}function fn(e){return 44===e||91===e||93===e||123===e||125===e}function mn(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function gn(e){return 120===e?2:117===e?4:85===e?8:0}function bn(e){return 48<=e&&e<=57?e-48:-1}function xn(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"Â…":95===e?"Â ":76===e?"\u2028":80===e?"\u2029":""}function yn(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}function vn(e,t,n){"__proto__"===t?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}for(var wn=new Array(256),kn=new Array(256),Cn=0;Cn<256;Cn++)wn[Cn]=xn(Cn)?1:0,kn[Cn]=xn(Cn);function Sn(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||nn,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Nn(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=wt(n),new xt(t,n)}function jn(e,t){throw Nn(e,t)}function En(e,t){e.onWarning&&e.onWarning.call(null,Nn(e,t))}var Mn={YAML:function(e,t,n){var r,o,i;null!==e.version&&jn(e,"duplication of %YAML directive"),1!==n.length&&jn(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&jn(e,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),i=parseInt(r[2],10),1!==o&&jn(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=i<2,1!==i&&2!==i&&En(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,o;2!==n.length&&jn(e,"TAG directive accepts exactly two arguments"),r=n[0],o=n[1],ln.test(r)||jn(e,"ill-formed tag handle (first argument) of the TAG directive"),rn.call(e.tagMap,r)&&jn(e,'there is a previously declared suffix for "'+r+'" tag handle'),cn.test(o)||jn(e,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch(i){jn(e,"tag prefix is malformed: "+o)}e.tagMap[r]=o}};function Tn(e,t,n,r){var o,i,s,a;if(t<n){if(a=e.input.slice(t,n),r)for(o=0,i=a.length;o<i;o+=1)9===(s=a.charCodeAt(o))||32<=s&&s<=1114111||jn(e,"expected valid JSON character");else on.test(a)&&jn(e,"the stream contains non-printable characters");e.result+=a}}function On(e,t,n,r){var o,i,s,a;for(mt.isObject(n)||jn(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(o=Object.keys(n)).length;s<a;s+=1)i=o[s],rn.call(t,i)||(vn(t,i,n[i]),r[i]=!0)}function An(e,t,n,r,o,i,s,a,l){var c,d;if(Array.isArray(o))for(c=0,d=(o=Array.prototype.slice.call(o)).length;c<d;c+=1)Array.isArray(o[c])&&jn(e,"nested arrays are not supported inside keys"),"object"==typeof o&&"[object Object]"===dn(o[c])&&(o[c]="[object Object]");if("object"==typeof o&&"[object Object]"===dn(o)&&(o="[object Object]"),o=String(o),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(i))for(c=0,d=i.length;c<d;c+=1)On(e,t,i[c],n);else On(e,t,i,n);else e.json||rn.call(n,o)||!rn.call(t,o)||(e.line=s||e.line,e.lineStart=a||e.lineStart,e.position=l||e.position,jn(e,"duplicated mapping key")),vn(t,o,i),delete n[o];return t}function Dn(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):jn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function In(e,t,n){for(var r=0,o=e.input.charCodeAt(e.position);0!==o;){for(;hn(o);)9===o&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),o=e.input.charCodeAt(++e.position);if(t&&35===o)do{o=e.input.charCodeAt(++e.position)}while(10!==o&&13!==o&&0!==o);if(!un(o))break;for(Dn(e),o=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===o;)e.lineIndent++,o=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&En(e,"deficient indentation"),r}function Rn(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!pn(t)))}function Pn(e,t){1===t?e.result+=" ":t>1&&(e.result+=mt.repeat("\n",t-1))}function Ln(e,t){var n,r,o=e.tag,i=e.anchor,s=[],a=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,jn(e,"tab characters must not be used in indentation")),45===r)&&pn(e.input.charCodeAt(e.position+1));)if(a=!0,e.position++,In(e,!0,-1)&&e.lineIndent<=t)s.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,Fn(e,t,3,!1,!0),s.push(e.result),In(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)jn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!a&&(e.tag=o,e.anchor=i,e.kind="sequence",e.result=s,!0)}function $n(e){var t,n,r,o,i=!1,s=!1;if(33!==(o=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&jn(e,"duplication of a tag property"),60===(o=e.input.charCodeAt(++e.position))?(i=!0,o=e.input.charCodeAt(++e.position)):33===o?(s=!0,n="!!",o=e.input.charCodeAt(++e.position)):n="!",t=e.position,i){do{o=e.input.charCodeAt(++e.position)}while(0!==o&&62!==o);e.position<e.length?(r=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):jn(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==o&&!pn(o);)33===o&&(s?jn(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),ln.test(n)||jn(e,"named tag handle cannot contain such characters"),s=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),an.test(r)&&jn(e,"tag suffix cannot contain flow indicator characters")}r&&!cn.test(r)&&jn(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(a){jn(e,"tag name is malformed: "+r)}return i?e.tag=r:rn.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:jn(e,'undeclared tag handle "'+n+'"'),!0}function zn(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&jn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!pn(n)&&!fn(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&jn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Fn(e,t,n,r,o){var i,s,a,l,c,d,u,h,p,f=1,m=!1,g=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=s=a=4===n||3===n,r&&In(e,!0,-1)&&(m=!0,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)),1===f)for(;$n(e)||zn(e);)In(e,!0,-1)?(m=!0,a=i,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)):a=!1;if(a&&(a=m||o),1!==f&&4!==n||(h=1===n||2===n?t:t+1,p=e.position-e.lineStart,1===f?a&&(Ln(e,p)||function(e,t,n){var r,o,i,s,a,l,c,d=e.tag,u=e.anchor,h={},p=Object.create(null),f=null,m=null,g=null,b=!1,x=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=h),c=e.input.charCodeAt(e.position);0!==c;){if(b||-1===e.firstTabInLine||(e.position=e.firstTabInLine,jn(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,63!==c&&58!==c||!pn(r)){if(s=e.line,a=e.lineStart,l=e.position,!Fn(e,n,2,!1,!0))break;if(e.line===i){for(c=e.input.charCodeAt(e.position);hn(c);)c=e.input.charCodeAt(++e.position);if(58===c)pn(c=e.input.charCodeAt(++e.position))||jn(e,"a whitespace character is expected after the key-value separator within a block mapping"),b&&(An(e,h,p,f,m,null,s,a,l),f=m=g=null),x=!0,b=!1,o=!1,f=e.tag,m=e.result;else{if(!x)return e.tag=d,e.anchor=u,!0;jn(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!x)return e.tag=d,e.anchor=u,!0;jn(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(b&&(An(e,h,p,f,m,null,s,a,l),f=m=g=null),x=!0,b=!0,o=!0):b?(b=!1,o=!0):jn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=r;if((e.line===i||e.lineIndent>t)&&(b&&(s=e.line,a=e.lineStart,l=e.position),Fn(e,t,4,!0,o)&&(b?m=e.result:g=e.result),b||(An(e,h,p,f,m,g,s,a,l),f=m=g=null),In(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&0!==c)jn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return b&&An(e,h,p,f,m,null,s,a,l),x&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=h),x}(e,p,h))||function(e,t){var n,r,o,i,s,a,l,c,d,u,h,p,f=!0,m=e.tag,g=e.anchor,b=Object.create(null);if(91===(p=e.input.charCodeAt(e.position)))s=93,c=!1,i=[];else{if(123!==p)return!1;s=125,c=!0,i={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=i),p=e.input.charCodeAt(++e.position);0!==p;){if(In(e,!0,t),(p=e.input.charCodeAt(e.position))===s)return e.position++,e.tag=m,e.anchor=g,e.kind=c?"mapping":"sequence",e.result=i,!0;f?44===p&&jn(e,"expected the node content, but found ','"):jn(e,"missed comma between flow collection entries"),h=null,a=l=!1,63===p&&pn(e.input.charCodeAt(e.position+1))&&(a=l=!0,e.position++,In(e,!0,t)),n=e.line,r=e.lineStart,o=e.position,Fn(e,t,1,!1,!0),u=e.tag,d=e.result,In(e,!0,t),p=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==p||(a=!0,p=e.input.charCodeAt(++e.position),In(e,!0,t),Fn(e,t,1,!1,!0),h=e.result),c?An(e,i,b,u,d,h,n,r,o):a?i.push(An(e,null,b,u,d,h,n,r,o)):i.push(d),In(e,!0,t),44===(p=e.input.charCodeAt(e.position))?(f=!0,p=e.input.charCodeAt(++e.position)):f=!1}jn(e,"unexpected end of the stream within a flow collection")}(e,h)?g=!0:(s&&function(e,t){var n,r,o,i,s=1,a=!1,l=!1,c=t,d=0,u=!1;if(124===(i=e.input.charCodeAt(e.position)))r=!1;else{if(62!==i)return!1;r=!0}for(e.kind="scalar",e.result="";0!==i;)if(43===(i=e.input.charCodeAt(++e.position))||45===i)1===s?s=43===i?3:2:jn(e,"repeat of a chomping mode identifier");else{if(!((o=bn(i))>=0))break;0===o?jn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):l?jn(e,"repeat of an indentation width identifier"):(c=t+o-1,l=!0)}if(hn(i)){do{i=e.input.charCodeAt(++e.position)}while(hn(i));if(35===i)do{i=e.input.charCodeAt(++e.position)}while(!un(i)&&0!==i)}for(;0!==i;){for(Dn(e),e.lineIndent=0,i=e.input.charCodeAt(e.position);(!l||e.lineIndent<c)&&32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position);if(!l&&e.lineIndent>c&&(c=e.lineIndent),un(i))d++;else{if(e.lineIndent<c){3===s?e.result+=mt.repeat("\n",a?1+d:d):1===s&&a&&(e.result+="\n");break}for(r?hn(i)?(u=!0,e.result+=mt.repeat("\n",a?1+d:d)):u?(u=!1,e.result+=mt.repeat("\n",d+1)):0===d?a&&(e.result+=" "):e.result+=mt.repeat("\n",d):e.result+=mt.repeat("\n",a?1+d:d),a=!0,l=!0,d=0,n=e.position;!un(i)&&0!==i;)i=e.input.charCodeAt(++e.position);Tn(e,n,e.position,!1)}}return!0}(e,h)||function(e,t){var n,r,o;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=o=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(Tn(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,o=e.position}else un(n)?(Tn(e,r,o,!0),Pn(e,In(e,!1,t)),r=o=e.position):e.position===e.lineStart&&Rn(e)?jn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,o=e.position);jn(e,"unexpected end of the stream within a single quoted scalar")}(e,h)||function(e,t){var n,r,o,i,s,a;if(34!==(a=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(a=e.input.charCodeAt(e.position));){if(34===a)return Tn(e,n,e.position,!0),e.position++,!0;if(92===a){if(Tn(e,n,e.position,!0),un(a=e.input.charCodeAt(++e.position)))In(e,!1,t);else if(a<256&&wn[a])e.result+=kn[a],e.position++;else if((s=gn(a))>0){for(o=s,i=0;o>0;o--)(s=mn(a=e.input.charCodeAt(++e.position)))>=0?i=(i<<4)+s:jn(e,"expected hexadecimal character");e.result+=yn(i),e.position++}else jn(e,"unknown escape sequence");n=r=e.position}else un(a)?(Tn(e,n,r,!0),Pn(e,In(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Rn(e)?jn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}jn(e,"unexpected end of the stream within a double quoted scalar")}(e,h)?g=!0:!function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!pn(r)&&!fn(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&jn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),rn.call(e.anchorMap,n)||jn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],In(e,!0,-1),!0}(e)?function(e,t,n){var r,o,i,s,a,l,c,d,u=e.kind,h=e.result;if(pn(d=e.input.charCodeAt(e.position))||fn(d)||35===d||38===d||42===d||33===d||124===d||62===d||39===d||34===d||37===d||64===d||96===d)return!1;if((63===d||45===d)&&(pn(r=e.input.charCodeAt(e.position+1))||n&&fn(r)))return!1;for(e.kind="scalar",e.result="",o=i=e.position,s=!1;0!==d;){if(58===d){if(pn(r=e.input.charCodeAt(e.position+1))||n&&fn(r))break}else if(35===d){if(pn(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&Rn(e)||n&&fn(d))break;if(un(d)){if(a=e.line,l=e.lineStart,c=e.lineIndent,In(e,!1,-1),e.lineIndent>=t){s=!0,d=e.input.charCodeAt(e.position);continue}e.position=i,e.line=a,e.lineStart=l,e.lineIndent=c;break}}s&&(Tn(e,o,i,!1),Pn(e,e.line-a),o=i=e.position,s=!1),hn(d)||(i=e.position+1),d=e.input.charCodeAt(++e.position)}return Tn(e,o,i,!1),!!e.result||(e.kind=u,e.result=h,!1)}(e,h,1===n)&&(g=!0,null===e.tag&&(e.tag="?")):(g=!0,null===e.tag&&null===e.anchor||jn(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===f&&(g=a&&Ln(e,p))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&jn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,c=e.implicitTypes.length;l<c;l+=1)if((u=e.implicitTypes[l]).resolve(e.result)){e.result=u.construct(e.result),e.tag=u.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(rn.call(e.typeMap[e.kind||"fallback"],e.tag))u=e.typeMap[e.kind||"fallback"][e.tag];else for(u=null,l=0,c=(d=e.typeMap.multi[e.kind||"fallback"]).length;l<c;l+=1)if(e.tag.slice(0,d[l].tag.length)===d[l].tag){u=d[l];break}u||jn(e,"unknown tag !<"+e.tag+">"),null!==e.result&&u.kind!==e.kind&&jn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+u.kind+'", not "'+e.kind+'"'),u.resolve(e.result,e.tag)?(e.result=u.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):jn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||g}function Bn(e){var t,n,r,o,i=e.position,s=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(o=e.input.charCodeAt(e.position))&&(In(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==o));){for(s=!0,o=e.input.charCodeAt(++e.position),t=e.position;0!==o&&!pn(o);)o=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&jn(e,"directive name must not be less than one character in length");0!==o;){for(;hn(o);)o=e.input.charCodeAt(++e.position);if(35===o){do{o=e.input.charCodeAt(++e.position)}while(0!==o&&!un(o));break}if(un(o))break;for(t=e.position;0!==o&&!pn(o);)o=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==o&&Dn(e),rn.call(Mn,n)?Mn[n](e,n,r):En(e,'unknown document directive "'+n+'"')}In(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,In(e,!0,-1)):s&&jn(e,"directives end mark is expected"),Fn(e,e.lineIndent-1,4,!1,!0),In(e,!0,-1),e.checkLineBreaks&&sn.test(e.input.slice(i,e.position))&&En(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Rn(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,In(e,!0,-1)):e.position<e.length-1&&jn(e,"end of the stream or a document separator is expected")}function Un(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new Sn(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,jn(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Bn(n);return n.documents}var Vn={loadAll:function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=Un(e,n);if("function"!=typeof t)return r;for(var o=0,i=r.length;o<i;o+=1)t(r[o])},load:function(e,t){var n=Un(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new xt("expected a single document in the stream, but found more")}}},_n=Object.prototype.toString,Hn=Object.prototype.hasOwnProperty,Wn=65279,qn={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},Kn=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],Jn=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function Yn(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else{if(!(e<=4294967295))throw new xt("code point within a string may not be greater than 0xFFFFFFFF");n="U",r=8}return"\\"+n+mt.repeat("0",r-t.length)+t}function Gn(e){this.schema=e.schema||nn,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=mt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,r,o,i,s,a,l;if(null===t)return{};for(n={},o=0,i=(r=Object.keys(t)).length;o<i;o+=1)s=r[o],a=String(t[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(l=e.compiledTypeMap.fallback[s])&&Hn.call(l.styleAliases,a)&&(a=l.styleAliases[a]),n[s]=a;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?2:1,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Xn(e,t){for(var n,r=mt.repeat(" ",t),o=0,i=-1,s="",a=e.length;o<a;)-1===(i=e.indexOf("\n",o))?(n=e.slice(o),o=a):(n=e.slice(o,i+1),o=i+1),n.length&&"\n"!==n&&(s+=r),s+=n;return s}function Qn(e,t){return"\n"+mt.repeat(" ",e.indent*t)}function Zn(e){return 32===e||9===e}function er(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==Wn||65536<=e&&e<=1114111}function tr(e){return er(e)&&e!==Wn&&13!==e&&10!==e}function nr(e,t,n){var r=tr(e),o=r&&!Zn(e);return(n?r:r&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e)&&35!==e&&!(58===t&&!o)||tr(t)&&!Zn(t)&&35===e||58===t&&o}function rr(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(r-55296)+n-56320+65536:r}function or(e){return/^\n* /.test(e)}function ir(e,t,n,r,o,i,s,a){var l,c,d=0,u=null,h=!1,p=!1,f=-1!==r,m=-1,g=er(c=rr(e,0))&&c!==Wn&&!Zn(c)&&45!==c&&63!==c&&58!==c&&44!==c&&91!==c&&93!==c&&123!==c&&125!==c&&35!==c&&38!==c&&42!==c&&33!==c&&124!==c&&61!==c&&62!==c&&39!==c&&34!==c&&37!==c&&64!==c&&96!==c&&function(e){return!Zn(e)&&58!==e}(rr(e,e.length-1));if(t||s)for(l=0;l<e.length;d>=65536?l+=2:l++){if(!er(d=rr(e,l)))return 5;g=g&&nr(d,u,a),u=d}else{for(l=0;l<e.length;d>=65536?l+=2:l++){if(10===(d=rr(e,l)))h=!0,f&&(p=p||l-m-1>r&&" "!==e[m+1],m=l);else if(!er(d))return 5;g=g&&nr(d,u,a),u=d}p=p||f&&l-m-1>r&&" "!==e[m+1]}return h||p?n>9&&or(e)?5:s?2===i?5:2:p?4:3:!g||s||o(e)?2===i?5:2:1}function sr(e,t,n,r,o){e.dump=function(){if(0===t.length)return 2===e.quotingType?'""':"''";if(!e.noCompatMode&&(-1!==Kn.indexOf(t)||Jn.test(t)))return 2===e.quotingType?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),a=r||e.flowLevel>-1&&n>=e.flowLevel;switch(ir(t,a,e.indent,s,function(t){return function(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)},e.quotingType,e.forceQuotes&&!r,o)){case 1:return t;case 2:return"'"+t.replace(/'/g,"''")+"'";case 3:return"|"+ar(t,e.indent)+lr(Xn(t,i));case 4:return">"+ar(t,e.indent)+lr(Xn(function(e,t){var n,r,o=/(\n+)([^\n]*)/g,i=(a=e.indexOf("\n"),a=-1!==a?a:e.length,o.lastIndex=a,cr(e.slice(0,a),t)),s="\n"===e[0]||" "===e[0];var a;for(;r=o.exec(e);){var l=r[1],c=r[2];n=" "===c[0],i+=l+(s||n||""===c?"":"\n")+cr(c,t),s=n}return i}(t,s),i));case 5:return'"'+function(e){for(var t,n="",r=0,o=0;o<e.length;r>=65536?o+=2:o++)r=rr(e,o),!(t=qn[r])&&er(r)?(n+=e[o],r>=65536&&(n+=e[o+1])):n+=t||Yn(r);return n}(t)+'"';default:throw new xt("impossible error: invalid scalar style")}}()}function ar(e,t){var n=or(e)?String(t):"",r="\n"===e[e.length-1];return n+(r&&("\n"===e[e.length-2]||"\n"===e)?"+":r?"":"-")+"\n"}function lr(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function cr(e,t){if(""===e||" "===e[0])return e;for(var n,r,o=/ [^ ]/g,i=0,s=0,a=0,l="";n=o.exec(e);)(a=n.index)-i>t&&(r=s>i?s:a,l+="\n"+e.slice(i,r),i=r+1),s=a;return l+="\n",e.length-i>t&&s>i?l+=e.slice(i,s)+"\n"+e.slice(s+1):l+=e.slice(i),l.slice(1)}function dr(e,t,n,r){var o,i,s,a="",l=e.tag;for(o=0,i=n.length;o<i;o+=1)s=n[o],e.replacer&&(s=e.replacer.call(n,String(o),s)),(hr(e,t+1,s,!0,!0,!1,!0)||void 0===s&&hr(e,t+1,null,!0,!0,!1,!0))&&(r&&""===a||(a+=Qn(e,t)),e.dump&&10===e.dump.charCodeAt(0)?a+="-":a+="- ",a+=e.dump);e.tag=l,e.dump=a||"[]"}function ur(e,t,n){var r,o,i,s,a,l;for(i=0,s=(o=n?e.explicitTypes:e.implicitTypes).length;i<s;i+=1)if(((a=o[i]).instanceOf||a.predicate)&&(!a.instanceOf||"object"==typeof t&&t instanceof a.instanceOf)&&(!a.predicate||a.predicate(t))){if(n?a.multi&&a.representName?e.tag=a.representName(t):e.tag=a.tag:e.tag="?",a.represent){if(l=e.styleMap[a.tag]||a.defaultStyle,"[object Function]"===_n.call(a.represent))r=a.represent(t,l);else{if(!Hn.call(a.represent,l))throw new xt("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');r=a.represent[l](t,l)}e.dump=r}return!0}return!1}function hr(e,t,n,r,o,i,s){e.tag=null,e.dump=n,ur(e,n,!1)||ur(e,n,!0);var a,l=_n.call(e.dump),c=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var d,u,h="[object Object]"===l||"[object Array]"===l;if(h&&(u=-1!==(d=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||u||2!==e.indent&&t>0)&&(o=!1),u&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(h&&u&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),"[object Object]"===l)r&&0!==Object.keys(e.dump).length?(!function(e,t,n,r){var o,i,s,a,l,c,d="",u=e.tag,h=Object.keys(n);if(!0===e.sortKeys)h.sort();else if("function"==typeof e.sortKeys)h.sort(e.sortKeys);else if(e.sortKeys)throw new xt("sortKeys must be a boolean or a function");for(o=0,i=h.length;o<i;o+=1)c="",r&&""===d||(c+=Qn(e,t)),a=n[s=h[o]],e.replacer&&(a=e.replacer.call(n,s,a)),hr(e,t+1,s,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?c+="?":c+="? "),c+=e.dump,l&&(c+=Qn(e,t)),hr(e,t+1,a,!0,l)&&(e.dump&&10===e.dump.charCodeAt(0)?c+=":":c+=": ",d+=c+=e.dump));e.tag=u,e.dump=d||"{}"}(e,t,e.dump,o),u&&(e.dump="&ref_"+d+e.dump)):(!function(e,t,n){var r,o,i,s,a,l="",c=e.tag,d=Object.keys(n);for(r=0,o=d.length;r<o;r+=1)a="",""!==l&&(a+=", "),e.condenseFlow&&(a+='"'),s=n[i=d[r]],e.replacer&&(s=e.replacer.call(n,i,s)),hr(e,t,i,!1,!1)&&(e.dump.length>1024&&(a+="? "),a+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),hr(e,t,s,!1,!1)&&(l+=a+=e.dump));e.tag=c,e.dump="{"+l+"}"}(e,t,e.dump),u&&(e.dump="&ref_"+d+" "+e.dump));else if("[object Array]"===l)r&&0!==e.dump.length?(e.noArrayIndent&&!s&&t>0?dr(e,t-1,e.dump,o):dr(e,t,e.dump,o),u&&(e.dump="&ref_"+d+e.dump)):(!function(e,t,n){var r,o,i,s="",a=e.tag;for(r=0,o=n.length;r<o;r+=1)i=n[r],e.replacer&&(i=e.replacer.call(n,String(r),i)),(hr(e,t,i,!1,!1)||void 0===i&&hr(e,t,null,!1,!1))&&(""!==s&&(s+=","+(e.condenseFlow?"":" ")),s+=e.dump);e.tag=a,e.dump="["+s+"]"}(e,t,e.dump),u&&(e.dump="&ref_"+d+" "+e.dump));else{if("[object String]"!==l){if("[object Undefined]"===l)return!1;if(e.skipInvalid)return!1;throw new xt("unacceptable kind of an object to dump "+l)}"?"!==e.tag&&sr(e,e.dump,t,i,c)}null!==e.tag&&"?"!==e.tag&&(a=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),a="!"===e.tag[0]?"!"+a:"tag:yaml.org,2002:"===a.slice(0,18)?"!!"+a.slice(18):"!<"+a+">",e.dump=a+" "+e.dump)}return!0}function pr(e,t){var n,r,o=[],i=[];for(fr(e,o,i),n=0,r=i.length;n<r;n+=1)t.duplicates.push(o[i[n]]);t.usedDuplicates=new Array(r)}function fr(e,t,n){var r,o,i;if(null!==e&&"object"==typeof e)if(-1!==(o=t.indexOf(e)))-1===n.indexOf(o)&&n.push(o);else if(t.push(e),Array.isArray(e))for(o=0,i=e.length;o<i;o+=1)fr(e[o],t,n);else for(o=0,i=(r=Object.keys(e)).length;o<i;o+=1)fr(e[r[o]],t,n)}function mr(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var gr={Type:St,Schema:Et,FAILSAFE_SCHEMA:At,JSON_SCHEMA:Ut,CORE_SCHEMA:Vt,DEFAULT_SCHEMA:nn,load:Vn.load,loadAll:Vn.loadAll,dump:{dump:function(e,t){var n=new Gn(t=t||{});n.noRefs||pr(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),hr(n,0,r,!0,!0)?n.dump+"\n":""}}.dump,YAMLException:xt,types:{binary:Jt,float:Bt,map:Ot,null:Dt,pairs:Zt,set:tn,timestamp:Wt,bool:It,int:$t,merge:qt,omap:Xt,seq:Tt,str:Mt},safeLoad:mr("safeLoad","load"),safeLoadAll:mr("safeLoadAll","loadAll"),safeDump:mr("safeDump","dump")};function br({isOpen:e,onClose:t}){const n=M();if(!e)return null;return T.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:T.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:T.jsxs("div",{className:"p-6",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx("div",{className:"flex-shrink-0",children:T.jsx("svg",{className:"w-12 h-12 text-yellow-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),T.jsxs("div",{children:[T.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Storage Full"}),T.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"You've reached the 5-resume limit"})]})]}),T.jsx("p",{className:"text-gray-700 mb-6",children:"You've reached the 5-resume limit for free accounts. Delete an old resume to create a new one."}),T.jsxs("div",{className:"flex gap-3",children:[T.jsx("button",{onClick:()=>{t(),n("/my-resumes")},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:"Manage Resumes"}),T.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})})})}const xr=e=>e.type||"Experience"!==e.name?e.type||"Education"!==e.name?e:{...e,type:"education"}:{...e,type:"experience"},yr=e=>e.map(xr),vr={linkedin:{id:"linkedin",label:"LinkedIn",icon:"linkedin.png",placeholder:"linkedin.com/in/yourname",urlPattern:/^(https?:\/\/)?([\w]+\.)?linkedin\.com\/(in|pub|public-profile\/(in|pub))\/[\w\-]+\/?$/i,errorMessage:"Please enter a valid LinkedIn profile URL"},github:{id:"github",label:"GitHub",icon:"github.png",placeholder:"github.com/username",urlPattern:/^(https?:\/\/)?(www\.)?github\.com\/[\w\-]+\/?$/i,errorMessage:"Please enter a valid GitHub profile URL (e.g., github.com/username)"},twitter:{id:"twitter",label:"Twitter/X",icon:"twitter.png",placeholder:"twitter.com/username or x.com/username",urlPattern:/^(https?:\/\/)?(www\.)?(twitter\.com|x\.com)\/[\w]+\/?$/i,errorMessage:"Please enter a valid Twitter/X profile URL"},website:{id:"website",label:"Personal Website",icon:"website.png",placeholder:"yourwebsite.com",urlPattern:/^(https?:\/\/)?([\w\-]+\.)+[\w\-]+(\/[\w\-._~:/?#[\]@!$&'()*+,;=]*)?$/i,errorMessage:"Please enter a valid website URL"},pinterest:{id:"pinterest",label:"Pinterest",icon:"pinterest.png",placeholder:"pinterest.com/username",urlPattern:/^(https?:\/\/)?(www\.)?pinterest\.com\/[\w\-]+\/?$/i,errorMessage:"Please enter a valid Pinterest profile URL"},medium:{id:"medium",label:"Medium",icon:"medium.png",placeholder:"medium.com/@username",urlPattern:/^(https?:\/\/)?(www\.)?medium\.com\/@?[\w\-]+\/?$/i,errorMessage:"Please enter a valid Medium profile URL"},youtube:{id:"youtube",label:"YouTube",icon:"youtube.png",placeholder:"youtube.com/@channelname or youtube.com/c/channelname",urlPattern:/^(https?:\/\/)?(www\.)?youtube\.com\/([@c]\/)?[\w\-]+\/?$/i,errorMessage:"Please enter a valid YouTube channel URL"},stackoverflow:{id:"stackoverflow",label:"Stack Overflow",icon:"stackoverflow.png",placeholder:"stackoverflow.com/users/123456/username",urlPattern:/^(https?:\/\/)?(www\.)?stackoverflow\.com\/users\/\d+\/[\w\-]+\/?$/i,errorMessage:"Please enter a valid Stack Overflow profile URL"},behance:{id:"behance",label:"Behance",icon:"behance.png",placeholder:"behance.net/username",urlPattern:/^(https?:\/\/)?(www\.)?behance\.net\/[\w\-]+\/?$/i,errorMessage:"Please enter a valid Behance profile URL"},dribbble:{id:"dribbble",label:"Dribbble",icon:"dribbble.png",placeholder:"dribbble.com/username",urlPattern:/^(https?:\/\/)?(www\.)?dribbble\.com\/[\w\-]+\/?$/i,errorMessage:"Please enter a valid Dribbble profile URL"}},wr=Object.values(vr).map(e=>({value:e.id,label:e.label}));function kr(e,t){if(!t.trim())return{valid:!0};const n=vr[e];if(!n)return{valid:!1,error:"Unknown platform"};const r=t.toLowerCase().trim();return n.urlPattern.test(r)?{valid:!0}:{valid:!1,error:n.errorMessage}}const Cr=({contactInfo:e,onUpdate:t,socialLinkErrors:n,onSocialLinkChange:r,onAddSocialLink:o,onRemoveSocialLink:i,autoGeneratedIndexes:s})=>{const a=e.social_links||[];return T.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 sm:p-8 mb-8 border border-gray-200",children:[T.jsx("div",{className:"mb-6",children:T.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Contact Information"})}),T.jsx("p",{className:"text-gray-600 mb-6",children:"Start by filling out your basic contact information"}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"Name"}),T.jsx("input",{type:"text",inputMode:"text",autoComplete:"name",value:e.name||"",onChange:n=>t({...e,name:n.target.value}),className:"w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Enter your name","aria-label":"Full name"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"Location"}),T.jsx("input",{type:"text",inputMode:"text",autoComplete:"address-level2",value:e.location||"",onChange:n=>t({...e,location:n.target.value}),className:"w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Enter your location","aria-label":"Location"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"Email"}),T.jsx("input",{type:"email",inputMode:"email",autoComplete:"email",value:e.email||"",onChange:n=>t({...e,email:n.target.value}),className:"w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Enter your email","aria-label":"Email address"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"Phone"}),T.jsx("input",{type:"tel",inputMode:"tel",autoComplete:"tel",value:e.phone||"",onChange:n=>t({...e,phone:n.target.value}),className:"w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Enter your phone","aria-label":"Phone number"})]})]}),T.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[T.jsxs("div",{className:"flex justify-between items-center mb-4",children:[T.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Social Links"}),T.jsxs("button",{onClick:o,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 text-sm font-semibold flex items-center gap-2","aria-label":"Add social link",children:[T.jsx("span",{children:"+"}),"Add Social Link"]})]}),T.jsx("p",{className:"text-gray-600 mb-6 text-sm",children:"Add links to your professional profiles (LinkedIn, GitHub, etc.)"}),0===a.length?T.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300",children:T.jsx("p",{children:'No social links added yet. Click "Add Social Link" to get started.'})}):T.jsx("div",{className:"space-y-4",children:a.map((e,t)=>T.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200 transition-all duration-200 hover:shadow-md",children:[T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-semibold mb-2 text-sm",children:"Platform"}),T.jsxs("select",{value:e.platform||"",onChange:e=>r(t,"platform",e.target.value),className:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white","aria-label":`Platform for social link ${t+1}`,children:[T.jsx("option",{value:"",children:"Select platform..."}),wr.map(e=>T.jsx("option",{value:e.value,children:e.label},e.value))]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-semibold mb-2 text-sm",children:"URL"}),T.jsx("input",{type:"url",inputMode:"url",value:e.url||"",onChange:e=>r(t,"url",e.target.value),className:"w-full border rounded-lg p-2.5 focus:ring-2 focus:border-blue-500 transition-all duration-200 "+(n[t]?"border-red-300 focus:ring-red-500 bg-red-50":"border-gray-300 focus:ring-blue-500"),placeholder:"Enter profile URL","aria-label":`URL for social link ${t+1}`,"aria-invalid":n[t]?"true":"false"}),n[t]&&T.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[T.jsx("span",{className:"mr-1",children:"âš ï¸"}),n[t]]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-semibold mb-2 text-sm",children:"Display Text"}),T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",inputMode:"text",value:e.display_text||"",onChange:e=>r(t,"display_text",e.target.value),className:"w-full border border-gray-300 rounded-lg p-2.5 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"How it appears on resume","aria-label":`Display text for social link ${t+1}`}),s.has(t)&&T.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",title:"Auto-generated","aria-label":"Auto-generated",children:"ðŸª„"})]})]})]}),T.jsx("div",{className:"mt-3 flex justify-end",children:T.jsx("button",{onClick:()=>i(t),className:"text-red-600 hover:text-red-700 hover:bg-red-50 px-3 py-1.5 rounded-lg transition-colors duration-200 text-sm font-semibold","aria-label":`Remove social link ${t+1}`,children:"Remove"})})]},t))})]})]})},Sr=()=>{const[t,n]=e.useState(!1);return T.jsxs("div",{className:"bg-blue-50/50 backdrop-blur-sm rounded-xl border border-blue-200/60 mb-6 overflow-hidden transition-all duration-200",children:[T.jsxs("button",{onClick:()=>n(!t),className:"w-full flex items-center justify-between p-4 hover:bg-blue-100/50 transition-colors text-left","aria-expanded":t,"aria-label":t?"Collapse formatting help":"Expand formatting help",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx(O,{className:"text-blue-600 text-xl flex-shrink-0","aria-hidden":"true"}),T.jsx("span",{className:"text-blue-900 font-medium text-sm",children:"Formatting Help & Tips"})]}),t?T.jsx(A,{className:"text-blue-600 text-xl","aria-hidden":"true"}):T.jsx(D,{className:"text-blue-600 text-xl","aria-hidden":"true"})]}),t&&T.jsx("div",{className:"px-4 pb-4 text-sm space-y-4",children:T.jsxs("div",{children:[T.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"ðŸš€ Quick Start"}),T.jsxs("ul",{className:"space-y-1.5 text-blue-800",children:[T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-blue-600 mt-0.5",children:"â€¢"}),T.jsxs("span",{children:[T.jsx("strong",{children:"Format text:"})," Select any text to see formatting buttons (",T.jsx("strong",{children:"B"}),", ",T.jsx("em",{children:"I"}),", ",T.jsx("u",{children:"U"}),", ",T.jsx("s",{children:"S"}),", ðŸ”—)"]})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-blue-600 mt-0.5",children:"â€¢"}),T.jsxs("span",{children:[T.jsx("strong",{children:"Add links:"})," Select text, click ðŸ”—, enter the URL"]})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-blue-600 mt-0.5",children:"â€¢"}),T.jsxs("span",{children:[T.jsx("strong",{children:"Keyboard shortcuts:"})," Ctrl+B (Bold), Ctrl+I (Italic), Ctrl+U (Underline)"]})]})]})]})})]})},Nr=({value:t,onChange:n,onClear:r,registerIcon:o,getIconFile:i,removeIcon:s,disabled:a=!1,className:l=""})=>{const[c,d]=e.useState(null),[u,h]=e.useState(!1),[p,f]=e.useState(null),m=e.useRef(null);e.useEffect(()=>{if(!t)return d(null),f(null),void(m.current&&(m.current.value=""));const e=i(t);if(e){const t=URL.createObjectURL(e);d(t)}else{const{iconSrc:e}=(n=t)?{iconSrc:`/icons/${n}`,isUploaded:!1}:{iconSrc:null,isUploaded:!1};d(e)}var n;f(null)},[t,i]);return e.useEffect(()=>()=>{c&&c.startsWith("blob:")&&URL.revokeObjectURL(c)},[c]),T.jsxs("div",{className:`icon-manager relative w-12 h-12 ${l}`,children:[T.jsxs("label",{className:"cursor-pointer relative group "+(a?"pointer-events-none opacity-50":""),children:[T.jsxs("div",{className:"w-12 h-12 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50 group-hover:border-blue-500 group-hover:bg-blue-50 transition-all duration-200",children:[u?T.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full"}):c?T.jsx("img",{src:c,alt:"Icon preview",className:"w-full h-full object-cover rounded-lg"}):T.jsx(I,{className:"text-gray-400 w-4 h-4"}),!u&&T.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:T.jsx(R,{className:"text-white w-3 h-3"})})]}),T.jsx("input",{ref:m,type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;const r=null==(t=e.target.files)?void 0:t[0];if(!r)return;const i=(e=>e.size>5242880?"File size must be less than 5MB":["image/jpeg","image/jpg","image/png","image/gif","image/svg+xml"].includes(e.type)?null:"Only JPEG, PNG, GIF, and SVG files are allowed")(r);if(i)return f(i),void(m.current&&(m.current.value=""));h(!0),f(null);try{const e=o(r),t=URL.createObjectURL(r);d(t),n(e,r)}catch(s){const e=s instanceof Error?s.message:"Failed to upload icon. Please try again.";f(e),m.current&&(m.current.value="")}finally{h(!1)}},disabled:a||u})]}),c&&!a&&T.jsx("button",{type:"button",onClick:()=>{d(null),f(null),m.current&&(m.current.value=""),t&&i(t)&&s(t),n(null,null),r&&r()},className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs shadow-lg transition-colors duration-200",disabled:u,children:T.jsx(P,{})}),p&&T.jsx("div",{className:"absolute top-14 left-0 bg-red-100 border border-red-400 text-red-700 px-2 py-1 rounded text-xs whitespace-nowrap z-10",children:p})]})},jr=({title:e,isEditing:t,temporaryTitle:n,onEdit:r,onSave:o,onCancel:i,onTitleChange:s,showHint:a=!1,className:l="text-xl font-semibold"})=>{const c=e=>{"Enter"===e.key?o():"Escape"===e.key&&i()};return t?T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{type:"text",value:n,onChange:e=>s(e.target.value),onKeyDown:c,className:"border border-gray-300 rounded-lg p-2 w-full text-xl font-semibold focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,placeholder:"Enter section title..."}),T.jsx("button",{onClick:o,className:"text-green-600 hover:text-green-800 transition-colors",title:"Save Title (Enter)",children:"âœ…"}),T.jsx("button",{onClick:i,className:"text-red-600 hover:text-red-800 transition-colors",title:"Cancel (Esc)",children:"âœ•"})]}):T.jsxs("h2",{className:`${l} ${e.startsWith("New ")?"text-gray-500 italic":""}`,children:[e,T.jsx("button",{onClick:r,className:"ml-2 text-gray-500 hover:text-gray-700 transition-colors",title:"Edit Title",children:"âœï¸"}),e.startsWith("New ")&&a&&T.jsx("span",{className:"ml-2 text-sm text-blue-500 font-normal",children:"(Click âœï¸ to rename)"})]})},Er=({title:t,isEditing:n,temporaryTitle:r,onTitleEdit:o,onTitleSave:i,onTitleCancel:s,onTitleChange:a,onDelete:l,showHint:c=!1,showDeleteConfirm:d,setShowDeleteConfirm:u,isCollapsed:h=!1,onToggleCollapse:p})=>{const[f,m]=e.useState(!1),g=d??f,b=u??m,x=()=>{g?(l(),b(!1)):b(!0)};return T.jsxs("div",{className:"flex items-center justify-between mb-4",children:[T.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[p&&T.jsx("button",{onClick:p,className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors","aria-label":h?"Expand section":"Collapse section",title:h?"Expand section":"Collapse section",children:h?T.jsx(D,{className:"text-2xl"}):T.jsx(A,{className:"text-2xl"})}),T.jsx(jr,{title:t,isEditing:n,temporaryTitle:r,onEdit:o,onSave:i,onCancel:s,onTitleChange:a,showHint:c})]}),T.jsx("div",{className:"flex items-center gap-2",children:g?T.jsxs(T.Fragment,{children:[T.jsx("span",{className:"text-sm text-gray-600",children:"Delete this section?"}),T.jsx("button",{onClick:x,className:"bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 transition-colors",title:"Confirm Delete",children:"Yes, Delete"}),T.jsx("button",{onClick:()=>{b(!1)},className:"bg-gray-300 text-gray-700 px-3 py-1 rounded-lg hover:bg-gray-400 transition-colors",title:"Cancel Delete",children:"Cancel"})]}):T.jsx("button",{onClick:x,className:"bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 transition-colors",title:"Remove Section",children:"Remove"})})]})},Mr=({show:e=!0,className:t=""})=>e?T.jsx("div",{className:`text-xs text-gray-500 mt-1 ${t}`,children:"ðŸ’¡ Tip: Select text to see formatting options."}):null;var Tr,Or,Ar={exports:{}},Dr={};function Ir(){return Or||(Or=1,Ar.exports=function(){if(Tr)return Dr;Tr=1;var e=L(),t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useState,r=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!t(e,r)}catch(o){return!0}}var a="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),l=n({inst:{value:a,getSnapshot:t}}),c=l[0].inst,d=l[1];return o(function(){c.value=a,c.getSnapshot=t,s(c)&&d({inst:c})},[e,a,t]),r(function(){return s(c)&&d({inst:c}),e(function(){s(c)&&d({inst:c})})},[e]),i(a),a};return Dr.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:a,Dr}()),Ar.exports}var Rr=Ir();function Pr(e){this.content=e}function Lr(e,t,n){for(let r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;let o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(let e=0;o.text[e]==i.text[e];e++)n++;return n}if(o.content.size||i.content.size){let e=Lr(o.content,i.content,n+1);if(null!=e)return e}n+=o.nodeSize}else n+=o.nodeSize}}function $r(e,t,n,r){for(let o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};let s=e.child(--o),a=t.child(--i),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){let e=0,t=Math.min(s.text.length,a.text.length);for(;e<t&&s.text[s.text.length-e-1]==a.text[a.text.length-e-1];)e++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){let e=$r(s.content,a.content,n-1,r-1);if(e)return e}n-=l,r-=l}else n-=l,r-=l}}Pr.prototype={constructor:Pr,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new Pr(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new Pr(n)},addToStart:function(e,t){return new Pr([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new Pr(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new Pr(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=Pr.from(e)).size?new Pr(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=Pr.from(e)).size?new Pr(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Pr.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},Pr.from=function(e){if(e instanceof Pr)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new Pr(t)};class zr{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,r=0,o){for(let i=0,s=0;s<t;i++){let a=this.content[i],l=s+a.nodeSize;if(l>e&&!1!==n(a,r+s,o||null,i)&&a.content.size){let o=s+1;a.nodesBetween(Math.max(0,e-o),Math.min(a.content.size,t-o),n,r+o)}s=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let o="",i=!0;return this.nodesBetween(e,t,(s,a)=>{let l=s.isText?s.text.slice(Math.max(e,a)-a,t-a):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(i?i=!1:o+=n),o+=l},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new zr(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let o=0,i=0;i<t;o++){let s=this.content[o],a=i+s.nodeSize;a>e&&((i<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),r+=s.nodeSize),i=a}return new zr(n,r)}cutByIndex(e,t){return e==t?zr.empty:0==e&&t==this.content.length?this:new zr(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new zr(r,o)}addToStart(e){return new zr([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new zr(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return Lr(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return $r(this,e,t,n)}findIndex(e){if(0==e)return Br(0,e);if(e==this.size)return Br(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,n=0;;t++){let r=n+this.child(t).nodeSize;if(r>=e)return r==e?Br(t+1,r):Br(t,n);n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return zr.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new zr(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return zr.empty;let t,n=0;for(let r=0;r<e.length;r++){let o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new zr(t||e,n)}static from(e){if(!e)return zr.empty;if(e instanceof zr)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new zr([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}zr.empty=new zr([],0);const Fr={index:0,offset:0};function Br(e,t){return Fr.index=e,Fr.offset=t,Fr}function Ur(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!Ur(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!Ur(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let Vr=class e{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ur(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return e.none;if(t instanceof e)return[t];let n=t.slice();return n.sort((e,t)=>e.type.rank-t.type.rank),n}};Vr.none=[];class _r extends Error{}class Hr{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=qr(this.content,e+this.openStart,t);return n&&new Hr(n,this.openStart,this.openEnd)}removeBetween(e,t){return new Hr(Wr(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Hr.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new Hr(zr.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)r++;return new Hr(e,n,r)}}function Wr(e,t,n){let{index:r,offset:o}=e.findIndex(t),i=e.maybeChild(r),{index:s,offset:a}=e.findIndex(n);if(o==t||i.isText){if(a!=n&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(r,i.copy(Wr(i.content,t-o-1,n-o-1)))}function qr(e,t,n,r){let{index:o,offset:i}=e.findIndex(t),s=e.maybeChild(o);if(i==t||s.isText)return r&&!r.canReplace(o,o,n)?null:e.cut(0,t).append(n).append(e.cut(t));let a=qr(s.content,t-i-1,n,s);return a&&e.replaceChild(o,s.copy(a))}function Kr(e,t,n){if(n.openStart>e.depth)throw new _r("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new _r("Inconsistent open depths");return Jr(e,t,n,0)}function Jr(e,t,n,r){let o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){let s=Jr(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){let{start:o,end:s}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let o=n-1;o>=0;o--)r=t.node(o).copy(zr.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return Zr(i,eo(e,o,s,t,r))}{let r=e.parent,o=r.content;return Zr(r,o.cut(0,e.parentOffset).append(n.content).append(o.cut(t.parentOffset)))}}return Zr(i,to(e,t,r))}function Yr(e,t){if(!t.type.compatibleContent(e.type))throw new _r("Cannot join "+t.type.name+" onto "+e.type.name)}function Gr(e,t,n){let r=e.node(n);return Yr(r,t.node(n)),r}function Xr(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function Qr(e,t,n,r){let o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(Xr(e.nodeAfter,r),i++));for(let a=i;a<s;a++)Xr(o.child(a),r);t&&t.depth==n&&t.textOffset&&Xr(t.nodeBefore,r)}function Zr(e,t){return e.type.checkContent(t),e.copy(t)}function eo(e,t,n,r,o){let i=e.depth>o&&Gr(e,t,o+1),s=r.depth>o&&Gr(n,r,o+1),a=[];return Qr(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(Yr(i,s),Xr(Zr(i,eo(e,t,n,r,o+1)),a)):(i&&Xr(Zr(i,to(e,t,o+1)),a),Qr(t,n,o,a),s&&Xr(Zr(s,to(n,r,o+1)),a)),Qr(r,null,o,a),new zr(a)}function to(e,t,n){let r=[];if(Qr(null,e,n,r),e.depth>n){Xr(Zr(Gr(e,t,n+1),to(e,t,n+1)),r)}return Qr(t,null,n,r),new zr(r)}Hr.empty=new Hr(zr.empty,0,0);class no{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let o=0;o<e;o++)r+=n.child(o).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return Vr.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new so(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],r=0,o=t;for(let i=e;;){let{index:e,offset:t}=i.content.findIndex(o),s=o-t;if(n.push(i,e,r+t),!s)break;if(i=i.child(e),i.isText)break;o=s-1,r+=t+1}return new no(t,n,o)}static resolveCached(e,t){let n=io.get(e);if(n)for(let o=0;o<n.elts.length;o++){let e=n.elts[o];if(e.pos==t)return e}else io.set(e,n=new ro);let r=n.elts[n.i]=no.resolve(e,t);return n.i=(n.i+1)%oo,r}}class ro{constructor(){this.elts=[],this.i=0}}const oo=12,io=new WeakMap;class so{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const ao=Object.create(null);class lo{constructor(e,t,n,r=Vr.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||zr.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&Ur(this.attrs,t||e.defaultAttrs||ao)&&Vr.sameSet(this.marks,n||Vr.none)}copy(e=null){return e==this.content?this:new lo(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new lo(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return Hr.empty;let r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new Hr(a,r.depth-i,o.depth-i)}replace(e,t,n){return Kr(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return no.resolveCached(this,e)}resolveNoCache(e){return no.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),uo(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=zr.empty,r=0,o=n.childCount){let i=this.contentMatchAt(e).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(let a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Vr.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Vr.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=zr.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,r,n);return o.type.checkAttrs(o.attrs),o}}lo.prototype.text=void 0;class co extends lo{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):uo(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new co(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new co(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function uo(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class ho{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new po(e,t);if(null==n.next)return ho.empty;let r=fo(n);n.next&&n.err("Unexpected trailing text");let o=function(e){let t=Object.create(null);return n(vo(e,0));function n(r){let o=[];r.forEach(t=>{e[t].forEach(({term:t,to:n})=>{if(!t)return;let r;for(let e=0;e<o.length;e++)o[e][0]==t&&(r=o[e][1]);vo(e,n).forEach(e=>{r||o.push([t,r=[]]),-1==r.indexOf(e)&&r.push(e)})})});let i=t[r.join(",")]=new ho(r.indexOf(e.length-1)>-1);for(let e=0;e<o.length;e++){let r=o[e][1].sort(yo);i.next.push({type:o[e][0],next:t[r.join(",")]||n(r)})}return i}}(function(e){let t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach(e=>e.to=t)}function i(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(i(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let s=n();return r(t,s),o(i(e.expr,s),s),[r(s)]}if("plus"==e.type){let s=n();return o(i(e.expr,t),s),o(i(e.expr,s),s),[r(s)]}if("opt"==e.type)return[r(t)].concat(i(e.expr,t));if("range"==e.type){let s=t;for(let t=0;t<e.min;t++){let t=n();o(i(e.expr,s),t),s=t}if(-1==e.max)o(i(e.expr,s),s);else for(let t=e.min;t<e.max;t++){let t=n();r(s,t),o(i(e.expr,s),t),s=t}return[r(s)]}if("name"==e.type)return[r(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let r=0;;r++){let s=i(e.exprs[r],t);if(r==e.exprs.length-1)return s;o(s,t=n())}}}(r));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],o=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:s}=e.next[t];i.push(n.name),!o||n.isText||n.hasRequiredAttrs()||(o=!1),-1==r.indexOf(s)&&r.push(s)}o&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function o(i,s){let a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return zr.from(s.map(e=>e.createAndFill()));for(let e=0;e<i.next.length;e++){let{type:t,next:n}=i.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==r.indexOf(n)){r.push(n);let e=o(n,s.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<o.next.length;e++){let{type:i,next:s}=o.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||r.type&&!s.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let o=0;o<t.next.length;o++)r+=(o?", ":"")+t.next[o].type.name+"->"+e.indexOf(t.next[o].next);return r}).join("\n")}}ho.empty=new ho(!0);class po{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function fo(e){let t=[];do{t.push(mo(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function mo(e){let t=[];do{t.push(go(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function go(e){let t=function(e){if(e.eat("(")){let t=fo(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let o=[];for(let i in n){let e=n[i];e.isInGroup(t)&&o.push(e)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=xo(e,t)}return t}function bo(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function xo(e,t){let n=bo(e),r=n;return e.eat(",")&&(r="}"!=e.next?bo(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function yo(e,t){return t-e}function vo(e,t){let n=[];return function t(r){let o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(let e=0;e<o.length;e++){let{term:r,to:i}=o[e];r||-1!=n.indexOf(i)||t(i)}}(t),n.sort(yo)}function wo(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function ko(e,t){let n=Object.create(null);for(let r in e){let o=t&&t[r];if(void 0===o){let t=e[r];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=t.default}n[r]=o}return n}function Co(e,t,n,r){for(let o in t)if(!(o in e))throw new RangeError(`Unsupported attribute ${o} for ${n} of type ${o}`);for(let o in e){let n=e[o];n.validate&&n.validate(t[o])}}function So(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new jo(e,r,t[r]);return n}let No=class e{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=So(e,n.attrs),this.defaultAttrs=wo(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ho.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:ko(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new lo(this,this.computeAttrs(e),zr.from(t),Vr.setFrom(n))}createChecked(e=null,t,n){return t=zr.from(t),this.checkContent(t),new lo(this,this.computeAttrs(e),t,Vr.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=zr.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),o=r&&r.fillBefore(zr.empty,!0);return o?new lo(this,e,t.append(o),Vr.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Co(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:Vr.none:e}static compile(t,n){let r=Object.create(null);t.forEach((t,o)=>r[t]=new e(t,n,o));let o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let e in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class jo{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let o=null===n?"null":typeof n;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${o}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Eo{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=So(e,r.attrs),this.excluded=null;let o=wo(this.attrs);this.instance=o?new Vr(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Vr(this,ko(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,o)=>n[e]=new Eo(e,r++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Co(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Mo{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=Pr.from(e.nodes),t.marks=Pr.from(e.marks||{}),this.nodes=No.compile(this.spec.nodes,this),this.marks=Eo.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let e=this.nodes[r],t=e.spec.content||"",o=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=ho.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==o?null:o?To(this,o.split(" ")):""!=o&&e.inlineContent?null:[]}for(let r in this.marks){let e=this.marks[r],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:To(this,t.split(" "))}this.nodeFromJSON=e=>lo.fromJSON(this,e),this.markFromJSON=e=>Vr.fromJSON(this,e),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof No))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new co(n,n.defaultAttrs,e,Vr.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function To(e,t){let n=[];for(let r=0;r<t.length;r++){let o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(let t in e.marks){let r=e.marks[t];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=r)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class Oo{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new Lo(this,t,!1);return n.addAll(e,Vr.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new Lo(this,t,!0);return n.addAll(e,Vr.none,t.from,t.to),Hr.maxOpen(n.finish())}matchTag(e,t,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let n=this.tags[r];if($o(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(!(0!=i.indexOf(e)||r.context&&!n.matchesContext(r.context)||i.length>e.length&&(61!=i.charCodeAt(e.length)||i.slice(e.length+1)!=t))){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let r in e.marks){let t=e.marks[r].spec.parseDOM;t&&t.forEach(e=>{n(e=zo(e)),e.mark||e.ignore||e.clearMark||(e.mark=r)})}for(let r in e.nodes){let t=e.nodes[r].spec.parseDOM;t&&t.forEach(e=>{n(e=zo(e)),e.node||e.ignore||e.mark||(e.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Oo(e,Oo.schemaRules(e)))}}const Ao={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Do={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Io={ol:!0,ul:!0};function Ro(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class Po{constructor(e,t,n,r,o,i){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=Vr.none,this.match=o||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(zr.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=zr.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(zr.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Ao.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Lo{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r,o=t.topNode,i=Ro(null,t.preserveWhitespace,0)|(n?4:0);r=o?new Po(o.type,o.attrs,Vr.none,!0,t.topMatch||o.type.contentMatch,i):new Po(n?null:e.schema.topNodeType,null,Vr.none,!0,null,i),this.nodes=[r],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0,{schema:i}=this.parser;if("full"===o||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)if("full"===o)n=n.replace(/\r\n?/g,"\n");else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let e=n.split(/\r?\n|\r/);for(let n=0;n<e.length;n++)n&&this.insertNode(i.linebreakReplacement.create(),t,!0),e[n]&&this.insertNode(i.text(e[n]),t,!/\S/.test(e[n]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],o=e.previousSibling;(!t||o&&"BR"==o.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,o=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i,s=e.nodeName.toLowerCase();Io.hasOwnProperty(s)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&Io.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));e:if(a?a.ignore:Do.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,r=this.needsBlock;if(Ao.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let i=a&&a.skip?t:this.readStyles(e,t);i&&this.addAll(e,i),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?i:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let e=this.parser.matchedStyles[r],o=n.getPropertyValue(e);if(o)for(let n;;){let r=this.parser.matchStyle(e,o,this,n);if(!r)break;if(r.ignore)return null;if(t=r.clearMark?t.filter(e=>!r.clearMark(e)):t.concat(this.parser.schema.marks[r.mark].create(r.attrs)),!1!==r.consuming)break;n=r}}return t}addElementByRule(e,t,n,r){let o,i;if(t.node)if(i=this.parser.schema.nodes[t.node],i.isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(o=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let s=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}o&&this.sync(s)&&this.open--}addAll(e,t,n,r){let o=n||0;for(let i=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i,t);this.findAtPoint(e,o)}findPlace(e,t,n){let r,o;for(let i=this.open,s=0;i>=0;i--){let t=this.nodes[i],a=t.findWrapping(e);if(a&&(!r||r.length>a.length+s)&&(r=a,o=t,!a.length))break;if(t.solid){if(n)break;s+=2}}if(!r)return null;this.sync(o);for(let i=0;i<r.length;i++)t=this.enterInner(r[i],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=Vr.none;for(let o of r.concat(e.marks))(t.type?t.type.allowsMarkType(o.type):Fo(o.type,e.type))&&(n=o.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let o=this.findPlace(e.create(t),n,!1);return o&&(o=this.enterInner(e,t,n,!0,r)),o}enterInner(e,t,n,r=!1,o){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let s=Ro(e,o,i.options);4&i.options&&0==i.content.length&&(s|=4);let a=Vr.none;return n=n.filter(t=>!(i.type?i.type.allowsMarkType(t.type):Fo(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new Po(e,t,a,r,null,s)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)){t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),i=(e,s)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;s>=o;s--)if(i(e-1,s))return!0;return!1}{let e=s>0||0==s&&r?this.nodes[s].type:n&&s>=o?n.node(s-o).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;s--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function $o(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function zo(e){let t={};for(let n in e)t[n]=e[n];return t}function Fo(e,t){let n=t.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(e))continue;let i=[],s=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:o}=e.edge(n);if(r==t)return!0;if(i.indexOf(o)<0&&s(o))return!0}};if(s(o.contentMatch))return!0}}class Bo{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=Vo(t).createDocumentFragment());let r=n,o=[];return e.forEach(e=>{if(o.length||e.marks.length){let n=0,i=0;for(;n<o.length&&i<e.marks.length;){let t=e.marks[i];if(this.marks[t.type.name]){if(!t.eq(o[n][0])||!1===t.type.spec.spanning)break;n++,i++}else i++}for(;n<o.length;)r=o.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],s=this.serializeMark(n,e.isInline,t);s&&(o.push([n,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=Wo(Vo(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&Wo(Vo(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return Wo(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Bo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Uo(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return Uo(e.marks)}}function Uo(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Vo(e){return e.document||window.document}const _o=new WeakMap;function Ho(e){let t=_o.get(e);return void 0===t&&_o.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function Wo(e,t,n,r){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let o,i=t[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=Ho(r))&&o.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s,a=i.indexOf(" ");a>0&&(n=i.slice(0,a),i=i.slice(a+1));let l=n?e.createElementNS(n,i):e.createElement(i),c=t[1],d=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){d=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):"style"==e&&l.style?l.style.cssText=c[e]:l.setAttribute(e,c[e])}}for(let u=d;u<t.length;u++){let o=t[u];if(0===o){if(u<t.length-1||u>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:i}=Wo(e,o,n,r);if(l.appendChild(t),i){if(s)throw new RangeError("Multiple content holes");s=i}}}return{dom:l,contentDOM:s}}const qo=Math.pow(2,16);function Ko(e,t){return e+t*qo}function Jo(e){return 65535&e}class Yo{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Go{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Go.empty)return Go.empty}recover(e){let t=0,n=Jo(e);if(!this.inverted)for(let r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/qo}(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?r:0);if(a>e)break;let l=this.ranges[s+o],c=this.ranges[s+i],d=a+l;if(e<=d){let o=a+r+((l?e==a?-1:e==d?1:t:t)<0?0:c);if(n)return o;let i=e==(t<0?a:d)?null:Ko(s/3,e-a),u=e==a?2:e==d?1:4;return(t<0?e!=a:e!=d)&&(u|=8),new Yo(o,u,i)}r+=c-l}return n?e+r:new Yo(e+r,0,null)}touches(e,t){let n=0,r=Jo(t),o=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let t=this.ranges[s]-(this.inverted?n:0);if(t>e)break;let a=this.ranges[s+o];if(e<=t+a&&s==3*r)return!0;n+=this.ranges[s+i]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),l=this.ranges[r+t],c=this.ranges[r+n];e(s,s+l,a,a+c),o+=c-l}}invert(){return new Go(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?Go.empty:new Go(e<0?[0,-e,0]:[0,0,e])}}Go.empty=new Go([]);class Xo{constructor(e,t,n=0,r=(e?e.length:0)){this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Xo(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new Xo;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let o=this.from;o<this.to;o++){let n=this._maps[o].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(o);if(null!=t&&t>o&&t<this.to){o=t,e=this._maps[t].recover(n.recover);continue}}r|=n.delInfo,e=n.pos}return n?e:new Yo(e,r,null)}}const Qo=Object.create(null);class Zo{getMap(){return Go.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Qo[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Qo)throw new RangeError("Duplicate use of step JSON ID "+e);return Qo[e]=t,t.prototype.jsonID=e,t}}class ei{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ei(e,null)}static fail(e){return new ei(null,e)}static fromReplace(e,t,n,r){try{return ei.ok(e.replace(t,n,r))}catch(o){if(o instanceof _r)return ei.fail(o.message);throw o}}}function ti(e,t,n){let r=[];for(let o=0;o<e.childCount;o++){let i=e.child(o);i.content.size&&(i=i.copy(ti(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return zr.fromArray(r)}class ni extends Zo{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new Hr(ti(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return ei.fromReplace(e,this.from,this.to,o)}invert(){return new ri(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new ni(t.pos,n.pos,this.mark)}merge(e){return e instanceof ni&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ni(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ni(t.from,t.to,e.markFromJSON(t.mark))}}Zo.jsonID("addMark",ni);class ri extends Zo{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new Hr(ti(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return ei.fromReplace(e,this.from,this.to,n)}invert(){return new ni(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new ri(t.pos,n.pos,this.mark)}merge(e){return e instanceof ri&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ri(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ri(t.from,t.to,e.markFromJSON(t.mark))}}Zo.jsonID("removeMark",ri);class oi extends Zo{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ei.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ei.fromReplace(e,this.pos,this.pos+1,new Hr(zr.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new oi(this.pos,t.marks[n]);return new oi(this.pos,this.mark)}}return new ii(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new oi(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new oi(t.pos,e.markFromJSON(t.mark))}}Zo.jsonID("addNodeMark",oi);class ii extends Zo{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ei.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ei.fromReplace(e,this.pos,this.pos+1,new Hr(zr.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new oi(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ii(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ii(t.pos,e.markFromJSON(t.mark))}}Zo.jsonID("removeNodeMark",ii);class si extends Zo{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&li(e,this.from,this.to)?ei.fail("Structure replace would overwrite content"):ei.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Go([this.from,this.to-this.from,this.slice.size])}invert(e){return new si(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new si(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof si)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?Hr.empty:new Hr(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new si(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?Hr.empty:new Hr(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new si(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new si(t.from,t.to,Hr.fromJSON(e,t.slice),!!t.structure)}}Zo.jsonID("replace",si);class ai extends Zo{constructor(e,t,n,r,o,i,s=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=s}apply(e){if(this.structure&&(li(e,this.from,this.gapFrom)||li(e,this.gapTo,this.to)))return ei.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ei.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?ei.fromReplace(e,this.from,this.to,n):ei.fail("Content does not fit in gap")}getMap(){return new Go([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ai(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||o>n.pos?null:new ai(t.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ai(t.from,t.to,t.gapFrom,t.gapTo,Hr.fromJSON(e,t.slice),t.insert,!!t.structure)}}function li(e,t,n){let r=e.resolve(t),o=n-t,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let e=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,o--}}return!1}function ci(e,t,n,r=n.contentMatch,o=!0){let i=e.doc.nodeAt(t),s=[],a=t+1;for(let l=0;l<i.childCount;l++){let t=i.child(l),c=a+t.nodeSize,d=r.matchType(t.type);if(d){r=d;for(let r=0;r<t.marks.length;r++)n.allowsMarkType(t.marks[r].type)||e.step(new ri(a,c,t.marks[r]));if(o&&t.isText&&"pre"!=n.whitespace){let e,r,o=/\r?\n|\r/g;for(;e=o.exec(t.text);)r||(r=new Hr(zr.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),s.push(new si(a+e.index,a+e.index+e[0].length,r))}}else s.push(new si(a,c,Hr.empty));a=c}if(!r.validEnd){let t=r.fillBefore(zr.empty,!0);e.replace(a,a,new Hr(t,0,0))}for(let l=s.length-1;l>=0;l--)e.step(s[l])}function di(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function ui(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,r=0,o=0;;--n){let i=e.$from.node(n),s=e.$from.index(n)+r,a=e.$to.indexAfter(n)-o;if(n<e.depth&&i.canReplace(s,a,t))return n;if(0==n||i.type.spec.isolating||!di(i,s,a))break;s&&(r=1),a<i.childCount&&(o=1)}return null}function hi(e,t,n=null,r=e){let o=function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;let s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}(e,t),i=o&&function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;let a=(s.length?s[s.length-1]:t).contentMatch;for(let l=r;a&&l<o;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?s:null}(r,t);return i?o.map(pi).concat({type:t,attrs:n}).concat(i.map(pi)):null}function pi(e){return{type:e,attrs:null}}function fi(e,t,n,r){t.forEach((o,i)=>{if(o.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(o.text);){let o=e.mapping.slice(r).map(n+1+i+s.index);e.replaceWith(o,o+1,t.type.schema.linebreakReplacement.create())}}})}function mi(e,t,n,r){t.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=e.mapping.slice(r).map(n+1+i);e.replaceWith(o,o+1,t.type.schema.text("\n"))}})}function gi(e,t,n=1,r){let o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,d=n-2;c>i;c--,d--){let e=o.node(c),t=o.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),i=r&&r[d+1];i&&(n=n.replaceChild(0,i.type.create(i.attrs)));let s=r&&r[d]||e;if(!e.canReplace(t+1,e.childCount)||!s.type.validContent(n))return!1}let a=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(a,a,l?l.type:o.node(i+1).type)}function bi(e,t){let n=e.resolve(t),r=n.index();return xi(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function xi(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let o=0;o<t.childCount;o++){let i=t.child(o),s=i.type==r?e.type.schema.nodes.text:i.type;if(n=n.matchType(s),!n)return!1;if(!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}function yi(e,t,n=-1){let r=e.resolve(t);for(let o=r.depth;;o--){let e,i,s=r.index(o);if(o==r.depth?(e=r.nodeBefore,i=r.nodeAfter):n>0?(e=r.node(o+1),s++,i=r.node(o).maybeChild(s)):(e=r.node(o).maybeChild(s-1),i=r.node(o+1)),e&&!e.isTextblock&&xi(e,i)&&r.node(o).canReplace(s,s+1))return t;if(0==o)break;t=n<0?r.before(o):r.after(o)}}function vi(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let o=n.content;for(let i=0;i<n.openStart;i++)o=o.firstChild.content;for(let i=1;i<=(0==n.openStart&&n.size?2:1);i++)for(let e=r.depth;e>=0;e--){let t=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,n=r.index(e)+(t>0?1:0),s=r.node(e),a=!1;if(1==i)a=s.canReplace(n,n,o);else{let e=s.contentMatchAt(n).findWrapping(o.firstChild.type);a=e&&s.canReplaceWith(n,n,e[0])}if(a)return 0==t?r.pos:t<0?r.before(e+1):r.after(e+1)}return null}function wi(e,t,n=t,r=Hr.empty){if(t==n&&!r.size)return null;let o=e.resolve(t),i=e.resolve(n);return ki(o,i,r)?new si(t,n,r):new Ci(o,i,r).fit()}function ki(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}Zo.jsonID("replaceAround",ai);class Ci{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=zr.empty;for(let r=0;r<=e.depth;r++){let t=e.node(r);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=zr.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let o=this.placed,i=n.depth,s=r.depth;for(;i&&s&&1==o.childCount;)o=o.firstChild.content,i--,s--;let a=new Hr(o,i,s);return e>-1?new ai(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new si(n.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,r=null;n?(r=ji(this.unplaced.content,n-1).firstChild,e=r.content):e=this.unplaced.content;let o=e.firstChild;for(let i=this.depth;i>=0;i--){let e,{type:s,match:a}=this.frontier[i],l=null;if(1==t&&(o?a.matchType(o.type)||(l=a.fillBefore(zr.from(o),!1)):r&&s.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:i,parent:r,inject:l};if(2==t&&o&&(e=a.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:i,parent:r,wrap:e};if(r&&a.matchType(r.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=ji(e,t);return!(!r.childCount||r.firstChild.isLeaf)&&(this.unplaced=new Hr(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=ji(e,t);if(r.childCount<=1&&t>0){let o=e.size-t<=t+r.size;this.unplaced=new Hr(Si(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new Hr(Si(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let f=0;f<o.length;f++)this.openFrontierNode(o[f]);let i=this.unplaced,s=n?n.content:i.content,a=i.openStart-e,l=0,c=[],{match:d,type:u}=this.frontier[t];if(r){for(let e=0;e<r.childCount;e++)c.push(r.child(e));d=d.matchFragment(r)}let h=s.size+e-(i.content.size-i.openEnd);for(;l<s.childCount;){let e=s.child(l),t=d.matchType(e.type);if(!t)break;l++,(l>1||0==a||e.content.size)&&(d=t,c.push(Ei(e.mark(u.allowedMarks(e.marks)),1==l?a:0,l==s.childCount?h:-1)))}let p=l==s.childCount;p||(h=-1),this.placed=Ni(this.placed,t,zr.from(c)),this.frontier[t].match=d,p&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=s;f<h;f++){let e=m.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),m=e.content}this.unplaced=p?0==e?Hr.empty:new Hr(Si(i.content,e-1,1),e-1,h<0?i.openEnd:e-1):new Hr(Si(i.content,e,l),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Mi(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=Mi(e,t,r,n,o);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],o=Mi(e,n,r,t,!0);if(!o||o.childCount)continue e}return{depth:t,fit:i,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Ni(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Ni(this.placed,this.depth,zr.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(zr.empty,!0);e.childCount&&(this.placed=Ni(this.placed,this.frontier.length,e))}}function Si(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(Si(e.firstChild.content,t-1,n)))}function Ni(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Ni(e.lastChild.content,t-1,n)))}function ji(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function Ei(e,t,n){if(t<=0)return e;let r=e.content;return t>1&&(r=r.replaceChild(0,Ei(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(zr.empty,!0)))),e.copy(r)}function Mi(e,t,n,r,o){let i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function Ti(e){return e.spec.defining||e.spec.definingForContent}function Oi(e,t,n,r,o){if(t<n){let o=e.firstChild;e=e.replaceChild(0,o.copy(Oi(o.content,t+1,n,r,o)))}if(t>r){let t=o.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(zr.empty,!0))}return e}function Ai(e,t){let n=[];for(let r=Math.min(e.depth,t.depth);r>=0;r--){let o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}class Di extends Zo{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return ei.fail("No node at attribute step's position");let n=Object.create(null);for(let o in t.attrs)n[o]=t.attrs[o];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return ei.fromReplace(e,this.pos,this.pos+1,new Hr(zr.from(r),0,t.isLeaf?0:1))}getMap(){return Go.empty}invert(e){return new Di(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Di(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Di(t.pos,t.attr,t.value)}}Zo.jsonID("attr",Di);class Ii extends Zo{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return ei.ok(n)}getMap(){return Go.empty}invert(e){return new Ii(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ii(t.attr,t.value)}}Zo.jsonID("docAttr",Ii);let Ri=class extends Error{};Ri=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(Ri.prototype=Object.create(Error.prototype)).constructor=Ri,Ri.prototype.name="TransformError";class Pi{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Xo}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Ri(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=Hr.empty){let r=wi(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new Hr(zr.from(n),0,0))}delete(e,t){return this.replace(e,t,Hr.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let o=e.doc.resolve(t),i=e.doc.resolve(n);if(ki(o,i,r))return e.step(new si(t,n,r));let s=Ai(o,i);0==s[s.length-1]&&s.pop();let a=-(o.depth+1);s.unshift(a);for(let h=o.depth,p=o.pos-1;h>0;h--,p--){let e=o.node(h).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;s.indexOf(h)>-1?a=h:o.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],d=r.openStart;for(let h=r.content,p=0;;p++){let e=h.firstChild;if(c.push(e),p==r.openStart)break;h=e.content}for(let h=d-1;h>=0;h--){let e=c[h],t=Ti(e.type);if(t&&!e.sameMarkup(o.node(Math.abs(a)-1)))d=h;else if(t||!e.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let t=(h+d+1)%(r.openStart+1),a=c[t];if(a)for(let c=0;c<s.length;c++){let d=s[(c+l)%s.length],u=!0;d<0&&(u=!1,d=-d);let h=o.node(d-1),p=o.index(d-1);if(h.canReplaceWith(p,p,a.type,a.marks))return e.replace(o.before(d),u?i.after(d):n,new Hr(Oi(r.content,0,r.openStart,t),t,r.openEnd))}}let u=e.steps.length;for(let h=s.length-1;h>=0&&(e.replace(t,n,r),!(e.steps.length>u));h--){let e=s[h];e<0||(t=o.before(e),n=i.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let o=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let o=r.depth-1;o>=0;o--){let e=r.index(o);if(r.node(o).canReplaceWith(e,e,n))return r.before(o+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let e=r.indexAfter(o);if(r.node(o).canReplaceWith(e,e,n))return r.after(o+1);if(e<r.node(o).childCount)return null}return null}(e.doc,t,r.type);null!=o&&(t=n=o)}e.replaceRange(t,n,new Hr(zr.from(r),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let r=e.doc.resolve(t),o=e.doc.resolve(n),i=Ai(r,o);for(let s=0;s<i.length;s++){let t=i[s],n=s==i.length-1;if(n&&0==t||r.node(t).type.contentMatch.validEnd)return e.delete(r.start(t),o.end(t));if(t>0&&(n||r.node(t-1).canReplace(r.index(t-1),o.indexAfter(t-1))))return e.delete(r.before(t),o.after(t))}for(let s=1;s<=r.depth&&s<=o.depth;s++)if(t-r.start(s)==r.depth-s&&n>r.end(s)&&o.end(s)-n!=o.depth-s&&r.start(s-1)==o.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),o.index(s-1)))return e.delete(r.before(s),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:r,$to:o,depth:i}=t,s=r.before(i+1),a=o.after(i+1),l=s,c=a,d=zr.empty,u=0;for(let f=i,m=!1;f>n;f--)m||r.index(f)>0?(m=!0,d=zr.from(r.node(f).copy(d)),u++):l--;let h=zr.empty,p=0;for(let f=i,m=!1;f>n;f--)m||o.after(f+1)<o.end(f)?(m=!0,h=zr.from(o.node(f).copy(h)),p++):c++;e.step(new ai(l,c,s,a,new Hr(d.append(h),u,p),d.size-u,!0))}(this,e,t),this}join(e,t=1){return function(e,t,n){let r=null,{linebreakReplacement:o}=e.doc.type.schema,i=e.doc.resolve(t-n),s=i.node().type;if(o&&s.inlineContent){let e="pre"==s.whitespace,t=!!s.contentMatch.matchType(o);e&&!t?r=!1:!e&&t&&(r=!0)}let a=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);mi(e,r.node(),r.before(),a)}s.inlineContent&&ci(e,t+n-1,s,i.node().contentMatchAt(i.index()),null==r);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new si(c,l.map(t+n,-1),Hr.empty,!0)),!0===r){let t=e.doc.resolve(c);fi(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return function(e,t,n){let r=zr.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let e=n[s].type.contentMatch.matchFragment(r);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=zr.from(n[s].type.create(n[s].attrs,r))}let o=t.start,i=t.end;e.step(new ai(o,i,o,i,new Hr(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,r=null){return function(e,t,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{let s="function"==typeof o?o(t):o;if(t.isTextblock&&!t.hasMarkup(r,s)&&function(e,t,n){let r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(e.doc,e.mapping.slice(i).map(n),r)){let o=null;if(r.schema.linebreakReplacement){let e="pre"==r.whitespace,t=!!r.contentMatch.matchType(r.schema.linebreakReplacement);e&&!t?o=!1:!e&&t&&(o=!0)}!1===o&&mi(e,t,n,i),ci(e,e.mapping.slice(i).map(n,1),r,void 0,null===o);let a=e.mapping.slice(i),l=a.map(n,1),c=a.map(n+t.nodeSize,1);return e.step(new ai(l,c,l+1,c-1,new Hr(zr.from(r.create(s,null,t.marks)),0,0),1,!0)),!0===o&&fi(e,t,n,i),!1}})}(this,e,t,n,r),this}setNodeMarkup(e,t,n=null,r){return function(e,t,n,r,o){let i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let s=n.create(r,null,o||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,s);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new ai(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new Hr(zr.from(s),0,0),1,!0))}(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new Di(e,t,n)),this}setDocAttribute(e,t){return this.step(new Ii(e,t)),this}addNodeMark(e,t){return this.step(new oi(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof Vr)t.isInSet(n.marks)&&this.step(new ii(e,t));else{let r,o=n.marks,i=[];for(;r=t.isInSet(o);)i.push(new ii(e,r)),o=r.removeFromSet(o);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e,t=1,n){return function(e,t,n=1,r){let o=e.doc.resolve(t),i=zr.empty,s=zr.empty;for(let a=o.depth,l=o.depth-n,c=n-1;a>l;a--,c--){i=zr.from(o.node(a).copy(i));let e=r&&r[c];s=zr.from(e?e.type.create(e.attrs,s):o.node(a).copy(s))}e.step(new si(t,t,new Hr(i.append(s),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){return function(e,t,n,r){let o,i,s=[],a=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let d=e.marks;if(!r.isInSet(d)&&c.type.allowsMarkType(r.type)){let c=Math.max(l,t),u=Math.min(l+e.nodeSize,n),h=r.addToSet(d);for(let e=0;e<d.length;e++)d[e].isInSet(h)||(o&&o.to==c&&o.mark.eq(d[e])?o.to=u:s.push(o=new ri(c,u,d[e])));i&&i.to==c?i.to=u:a.push(i=new ni(c,u,r))}}),s.forEach(t=>e.step(t)),a.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,r){let o=[],i=0;e.doc.nodesBetween(t,n,(e,s)=>{if(!e.isInline)return;i++;let a=null;if(r instanceof Eo){let t,n=e.marks;for(;t=r.isInSet(n);)(a||(a=[])).push(t),n=t.removeFromSet(n)}else r?r.isInSet(e.marks)&&(a=[r]):a=e.marks;if(a&&a.length){let r=Math.min(s+e.nodeSize,n);for(let e=0;e<a.length;e++){let n,l=a[e];for(let e=0;e<o.length;e++){let t=o[e];t.step==i-1&&l.eq(o[e].style)&&(n=t)}n?(n.to=r,n.step=i):o.push({style:l,from:Math.max(s,t),to:r,step:i})}}}),o.forEach(t=>e.step(new ri(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return ci(this,e,t,n),this}}const Li=Object.create(null);class $i{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new zi(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Hr.empty){let n=t.content.lastChild,r=null;for(let s=0;s<t.openEnd;s++)r=n,n=n.lastChild;let o=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:a,$to:l}=i[s],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(l.pos),s?Hr.empty:t),0==s&&Ji(e,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],a=e.mapping.slice(n),l=a.map(i.pos),c=a.map(s.pos);o?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),Ji(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new Ui(e):Ki(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let o=e.depth-1;o>=0;o--){let r=t<0?Ki(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):Ki(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(r)return r}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Wi(e.node(0))}static atStart(e){return Ki(e,e,0,0,1)||new Wi(e)}static atEnd(e){return Ki(e,e,e.content.size,e.childCount,-1)||new Wi(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Li[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Li)throw new RangeError("Duplicate use of selection JSON ID "+e);return Li[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Ui.between(this.$anchor,this.$head).getBookmark()}}$i.prototype.visible=!0;class zi{constructor(e,t){this.$from=e,this.$to=t}}let Fi=!1;function Bi(e){Fi||e.parent.inlineContent||(Fi=!0)}class Ui extends $i{constructor(e,t=e){Bi(e),Bi(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return $i.near(n);let r=e.resolve(t.map(this.anchor));return new Ui(r.parent.inlineContent?r:n,n)}replace(e,t=Hr.empty){if(super.replace(e,t),t==Hr.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof Ui&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Vi(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ui(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if(n&&!r||(n=r>=0?1:-1),!t.parent.inlineContent){let e=$i.findFrom(t,n,!0)||$i.findFrom(t,-n,!0);if(!e)return $i.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r||(e=($i.findFrom(e,-n,!0)||$i.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0)&&(e=t),new Ui(e,t)}}$i.jsonID("text",Ui);class Vi{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Vi(e.map(this.anchor),e.map(this.head))}resolve(e){return Ui.between(e.resolve(this.anchor),e.resolve(this.head))}}class _i extends $i{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),o=e.resolve(r);return n?$i.near(o):new _i(o)}content(){return new Hr(zr.from(this.node),0,0)}eq(e){return e instanceof _i&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Hi(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new _i(e.resolve(t.anchor))}static create(e,t){return new _i(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}_i.prototype.visible=!1,$i.jsonID("node",_i);class Hi{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new Vi(n,n):new Hi(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&_i.isSelectable(n)?new _i(t):$i.near(t)}}class Wi extends $i{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Hr.empty){if(t==Hr.empty){e.delete(0,e.doc.content.size);let t=$i.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Wi(e)}map(e){return new Wi(e)}eq(e){return e instanceof Wi}getBookmark(){return qi}}$i.jsonID("all",Wi);const qi={map(){return this},resolve:e=>new Wi(e)};function Ki(e,t,n,r,o,i=!1){if(t.inlineContent)return Ui.create(e,n);for(let s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){let r=t.child(s);if(r.isAtom){if(!i&&_i.isSelectable(r))return _i.create(e,n-(o<0?r.nodeSize:0))}else{let t=Ki(e,r,n+o,o<0?r.childCount:0,o,i);if(t)return t}n+=r.nodeSize*o}return null}function Ji(e,t,n){let r=e.steps.length-1;if(r<t)return;let o,i=e.steps[r];(i instanceof si||i instanceof ai)&&(e.mapping.maps[r].forEach((e,t,n,r)=>{null==o&&(o=r)}),e.setSelection($i.near(e.doc.resolve(o),n)))}class Yi extends Pi{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return Vr.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Vr.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let e=this.doc.resolve(t);o=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.selection.to!=t+e.length||this.setSelection($i.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function Gi(e,t){return t&&e?e.bind(t):e}class Xi{constructor(e,t,n){this.name=e,this.init=Gi(t.init,n),this.apply=Gi(t.apply,n)}}const Qi=[new Xi("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new Xi("selection",{init:(e,t)=>e.selection||$i.atStart(t.doc),apply:e=>e.selection}),new Xi("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new Xi("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class Zi{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Qi.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new Xi(e.key,e.spec.state,e))})}}class es{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let s=this.config.plugins[i];if(s.spec.appendTransaction){let a=r?r[i].n:0,l=r?r[i].state:this,c=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new es(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new Yi(this)}static create(e){let t=new Zi(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new es(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new Zi(this.schema,e.plugins),n=t.fields,r=new es(t);for(let o=0;o<n.length;o++){let t=n[o].name;r[t]=this.hasOwnProperty(t)?this[t]:n[o].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new Zi(e.schema,e.plugins),o=new es(r);return r.fields.forEach(r=>{if("doc"==r.name)o.doc=lo.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=$i.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let i in n){let s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=a.fromJSON.call(s,e,t[i],o))}o[r.name]=r.init(e,o)}}),o}}function ts(e,t,n){for(let r in e){let o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=ts(o,t,{})),n[r]=o}return n}class ns{constructor(e){this.spec=e,this.props={},e.props&&ts(e.props,this,this.props),this.key=e.key?e.key.key:is("plugin")}getState(e){return e[this.key]}}const rs=Object.create(null);function is(e){return e in rs?e+"$"+ ++rs[e]:(rs[e]=0,e+"$")}class ss{constructor(e="key"){this.key=is(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const as=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function ls(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const cs=(e,t,n)=>{let r=ls(e,n);if(!r)return!1;let o=ps(r);if(!o){let n=r.blockRange(),o=n&&ui(n);return null!=o&&(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)}let i=o.nodeBefore;if(Cs(e,o,t,-1))return!0;if(0==r.parent.content.size&&(us(i,"end")||_i.isSelectable(i)))for(let s=r.depth;;s--){let n=wi(e.doc,r.before(s),r.after(s),Hr.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(us(i,"end")?$i.findFrom(r.doc.resolve(r.mapping.map(o.pos,-1)),-1):_i.create(r.doc,o.pos-i.nodeSize)),t(r.scrollIntoView())}return!0}if(1==s||r.node(s-1).childCount>1)break}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0)};function ds(e,t,n){let r=t.nodeBefore,o=t.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let i=t.nodeAfter,s=t.pos+1;for(;!i.isTextblock;s++){if(i.type.spec.isolating)return!1;let e=i.firstChild;if(!e)return!1;i=e}let a=wi(e.doc,o,s,Hr.empty);if(!a||a.from!=o||a instanceof si&&a.slice.size>=s-o)return!1;if(n){let t=e.tr.step(a);t.setSelection(Ui.create(t.doc,o)),n(t.scrollIntoView())}return!0}function us(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const hs=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;i=ps(r)}let s=i&&i.nodeBefore;return!(!s||!_i.isSelectable(s))&&(t&&t(e.tr.setSelection(_i.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function ps(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function fs(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const ms=(e,t,n)=>{let r=fs(e,n);if(!r)return!1;let o=bs(r);if(!o)return!1;let i=o.nodeAfter;if(Cs(e,o,t,1))return!0;if(0==r.parent.content.size&&(us(i,"start")||_i.isSelectable(i))){let n=wi(e.doc,r.before(),r.after(),Hr.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(us(i,"start")?$i.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):_i.create(r.doc,r.mapping.map(o.pos))),t(r.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)},gs=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;i=bs(r)}let s=i&&i.nodeAfter;return!(!s||!_i.isSelectable(s))&&(t&&t(e.tr.setSelection(_i.create(e.doc,i.pos)).scrollIntoView()),!0)};function bs(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const xs=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function ys(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const vs=(e,t)=>{let n=e.selection,{$from:r,$to:o}=n;if(n instanceof Wi||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=ys(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=e.tr.insert(n,i.createAndFill());s.setSelection(Ui.create(s.doc,n+1)),t(s.scrollIntoView())}return!0},ws=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(gi(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),o=r&&ui(r);return null!=o&&(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)};const ks=(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof _i&&e.selection.node.isBlock)return!(!n.parentOffset||!gi(e.doc,n.pos)||(t&&t(e.tr.split(n.pos).scrollIntoView()),0));if(!n.depth)return!1;let o,i,s=[],a=!1,l=!1;for(let h=n.depth;;h--){if(n.node(h).isBlock){a=n.end(h)==n.pos+(n.depth-h),l=n.start(h)==n.pos-(n.depth-h),i=ys(n.node(h-1).contentMatchAt(n.indexAfter(h-1))),s.unshift(a&&i?{type:i}:null),o=h;break}if(1==h)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof Ui||e.selection instanceof Wi)&&c.deleteSelection();let d=c.mapping.map(n.pos),u=gi(c.doc,d,s.length,s);if(u||(s[0]=i?{type:i}:null,u=gi(c.doc,d,s.length,s)),!u)return!1;if(c.split(d,s.length,s),!a&&l&&n.node(o).type!=i){let e=c.mapping.map(n.before(o)),t=c.doc.resolve(e);i&&n.node(o-1).canReplaceWith(t.index(),t.index()+1,i)&&c.setNodeMarkup(c.mapping.map(n.before(o)),i)}return t&&t(c.scrollIntoView()),!0};function Cs(e,t,n,r){let o,i,s=t.nodeBefore,a=t.nodeAfter,l=s.type.spec.isolating||a.type.spec.isolating;if(!l&&function(e,t,n){let r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(i,i+1)||!o.isTextblock&&!bi(e.doc,t.pos)||(n&&n(e.tr.join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(o=(i=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&i.matchType(o[0]||a.type).validEnd){if(n){let r=t.pos+a.nodeSize,i=zr.empty;for(let e=o.length-1;e>=0;e--)i=zr.from(o[e].create(null,i));i=zr.from(s.copy(i));let l=e.tr.step(new ai(t.pos-1,r,t.pos,r,new Hr(i,1,0),o.length,!0)),c=l.doc.resolve(r+2*o.length);c.nodeAfter&&c.nodeAfter.type==s.type&&bi(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let d=a.type.spec.isolating||r>0&&l?null:$i.findFrom(t,1),u=d&&d.$from.blockRange(d.$to),h=u&&ui(u);if(null!=h&&h>=t.depth)return n&&n(e.tr.lift(u,h).scrollIntoView()),!0;if(c&&us(a,"start",!0)&&us(s,"end")){let r=s,o=[];for(;o.push(r),!r.isTextblock;)r=r.lastChild;let i=a,l=1;for(;!i.isTextblock;i=i.firstChild)l++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=zr.empty;for(let e=o.length-1;e>=0;e--)r=zr.from(o[e].copy(r));n(e.tr.step(new ai(t.pos-o.length,t.pos+a.nodeSize,t.pos+l,t.pos+a.nodeSize-l,new Hr(r,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Ss(e){return function(t,n){let r=t.selection,o=e<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(t.tr.setSelection(Ui.create(t.doc,e<0?o.start(i):o.end(i)))),!0)}}const Ns=Ss(-1),js=Ss(1);function Es(e,t=null){return function(n,r){let o=!1;for(let i=0;i<n.selection.ranges.length&&!o;i++){let{$from:{pos:r},$to:{pos:s}}=n.selection.ranges[i];n.doc.nodesBetween(r,s,(r,i)=>{if(o)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)o=!0;else{let t=n.doc.resolve(i),r=t.index();o=t.parent.canReplaceWith(r,r+1,e)}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];o.setBlockType(i,s,e,t)}r(o.scrollIntoView())}return!0}}function Ms(...e){return function(t,n,r){for(let o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}function Ts(e,t=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i);if(!s)return!1;let a=r?n.tr:null;return!!function(e,t,n,r=null){let o=!1,i=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=s.resolve(t.start-2);i=new so(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new so(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),o=!0}let a=hi(i,n,r,t);if(!a)return!1;e&&function(e,t,n,r,o){let i=zr.empty;for(let d=n.length-1;d>=0;d--)i=zr.from(n[d].type.create(n[d].attrs,i));e.step(new ai(t.start-(r?2:0),t.end,t.start,t.end,new Hr(i,0,0),n.length,!0));let s=0;for(let d=0;d<n.length;d++)n[d].type==o&&(s=d+1);let a=n.length-s,l=t.start+n.length-(r?2:0),c=t.parent;for(let d=t.startIndex,u=t.endIndex,h=!0;d<u;d++,h=!1)!h&&gi(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(d).nodeSize}(e,t,a,o,n);return!0}(a,s,e,t)&&(r&&r(a.scrollIntoView()),!0)}}function Os(e){return function(t,n){let{$from:r,$to:o}=t.selection,i=r.blockRange(o,t=>t.childCount>0&&t.firstChild.type==e);return!!i&&(!n||(r.node(i.depth-1).type==e?function(e,t,n,r){let o=e.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new ai(i-1,s,i,s,new Hr(zr.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new so(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));const a=ui(r);if(null==a)return!1;o.lift(r,a);let l=o.doc.resolve(o.mapping.map(i,-1)-1);bi(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos);return t(o.scrollIntoView()),!0}(t,n,e,i):function(e,t,n){let r=e.tr,o=n.parent;for(let p=n.end,f=n.endIndex-1,m=n.startIndex;f>m;f--)p-=o.child(f).nodeSize,r.delete(p-1,p+1);let i=r.doc.resolve(n.start),s=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==o.childCount,c=i.node(-1),d=i.index(-1);if(!c.canReplace(d+(a?0:1),d+1,s.content.append(l?zr.empty:zr.from(o))))return!1;let u=i.pos,h=u+s.nodeSize;return r.step(new ai(u-(a?1:0),h+(l?1:0),u+1,h-1,new Hr((a?zr.empty:zr.from(o.copy(zr.empty))).append(l?zr.empty:zr.from(o.copy(zr.empty))),a?0:1,l?0:1),a?0:1)),t(r.scrollIntoView()),!0}(t,n,i)))}}Ms(as,cs,hs),Ms(as,ms,gs),Ms(xs,vs,ws,ks),"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();const As=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},Ds=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let Is=null;const Rs=function(e,t,n){let r=Is||(Is=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},Ps=function(e,t,n,r){return n&&($s(e,t,n,r,-1)||$s(e,t,n,r,1))},Ls=/^(img|br|input|textarea|hr)$/i;function $s(e,t,n,r,o){for(var i;;){if(e==n&&t==r)return!0;if(t==(o<0?0:zs(e))){let n=e.parentNode;if(!n||1!=n.nodeType||Fs(e)||Ls.test(e.nodeName)||"false"==e.contentEditable)return!1;t=As(e)+(o<0?0:1),e=n}else{if(1!=e.nodeType)return!1;{let n=e.childNodes[t+(o<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(i=n.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;t+=o}else e=n,t=o<0?zs(e):0}}}}function zs(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Fs(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const Bs=function(e){return e.focusNode&&Ps(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Us(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const Vs="undefined"!=typeof navigator?navigator:null,_s="undefined"!=typeof document?document:null,Hs=Vs&&Vs.userAgent||"",Ws=/Edge\/(\d+)/.exec(Hs),qs=/MSIE \d/.exec(Hs),Ks=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Hs),Js=!!(qs||Ks||Ws),Ys=qs?document.documentMode:Ks?+Ks[1]:Ws?+Ws[1]:0,Gs=!Js&&/gecko\/(\d+)/i.test(Hs);Gs&&(/Firefox\/(\d+)/.exec(Hs)||[0,0])[1];const Xs=!Js&&/Chrome\/(\d+)/.exec(Hs),Qs=!!Xs,Zs=Xs?+Xs[1]:0,ea=!Js&&!!Vs&&/Apple Computer/.test(Vs.vendor),ta=ea&&(/Mobile\/\w+/.test(Hs)||!!Vs&&Vs.maxTouchPoints>2),na=ta||!!Vs&&/Mac/.test(Vs.platform),ra=!!Vs&&/Win/.test(Vs.platform),oa=/Android \d/.test(Hs),ia=!!_s&&"webkitFontSmoothing"in _s.documentElement.style,sa=ia?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function aa(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function la(e,t){return"number"==typeof e?e:e[t]}function ca(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function da(e,t,n){let r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let s=n||e.dom;s;){if(1!=s.nodeType){s=Ds(s);continue}let e=s,n=e==i.body,a=n?aa(i):ca(e),l=0,c=0;if(t.top<a.top+la(r,"top")?c=-(a.top-t.top+la(o,"top")):t.bottom>a.bottom-la(r,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+la(o,"top")-a.top:t.bottom-a.bottom+la(o,"bottom")),t.left<a.left+la(r,"left")?l=-(a.left-t.left+la(o,"left")):t.right>a.right-la(r,"right")&&(l=t.right-a.right+la(o,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let o=e.scrollLeft-n,i=e.scrollTop-r;t={left:t.left-o,top:t.top-i,right:t.right-o,bottom:t.bottom-i}}let d=n?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(d))break;s="absolute"==d?s.offsetParent:Ds(s)}}function ua(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=Ds(r));return t}function ha(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:o,left:i}=e[n];r.scrollTop!=o+t&&(r.scrollTop=o+t),r.scrollLeft!=i&&(r.scrollLeft=i)}}let pa=null;function fa(e,t){let n,r,o,i,s=2e8,a=0,l=t.top,c=t.top;for(let d=e.firstChild,u=0;d;d=d.nextSibling,u++){let e;if(1==d.nodeType)e=d.getClientRects();else{if(3!=d.nodeType)continue;e=Rs(d).getClientRects()}for(let h=0;h<e.length;h++){let p=e[h];if(p.top<=l&&p.bottom>=c){l=Math.max(p.bottom,l),c=Math.min(p.top,c);let e=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(e<s){n=d,s=e,r=e&&3==n.nodeType?{left:p.right<t.left?p.right:p.left,top:t.top}:t,1==d.nodeType&&e&&(a=u+(t.left>=(p.left+p.right)/2?1:0));continue}}else p.top>t.top&&!o&&p.left<=t.left&&p.right>=t.left&&(o=d,i={left:Math.max(p.left,Math.min(p.right,t.left)),top:p.top});!n&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(a=u+1)}}return!n&&o&&(n=o,r=i,s=0),n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);let n=ya(r,1);if(n.top!=n.bottom&&ma(t,n))return{node:e,offset:o+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||s&&1==n.nodeType?{node:e,offset:a}:fa(n,r)}function ma(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function ga(e,t,n){let r=e.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){let n=e.childNodes[i];if(1==n.nodeType){let e=n.getClientRects();for(let r=0;r<e.length;r++){let o=e[r];if(ma(t,o))return ga(n,t,o)}}if((i=(i+1)%r)==o)break}return e}function ba(e,t){let n,r=e.dom.ownerDocument,o=0,i=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(zs(r.offsetNode),r.offset)}}catch(r){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(zs(r.startContainer),r.startOffset)}}}(r,t.left,t.top);i&&({node:n,offset:o}=i);let s,a=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=e.dom.getBoundingClientRect();if(!ma(t,n))return null;if(a=ga(e.dom,t,n),!a)return null}if(ea)for(let c=a;n&&c;c=Ds(c))c.draggable&&(n=void 0);if(a=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(a,t),n){if(Gs&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let e,r=n.childNodes[o];"IMG"==r.nodeName&&(e=r.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&o++}let r;ia&&o&&1==n.nodeType&&1==(r=n.childNodes[o-1]).nodeType&&"false"==r.contentEditable&&r.getBoundingClientRect().top>=t.top&&o--,n==e.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?s=e.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(s=function(e,t,n,r){let o=-1;for(let i=t,s=!1;i!=e.dom;){let t,n=e.docView.nearestDesc(i,!0);if(!n)return null;if(1==n.dom.nodeType&&(n.node.isBlock&&n.parent||!n.contentDOM)&&((t=n.dom.getBoundingClientRect()).width||t.height)&&(n.node.isBlock&&n.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(n.dom.nodeName)&&(!s&&t.left>r.left||t.top>r.top?o=n.posBefore:(!s&&t.right<r.left||t.bottom<r.top)&&(o=n.posAfter),s=!0),!n.contentDOM&&o<0&&!n.node.isText))return(n.node.isBlock?r.top<(t.top+t.bottom)/2:r.left<(t.left+t.right)/2)?n.posBefore:n.posAfter;i=n.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n,-1)}(e,n,o,t))}null==s&&(s=function(e,t,n){let{node:r,offset:o}=fa(t,n),i=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();i=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,o,i)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:s,inside:l?l.posAtStart-l.border:-1}}function xa(e){return e.top<e.bottom||e.left<e.right}function ya(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(xa(e))return e}return Array.prototype.find.call(n,xa)||e.getBoundingClientRect()}const va=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function wa(e,t,n){let{node:r,offset:o,atom:i}=e.docView.domFromPos(t,n<0?-1:1),s=ia||Gs;if(3==r.nodeType){if(!s||!va.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let e=o,t=o,i=n<0?1:-1;return n<0&&!o?(t++,i=-1):n>=0&&o==r.nodeValue.length?(e--,i=1):n<0?e--:t++,ka(ya(Rs(r,e,t),i),i<0)}{let e=ya(Rs(r,o,o),n);if(Gs&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let t=ya(Rs(r,o-1,o-1),-1);if(t.top==e.top){let n=ya(Rs(r,o,o+1),-1);if(n.top!=e.top)return ka(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&o&&(n<0||o==zs(r))){let e=r.childNodes[o-1];if(1==e.nodeType)return Ca(e.getBoundingClientRect(),!1)}if(null==i&&o<zs(r)){let e=r.childNodes[o];if(1==e.nodeType)return Ca(e.getBoundingClientRect(),!0)}return Ca(r.getBoundingClientRect(),n>=0)}if(null==i&&o&&(n<0||o==zs(r))){let e=r.childNodes[o-1],t=3==e.nodeType?Rs(e,zs(e)-(s?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return ka(ya(t,1),!1)}if(null==i&&o<zs(r)){let e=r.childNodes[o];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?Rs(e,0,s?0:1):1==e.nodeType?e:null:null;if(t)return ka(ya(t,-1),!0)}return ka(ya(3==r.nodeType?Rs(r):r,-n),n>=0)}function ka(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Ca(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function Sa(e,t,n){let r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}const Na=/[\u0590-\u08ac]/;let ja=null,Ea=null,Ma=!1;function Ta(e,t,n){return ja==t&&Ea==n?Ma:(ja=t,Ea=n,Ma="up"==n||"down"==n?function(e,t,n){let r=t.selection,o="up"==n?r.$from:r.$to;return Sa(e,t,()=>{let{node:t}=e.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=wa(e,o.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=Rs(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let o=t[e];if(o.bottom>o.top+1&&("up"==n?r.top-o.top>2*(o.bottom-r.top):o.bottom-r.bottom>2*(r.bottom-o.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=e.domSelection();return a?Na.test(r.parent.textContent)&&a.modify?Sa(e,t,()=>{let{focusNode:t,focusOffset:o,anchorNode:i,anchorOffset:s}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:d,focusOffset:u}=e.domSelectionRange(),h=d&&!c.contains(1==d.nodeType?d:d.parentNode)||t==d&&o==u;try{a.collapse(i,s),t&&(t!=i||o!=s)&&a.extend&&a.extend(t,o)}catch(p){}return null!=l&&(a.caretBidiLevel=l),h}):"left"==n||"backward"==n?i:s:r.pos==r.start()||r.pos==r.end()}(e,t,n))}class Oa{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}let r;if(e==this.dom&&this.contentDOM)r=t>As(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let o,i=this.getDesc(r);if(i&&(!t||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==e.nodeType?e:e.parentNode):o==e))return i;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<o)return r.descAt(e-n-r.border);n=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let o=0;n<this.children.length;n++){let t=this.children[n],i=o+t.size;if(i>e||t instanceof $a){r=e-o;break}o=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof Aa&&o.side>=0;n--);if(t<=0){let e,r=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?As(e.dom)+1:0}}{let e,r=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?As(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let i=n,s=0;;s++){let n=this.children[s],a=i+n.size;if(-1==r&&e<=a){let o=i+n.border;if(e>=o&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,o);e=i;for(let t=s;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=As(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(a>t||s==this.children.length-1)){t=a;for(let e=s+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){o=As(n.dom);break}t+=n.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=a}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let o=Math.min(e,t),i=Math.max(e,t);for(let p=0,f=0;p<this.children.length;p++){let s=this.children[p],a=f+s.size;if(o>f&&i<a)return s.setSelection(e-f-s.border,t-f-s.border,n,r);f=a}let s=this.domFromPos(e,e?-1:1),a=t==e?s:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),d=!1;if((Gs||ea)&&e==t){let{node:e,offset:t}=s;if(3==e.nodeType){if(d=!(!t||"\n"!=e.nodeValue[t-1]),d&&t==e.nodeValue.length)for(let n,r=e;r;r=r.parentNode){if(n=r.nextSibling){"BR"==n.nodeName&&(s=a={node:n.parentNode,offset:As(n)+1});break}let e=r.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];d=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(Gs&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||d&&ea)&&Ps(s.node,s.offset,c.anchorNode,c.anchorOffset)&&Ps(a.node,a.offset,c.focusNode,c.focusOffset))return;let u=!1;if((l.extend||e==t)&&(!d||!Gs)){l.collapse(s.node,s.offset);try{e!=t&&l.extend(a.node,a.offset),u=!0}catch(h){}}if(!u){if(e>t){let e=s;s=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){let r=n+o.border,s=i-o.border;if(e>=r&&t<=s)return this.dirty=e==n||t==i?2:1,void(e!=r||t!=s||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-r,t-r):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Aa extends Oa{constructor(e,t,n,r){let o,i=t.type.toDOM;if("function"==typeof i&&(i=i(n,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:r)),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Da extends Oa{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class Ia extends Oa{constructor(e,t,n,r,o){super(e,[],n,r),this.mark=t,this.spec=o}static create(e,t,n,r){let o=r.nodeViews[t.type.name],i=o&&o(t,r,n);return i&&i.dom||(i=Bo.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new Ia(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=Ia.create(this.parent,this.mark,!0,n),o=this.children,i=this.size;t<i&&(o=Ga(o,t,i,n)),e>0&&(o=Ga(o,0,e,n));for(let s=0;s<o.length;s++)o[s].parent=r;return r.children=o,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ra extends Oa{constructor(e,t,n,r,o,i,s,a,l){super(e,[],o,i),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=s}static create(e,t,n,r,o,i){let s,a=o.nodeViews[t.type.name],l=a&&a(t,o,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:i,n,r),c=l&&l.dom,d=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=Bo.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:d}=e)}d||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return c=Wa(c,n,t),l?s=new za(e,t,n,r,c,d||null,u,l,o,i+1):t.isText?new La(e,t,n,r,c,u,o):new Ra(e,t,n,r,c,d||null,u,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>zr.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&qa(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,o=e.composing?this.localCompositionInfo(e,t):null,i=o&&o.pos>-1?o:null,s=o&&o.pos<0,a=new Ja(this,i&&i.node,e);!function(e,t,n,r){let o=t.locals(e),i=0;if(0==o.length){for(let n=0;n<e.childCount;n++){let s=e.child(n);r(s,o,t.forChild(i,s),n),i+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let d,u,h,p;for(;s<o.length&&o[s].to==i;){let e=o[s++];e.widget&&(d?(u||(u=[d])).push(e):d=e)}if(d)if(u){u.sort(Ya);for(let e=0;e<u.length;e++)n(u[e],c,!!l)}else n(d,c,!!l);if(l)p=-1,h=l,l=null;else{if(!(c<e.childCount))break;p=c,h=e.child(c++)}for(let e=0;e<a.length;e++)a[e].to<=i&&a.splice(e--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);let f=i+h.nodeSize;if(h.isText){let e=f;s<o.length&&o[s].from<e&&(e=o[s].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=h.cut(e-i),h=h.cut(0,e-i),f=e,p=-1)}else for(;s<o.length&&o[s].to<f;)s++;r(h,h.isInline&&!h.isLeaf?a.filter(e=>!e.inline):a.slice(),t.forChild(i,h),p),i=f}}(this.node,this.innerDeco,(t,o,i)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!i&&a.syncToMarks(o==this.node.childCount?Vr.none:this.node.child(o).marks,n,e),a.placeWidget(t,e,r)},(t,i,l,c)=>{let d;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,i,l,c)||s&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(d=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(t,i,l,d,e)||a.updateNextNode(t,i,l,e,c,r)||a.addNode(t,i,l,e,r),r+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),Fa(this.contentDOM,this.children,e),ta&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof Ui)||n<t||r>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let e=o.nodeValue,i=function(e,t,n,r){for(let o=0,i=0;o<e.childCount&&i<=r;){let s=e.child(o++),a=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;o<e.childCount;){let t=e.child(o++);if(i+=t.nodeSize,!t.isText)break;l+=t.text}if(i>=n){if(i>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let e=a<r?l.lastIndexOf(t,r-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return-1}(this.node.content,e,n-t,r-t);return i<0?null:{node:o,pos:i,text:e}}return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let i=new Da(this,o,t,r);e.input.compositionNodes.push(i),this.children=Ga(this.children,n,n+r.length,e,i)}update(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(qa(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=_a(this.dom,this.nodeDOM,Va(this.outerDeco,this.node,t),Va(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Pa(e,t,n,r,o){Wa(r,t,e);let i=new Ra(void 0,e,t,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class La extends Ra{constructor(e,t,n,r,o,i,s){super(e,t,n,r,o,null,i,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),o=document.createTextNode(r.text);return new La(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class $a extends Oa{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class za extends Ra{constructor(e,t,n,r,o,i,s,a,l,c){super(e,t,n,r,o,i,s,l,c),this.spec=a}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,n);return o&&this.updateInner(e,t,n,r),o}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Fa(e,t,n){let r=e.firstChild,o=!1;for(let i=0;i<t.length;i++){let s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=r;)r=Ka(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(a,r);if(s instanceof Ia){let t=r?r.previousSibling:e.lastChild;Fa(s.contentDOM,s.children,n),r=t?t.nextSibling:e.firstChild}}for(;r;)r=Ka(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}const Ba=function(e){e&&(this.nodeName=e)};Ba.prototype=Object.create(null);const Ua=[new Ba];function Va(e,t,n){if(0==e.length)return Ua;let r=n?Ua[0]:new Ba,o=[r];for(let i=0;i<e.length;i++){let s=e[i].type.attrs;if(s){s.nodeName&&o.push(r=new Ba(s.nodeName));for(let e in s){let i=s[e];null!=i&&(n&&1==o.length&&o.push(r=new Ba(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+i:"style"==e?r.style=(r.style?r.style+";":"")+i:"nodeName"!=e&&(r[e]=i))}}}return o}function _a(e,t,n,r){if(n==Ua&&r==Ua)return t;let o=t;for(let i=0;i<r.length;i++){let t=r[i],s=n[i];if(i){let n;s&&s.nodeName==t.nodeName&&o!=e&&(n=o.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(o),s=Ua[0]),o=n}Ha(o,s||Ua[0],t)}return o}function Ha(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==o.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<o.length;t++)-1==r.indexOf(o[t])&&e.classList.add(o[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=r.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function Wa(e,t,n){return _a(e,e,Ua,Va(t,n,1!=e.nodeType))}function qa(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Ka(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Ja{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,o=e.childCount,i=new Map,s=[];e:for(;o>0;){let a;for(;;)if(r){let e=n.children[r-1];if(!(e instanceof Ia)){a=e,r--;break}n=e,r=e.children.length}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,o=this.stack.length>>1,i=Math.min(o,e.length);for(;r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[o])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=Ia.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,n,r){let o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(let s=this.index,a=Math.min(this.top.children.length,s+5);s<a;s++){let r=this.top.children[s];if(r.matchesNode(e,t,n)&&!this.preMatch.matched.has(r)){i=s;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,r,o){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,r,o,i){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof Ra){let l=this.preMatch.matched.get(a);if(null!=l&&l!=o)return!1;let c,d=a.dom,u=this.isLocked(d)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&qa(t,a.outerDeco));if(!u&&a.update(e,t,n,r))return this.destroyBetween(this.index,s),a.dom!=d&&(this.changed=!0),this.index++,!0;if(!u&&(c=this.recreateWrapper(a,e,t,n,r,i)))return this.destroyBetween(this.index,s),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(r,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,o,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!qa(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let s=Ra.create(this.top,t,n,r,o,i);if(s.contentDOM){s.children=e.children,e.children=[];for(let e of s.children)e.parent=s}return e.destroy(),s}addNode(e,t,n,r,o){let i=Ra.create(this.top,e,t,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){let r=new Aa(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Ia;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof La)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((ea||Qs)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new $a(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function Ya(e,t){return e.type.side-t.type.side}function Ga(e,t,n,r,o){let i=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,d=a+=l.size;c>=n||d<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,r)),o&&(i.push(o),o=void 0),d>n&&i.push(l.slice(n-c,l.size,r)))}return i}function Xa(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a,l,c=r.resolve(s);if(Bs(n)){for(a=s;o&&!o.node;)o=o.parent;let e=o.node;if(o&&e.isAtom&&_i.isSelectable(e)&&o.parent&&(!e.isInline||!function(e,t,n){for(let r=0==t,o=t==zs(e);r||o;){if(e==n)return!0;let t=As(e);if(!(e=e.parentNode))return!1;r=r&&0==t,o=o&&t==zs(e)}}(n.focusNode,n.focusOffset,o.dom))){let e=o.posBefore;l=new _i(s==e?c:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=s,o=s;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),o=Math.max(o,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[a,s]=o==e.state.selection.anchor?[o,t]:[t,o],c=r.resolve(s)}else a=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let d=r.resolve(a);if(!l){l=sl(e,d,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1)}return l}function Qa(e){return e.editable?e.hasFocus():ll(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Za(e,t=!1){let n=e.state.selection;if(ol(e,n),Qa(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Qs){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&Ps(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection();if(!t)return;let n=e.cursorWrapper.dom,r="IMG"==n.nodeName;r?t.collapse(n.parentNode,As(n)+1):t.collapse(n,0);!r&&!e.state.selection.visible&&Js&&Ys<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let r,o,{anchor:i,head:s}=n;!el||n instanceof Ui||(n.$from.parent.inlineContent||(r=tl(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=tl(e,n.to))),e.docView.setSelection(i,s,e,t),el&&(r&&rl(r),o&&rl(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{Qa(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const el=ea||Qs&&Zs<63;function tl(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),o=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(ea&&o&&"false"==o.contentEditable)return nl(o);if(!(o&&"false"!=o.contentEditable||i&&"false"!=i.contentEditable)){if(o)return nl(o);if(i)return nl(i)}}function nl(e){return e.contentEditable="true",ea&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function rl(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function ol(e,t){if(t instanceof _i){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(il(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else il(e)}function il(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function sl(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||Ui.between(t,n,r)}function al(e){return!(e.editable&&!e.hasFocus())&&ll(e)}function ll(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function cl(e,t){let{$anchor:n,$head:r}=e.selection,o=t>0?n.max(r):n.min(r),i=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return i&&$i.findFrom(i,t)}function dl(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function ul(e,t,n){let r=e.state.selection;if(!(r instanceof Ui)){if(r instanceof _i&&r.node.isInline)return dl(e,new Ui(t>0?r.$to:r.$from));{let n=cl(e.state,t);return!!n&&dl(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=r,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=e.state.doc.resolve(n.pos+o.nodeSize*(t<0?-1:1));return dl(e,new Ui(r.$anchor,i))}if(!r.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=cl(e.state,t);return!!(n&&n instanceof _i)&&dl(e,n)}if(!(na&&n.indexOf("m")>-1)){let n,o=r.$head,i=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText)return!1;let s=t<0?o.pos-i.nodeSize:o.pos;return!!(i.isAtom||(n=e.docView.descAt(s))&&!n.contentDOM)&&(_i.isSelectable(i)?dl(e,new _i(t<0?e.state.doc.resolve(o.pos-i.nodeSize):o)):!!ia&&dl(e,new Ui(e.state.doc.resolve(t<0?s:s+i.nodeSize))))}}function hl(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function pl(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function fl(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,s=!1;Gs&&1==n.nodeType&&r<hl(n)&&pl(n.childNodes[r],-1)&&(s=!0);for(;;)if(r>0){if(1!=n.nodeType)break;{let e=n.childNodes[r-1];if(pl(e,-1))o=n,i=--r;else{if(3!=e.nodeType)break;n=e,r=n.nodeValue.length}}}else{if(ml(n))break;{let t=n.previousSibling;for(;t&&pl(t,-1);)o=n.parentNode,i=As(t),t=t.previousSibling;if(t)n=t,r=hl(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}}s?gl(e,n,r):o&&gl(e,o,i)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,s=hl(n);for(;;)if(r<s){if(1!=n.nodeType)break;if(!pl(n.childNodes[r],1))break;o=n,i=++r}else{if(ml(n))break;{let t=n.nextSibling;for(;t&&pl(t,1);)o=t.parentNode,i=As(t)+1,t=t.nextSibling;if(t)n=t,r=0,s=hl(n);else{if(n=n.parentNode,n==e.dom)break;r=s=0}}}o&&gl(e,o,i)}(e)}function ml(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function gl(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!Fs(e);)t=As(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!Fs(e);)t=As(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(Bs(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:o}=e;setTimeout(()=>{e.state==o&&Za(e)},50)}function bl(e,t){let n=e.state.doc.resolve(t);if(!Qs&&!ra&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function xl(e,t,n){let r=e.state.selection;if(r instanceof Ui&&!r.empty||n.indexOf("s")>-1)return!1;if(na&&n.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=cl(e.state,t);if(n&&n instanceof _i)return dl(e,n)}if(!o.parent.inlineContent){let n=t<0?o:i,s=r instanceof Wi?$i.near(n,t):$i.findFrom(n,t);return!!s&&dl(e,s)}return!1}function yl(e,t){if(!(e.state.selection instanceof Ui))return!0;let{$head:n,$anchor:r,empty:o}=e.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=e.state.tr;return t<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),e.dispatch(r),!0}return!1}function vl(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function wl(e,t){let n=t.keyCode,r=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||na&&72==n&&"c"==r)return yl(e,-1)||fl(e,-1);if(46==n&&!t.shiftKey||na&&68==n&&"c"==r)return yl(e,1)||fl(e,1);if(13==n||27==n)return!0;if(37==n||na&&66==n&&"c"==r){let t=37==n?"ltr"==bl(e,e.state.selection.from)?-1:1:-1;return ul(e,t,r)||fl(e,t)}if(39==n||na&&70==n&&"c"==r){let t=39==n?"ltr"==bl(e,e.state.selection.from)?1:-1:1;return ul(e,t,r)||fl(e,t)}return 38==n||na&&80==n&&"c"==r?xl(e,-1,r)||fl(e,-1):40==n||na&&78==n&&"c"==r?function(e){if(!ea||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;vl(e,n,"true"),setTimeout(()=>vl(e,n,"false"),20)}return!1}(e)||xl(e,1,r)||fl(e,1):r==(na?"m":"c")&&(66==n||73==n||89==n||90==n)}function kl(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:o,openEnd:i}=t;for(;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let s=e.someProp("clipboardSerializer")||Bo.fromSchema(e.state.schema),a=Dl(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c,d=l.firstChild,u=0;for(;d&&1==d.nodeType&&(c=Ol[d.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=a.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),u++}d=l.firstChild}return d&&1==d.nodeType&&d.setAttribute("data-pm-slice",`${o} ${i}${u?` -${u}`:""} ${JSON.stringify(n)}`),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function Cl(e,t,n,r,o){let i,s,a=o.parent.type.spec.code;if(!n&&!t)return null;let l=!!t&&(r||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||r,e)}),a)return s=new Hr(zr.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0),e.someProp("transformPasted",t=>{s=t(s,e,!0)}),s;let n=e.someProp("clipboardTextParser",n=>n(t,o,r,e));if(n)s=n;else{let n=o.marks(),{schema:r}=e.state,s=Bo.fromSchema(r);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(s.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),i=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,r=Dl().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&Ol[o[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(r.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;Il||(Il=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return Il.createHTML(e)}(e),n)for(let i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),ia&&function(e){let t=e.querySelectorAll(Qs?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"Â "==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let u=+d[3];u>0;u--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(!s){let t=e.someProp("clipboardParser")||e.someProp("domParser")||Oo.fromSchema(e.state.schema);s=t.parseSlice(i,{preserveWhitespace:!(!l&&!d),context:o,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||Sl.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(d)s=function(e,t){if(!e.size)return e;let n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(a){return e}let{content:o,openStart:i,openEnd:s}=e;for(let l=n.length-2;l>=0;l-=2){let e=r.nodes[n[l]];if(!e||e.hasRequiredAttrs())break;o=zr.from(e.create(n[l+1],o)),i++,s++}return new Hr(o,i,s)}(Tl(s,+d[1],+d[2]),d[4]);else if(s=Hr.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r,o=t.node(n).contentMatchAt(t.index(n)),i=[];if(e.forEach(e=>{if(!i)return;let t,n=o.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&r.length&&jl(n,r,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=El(i[i.length-1],r.length));let t=Nl(e,n);i.push(t),o=o.matchType(t.type),r=n}}),i)return zr.from(i)}return e}(s.content,o),!0),s.openStart||s.openEnd){let e=0,t=0;for(let n=s.content.firstChild;e<s.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=s.content.lastChild;t<s.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);s=Tl(s,e,t)}return e.someProp("transformPasted",t=>{s=t(s,e,l)}),s}const Sl=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Nl(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,zr.from(e));return e}function jl(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){let i=jl(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(zr.from(Nl(n,e,o+1))))}}function El(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,El(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(zr.empty,!0);return e.copy(n.append(r))}function Ml(e,t,n,r,o,i){let s=t<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(i=0),o<r-1&&(a=Ml(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(zr.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function Tl(e,t,n){return t<e.openStart&&(e=new Hr(Ml(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new Hr(Ml(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const Ol={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Al=null;function Dl(){return Al||(Al=document.implementation.createHTMLDocument("title"))}let Il=null;const Rl={},Pl={},Ll={touchstart:!0,touchmove:!0};class $l{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function zl(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function Fl(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>Bl(e,t))})}function Bl(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function Ul(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function Vl(e){return{left:e.clientX,top:e.clientY}}function _l(e,t,n,r,o){if(-1==r)return!1;let i=e.state.doc.resolve(r);for(let s=i.depth+1;s>0;s--)if(e.someProp(t,t=>s>i.depth?t(e,n,i.nodeAfter,i.before(s),o,!0):t(e,n,i.node(s),i.before(s),o,!1)))return!0;return!1}function Hl(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);r.setMeta("pointer",!0),e.dispatch(r)}function Wl(e,t,n,r,o){return _l(e,"handleClickOn",t,n,r)||e.someProp("handleClick",n=>n(e,t,r))||(o?function(e,t){if(-1==t)return!1;let n,r,o=e.state.selection;o instanceof _i&&(n=o.node);let i=e.state.doc.resolve(t);for(let s=i.depth+1;s>0;s--){let e=s>i.depth?i.nodeAfter:i.node(s);if(_i.isSelectable(e)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(Hl(e,_i.create(e.state.doc,r)),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&_i.isSelectable(r))&&(Hl(e,new _i(n)),!0)}(e,n))}function ql(e,t,n,r){return _l(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}function Kl(e,t,n,r){return _l(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(Hl(e,Ui.create(r,0,r.content.size)),!0);let o=r.resolve(t);for(let i=o.depth+1;i>0;i--){let t=i>o.depth?o.nodeAfter:o.node(i),n=o.before(i);if(t.inlineContent)Hl(e,Ui.create(r,n+1,n+1+t.content.size));else{if(!_i.isSelectable(t))continue;Hl(e,_i.create(r,n))}return!0}}(e,n,r)}function Jl(e){return nc(e)}Pl.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!Xl(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!oa||!Qs||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!ta||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||wl(e,n)?n.preventDefault():zl(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,Us(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},Pl.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},Pl.keypress=(e,t)=>{let n=t;if(Xl(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||na&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let r=e.state.selection;if(!(r instanceof Ui&&r.$from.sameParent(r.$to))){let t=String.fromCharCode(n.charCode),o=()=>e.state.tr.insertText(t).scrollIntoView();/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,r.$from.pos,r.$to.pos,t,o))||e.dispatch(o()),n.preventDefault()}};const Yl=na?"metaKey":"ctrlKey";Rl.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let r=Jl(e),o=Date.now(),i="singleClick";o-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(n,e.input.lastClick)&&!n[Yl]&&e.input.lastClick.button==n.button&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i,button:n.button};let s=e.posAtCoords(Vl(n));s&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Gl(e,s,n,!!r)):("doubleClick"==i?ql:Kl)(e,s.pos,s.inside,n)?n.preventDefault():zl(e,"pointer"))};class Gl{constructor(e,t,n,r){let o,i;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[Yl],this.allowDefault=n.shiftKey,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{let n=e.state.doc.resolve(t.pos);o=n.parent,i=n.depth?n.before():0}const s=r?null:n.target,a=s?e.docView.nearestDesc(s,!0):null;this.target=a&&1==a.nodeDOM.nodeType?a.nodeDOM:null;let{selection:l}=e.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof _i&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Gs||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),zl(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Za(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Vl(e))),this.updateAllowDefault(e),this.allowDefault||!t?zl(this.view,"pointer"):Wl(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||ea&&this.mightDrag&&!this.mightDrag.node.isAtom||Qs&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Hl(this.view,$i.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):zl(this.view,"pointer")}move(e){this.updateAllowDefault(e),zl(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function Xl(e,t){return!!e.composing||!!(ea&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}Rl.touchstart=e=>{e.input.lastTouch=Date.now(),Jl(e),zl(e,"pointer")},Rl.touchmove=e=>{e.input.lastTouch=Date.now(),zl(e,"pointer")},Rl.contextmenu=e=>Jl(e);const Ql=oa?5e3:-1;function Zl(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>nc(e),t))}function ec(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function tc(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=zs(e=e.childNodes[t-1])}else{if(!e.parentNode||Fs(e))return null;t=As(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||Fs(e))return null;t=As(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return r}}return n||r}function nc(e,t=!1){if(!(oa&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),ec(e),t||e.docView&&e.docView.dirty){let n=Xa(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):!e.markCursor&&!t||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}Pl.compositionstart=Pl.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof Ui&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),nc(e,!0),e.markCursor=null;else if(nc(e,!t.selection.empty),Gs&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}Zl(e,Ql)},Pl.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,Zl(e,20))};const rc=Js&&Ys<15||ta&&sa<604;function oc(e,t,n,r,o){let i=Cl(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,o,i||Hr.empty)))return!0;if(!i)return!1;let s=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),a=s?e.state.tr.replaceSelectionWith(s,r):e.state.tr.replaceSelection(i);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ic(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Rl.copy=Pl.cut=(e,t)=>{let n=t,r=e.state.selection,o="cut"==n.type;if(r.empty)return;let i=rc?null:n.clipboardData,s=r.content(),{dom:a,text:l}=kl(e,s);i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,a),o&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Pl.paste=(e,t)=>{let n=t;if(e.composing&&!oa)return;let r=rc?null:n.clipboardData,o=e.input.shiftKey&&45!=e.input.lastKeyCode;r&&oc(e,ic(r),r.getData("text/html"),o,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?oc(e,r.value,null,o,t):oc(e,r.textContent,r.innerHTML,o,t)},50)}(e,n)};class sc{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const ac=na?"altKey":"ctrlKey";function lc(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[ac]}Rl.dragstart=(e,t)=>{let n=t,r=e.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o,i=e.state.selection,s=i.empty?null:e.posAtCoords(Vl(n));if(s&&s.pos>=i.from&&s.pos<=(i instanceof _i?i.to-1:i.to));else if(r&&r.mightDrag)o=_i.create(e.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(o=_i.create(e.state.doc,t.posBefore))}let a=(o||e.state.selection).content(),{dom:l,text:c,slice:d}=kl(e,a);(!n.dataTransfer.files.length||!Qs||Zs>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(rc?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",rc||n.dataTransfer.setData("text/plain",c),e.dragging=new sc(d,lc(e,n),o)},Rl.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},Pl.dragover=Pl.dragenter=(e,t)=>t.preventDefault(),Pl.drop=(e,t)=>{let n=t,r=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let o=e.posAtCoords(Vl(n));if(!o)return;let i=e.state.doc.resolve(o.pos),s=r&&r.slice;s?e.someProp("transformPasted",t=>{s=t(s,e,!1)}):s=Cl(e,ic(n.dataTransfer),rc?null:n.dataTransfer.getData("text/html"),!1,i);let a=!(!r||!lc(e,n));if(e.someProp("handleDrop",t=>t(e,n,s||Hr.empty,a)))return void n.preventDefault();if(!s)return;n.preventDefault();let l=s?vi(e.state.doc,i.pos,s):i.pos;null==l&&(l=i.pos);let c=e.state.tr;if(a){let{node:e}=r;e?e.replace(c):c.deleteSelection()}let d=c.mapping.map(l),u=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=c.doc;if(u?c.replaceRangeWith(d,d,s.content.firstChild):c.replaceRange(d,d,s),c.doc.eq(h))return;let p=c.doc.resolve(d);if(u&&_i.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new _i(p));else{let t=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((e,n,r,o)=>t=o),c.setSelection(sl(e,p,c.doc.resolve(t)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))},Rl.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Za(e)},20))},Rl.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},Rl.beforeinput=(e,t)=>{if(Qs&&oa&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,Us(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let os in Pl)Rl[os]=Pl[os];function cc(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class dc{constructor(e,t){this.toDOM=e,this.spec=t||mc,this.side=this.spec.side||0}map(e,t,n,r){let{pos:o,deleted:i}=e.mapResult(t.from+r,this.side<0?-1:1);return i?null:new pc(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof dc&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&cc(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class uc{constructor(e,t){this.attrs=e,this.spec=t||mc}map(e,t,n,r){let o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new pc(o,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof uc&&cc(this.attrs,e.attrs)&&cc(this.spec,e.spec)}static is(e){return e.type instanceof uc}destroy(){}}class hc{constructor(e,t){this.attrs=e,this.spec=t||mc}map(e,t,n,r){let o=e.mapResult(t.from+r,1);if(o.deleted)return null;let i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new pc(o.pos-n,i.pos-n,this)}valid(e,t){let n,{index:r,offset:o}=e.content.findIndex(t.from);return o==t.from&&!(n=e.child(r)).isText&&o+n.nodeSize==t.to}eq(e){return this==e||e instanceof hc&&cc(this.attrs,e.attrs)&&cc(this.spec,e.spec)}destroy(){}}class pc{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new pc(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new pc(e,e,new dc(t,n))}static inline(e,t,n,r){return new pc(e,t,new uc(n,r))}static node(e,t,n,r){return new pc(e,t,new hc(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof uc}get widget(){return this.type instanceof dc}}const fc=[],mc={};class gc{constructor(e,t){this.local=e.length?e:fc,this.children=t.length?t:fc}static create(e,t){return t.length?kc(t,e,0,mc):bc}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,o){for(let i=0;i<this.local.length;i++){let s=this.local[i];s.from<=t&&s.to>=e&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let s=this.children[i]+1;this.children[i+2].findInner(e-s,t-s,n,r+s,o)}}map(e,t,n){return this==bc||0==e.maps.length?this:this.mapInner(e,t,0,0,n||mc)}mapInner(e,t,n,r,o){let i;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(e,n,r);a&&a.type.valid(t,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,o,i,s){let a=e.slice();for(let c=0,d=i;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,r,o)=>{let i=o-r-(n-t);for(let s=0;s<a.length;s+=3){let r=a[s+1];if(r<0||t>r+d-e)continue;let o=a[s]+d-e;n>=o?a[s+1]=t<=o?-2:-1:t>=d&&i&&(a[s]+=i,a[s+1]+=i)}e+=i}),d=n.maps[c].map(d,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let t=n.map(e[c]+i),d=t-o;if(d<0||d>=r.content.size){l=!0;continue}let u=n.map(e[c+1]+i,-1)-o,{index:h,offset:p}=r.content.findIndex(d),f=r.maybeChild(h);if(f&&p==d&&p+f.nodeSize==u){let r=a[c+2].mapInner(n,f,t+1,e[c]+i+1,s);r!=bc?(a[c]=d,a[c+1]=u,a[c+2]=r):(a[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,r,o,i,s){function a(e,t){for(let i=0;i<e.local.length;i++){let a=e.local[i].map(r,o,t);a?n.push(a):s.onRemove&&s.onRemove(e.local[i].spec)}for(let n=0;n<e.children.length;n+=3)a(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+i+1);return n}(a,e,t,n,o,i,s),c=kc(l,r,0,s);t=c.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new gc(t.sort(Cc),a)}(this.children,i||[],e,t,n,r,o):i?new gc(i.sort(Cc),fc):bc}add(e,t){return t.length?this==bc?gc.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,o=0;e.forEach((e,i)=>{let s,a=i+n;if(s=vc(t,e,a)){for(r||(r=this.children.slice());o<r.length&&r[o]<i;)o+=3;r[o]==i?r[o+2]=r[o+2].addInner(e,s,a+1):r.splice(o,0,i,i+e.nodeSize,kc(s,e,a+1,mc)),o+=3}});let i=yc(o?wc(t):t,-n);for(let s=0;s<i.length;s++)i[s].type.valid(e,i[s])||i.splice(s--,1);return new gc(i.length?this.local.concat(i).sort(Cc):this.local,r||this.children)}remove(e){return 0==e.length||this==bc?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let o=0;o<n.length;o+=3){let r,i=n[o]+t,s=n[o+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>i&&t.to<s&&(e[n]=null,(r||(r=[])).push(t));if(!r)continue;n==this.children&&(n=this.children.slice());let a=n[o+2].removeInner(r,i+1);a!=bc?n[o+2]=a:(n.splice(o,3),o-=3)}if(r.length)for(let o,i=0;i<e.length;i++)if(o=e[i])for(let e=0;e<r.length;e++)r[e].eq(o,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1));return n==this.children&&r==this.local?this:r.length||n.length?new gc(r,n):bc}forChild(e,t){if(this==bc)return this;if(t.isLeaf)return gc.empty;let n,r;for(let s=0;s<this.children.length;s+=3)if(this.children[s]>=e){this.children[s]==e&&(n=this.children[s+2]);break}let o=e+1,i=o+t.content.size;for(let s=0;s<this.local.length;s++){let e=this.local[s];if(e.from<i&&e.to>o&&e.type instanceof uc){let t=Math.max(o,e.from)-o,n=Math.min(i,e.to)-o;t<n&&(r||(r=[])).push(e.copy(t,n))}}if(r){let e=new gc(r.sort(Cc),fc);return n?new xc([e,n]):e}return n||bc}eq(e){if(this==e)return!0;if(!(e instanceof gc)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Sc(this.localsInner(e))}localsInner(e){if(this==bc)return fc;if(e.inlineContent||!this.local.some(uc.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof uc||t.push(this.local[n]);return t}forEachSet(e){e(this)}}gc.empty=new gc([],[]),gc.removeOverlap=Sc;const bc=gc.empty;class xc{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,mc));return xc.from(n)}forChild(e,t){if(t.isLeaf)return gc.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(e,t);o!=bc&&(o instanceof xc?n=n.concat(o.members):n.push(o))}return xc.from(n)}eq(e){if(!(e instanceof xc)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<o.length;e++)t.push(o[e])}else t=o}return t?Sc(n?t:t.sort(Cc)):fc}static from(e){switch(e.length){case 0:return bc;case 1:return e[0];default:return new xc(e.every(e=>e instanceof gc)?e:e.reduce((e,t)=>e.concat(t instanceof gc?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function yc(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let o=e[r];n.push(new pc(o.from+t,o.to+t,o.type))}return n}function vc(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,o=null;for(let i,s=0;s<e.length;s++)(i=e[s])&&i.from>n&&i.to<r&&((o||(o=[])).push(i),e[s]=null);return o}function wc(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function kc(e,t,n,r){let o=[],i=!1;t.forEach((t,s)=>{let a=vc(e,t,s+n);if(a){i=!0;let e=kc(a,t,n+s+1,r);e!=bc&&o.push(s,s+t.nodeSize,e)}});let s=yc(i?wc(e):e,-n).sort(Cc);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new gc(s,o):bc}function Cc(e,t){return e.from-t.from||e.to-t.to}function Sc(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let o=n+1;o<t.length;o++){let i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),Nc(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),Nc(t,o+1,i.copy(r.to,i.to)))}}return t}function Nc(e,t,n){for(;t<e.length&&Cc(n,e[t])>0;)t++;e.splice(t,0,n)}function jc(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=bc&&t.push(r)}),e.cursorWrapper&&t.push(gc.create(e.state.doc,[e.cursorWrapper.deco])),xc.from(t)}const Ec={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Mc=Js&&Ys<=11;class Tc{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Oc{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Tc,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);Js&&Ys<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),Mc&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Ec)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(al(this.view)){if(this.suppressingSelectionUpdates)return Za(this.view);if(Js&&Ys<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ps(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let o=e.focusNode;o;o=Ds(o))n.add(o);for(let o=e.anchorNode;o;o=Ds(o))if(n.has(o)){t=o;break}let r=t&&this.view.docView.nearestDesc(t);return r&&r.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&al(e)&&!this.ignoreSelectionChange(n),o=-1,i=-1,s=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],a);e&&(o=o<0?e.from:Math.min(e.from,o),i=i<0?e.to:Math.max(e.to,i),e.typeOver&&(s=!0))}if(Gs&&a.length){let t=a.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of t){let t=r.parentNode;!t||"LI"!=t.nodeName||n&&Rc(e,n)==t||r.remove()}}}let l=null;o<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Bs(n)&&(l=Xa(e))&&l.eq($i.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Za(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||r)&&(o>-1&&(e.docView.markDirty(o,i),function(e){if(Ac.has(e))return;if(Ac.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=Gs,Dc)return;Dc=!0}}(e)),this.handleDOMChange(o,i,s,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||Za(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,o=e.nextSibling;if(Js&&Ys<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:i}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(r=n),(!i||Array.prototype.indexOf.call(e.addedNodes,i)<0)&&(o=i)}let i=r&&r.parentNode==e.target?As(r)+1:0,s=n.localPosFromDOM(e.target,i,-1),a=o&&o.parentNode==e.target?As(o):e.target.childNodes.length;return{from:s,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Ac=new WeakMap,Dc=!1;function Ic(e,t){let n=t.startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return Ps(s.node,s.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function Rc(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function Pc(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(ea&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||ea&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Lc=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function $c(e,t,n,r,o){let i=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=Xa(e,t);if(n&&!e.state.selection.eq(n)){if(Qs&&oa&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,Us(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),i&&r.setMeta("composition",i),e.dispatch(r)}return}let s=e.state.doc.resolve(t),a=s.sharedDepth(n);t=s.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l,c,d=e.state.selection,u=function(e,t,n){let r,{node:o,fromOffset:i,toOffset:s,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),d=c.anchorNode;if(d&&e.dom.contains(1==d.nodeType?d:d.parentNode)&&(r=[{node:d,offset:c.anchorOffset}],Bs(c)||r.push({node:c.focusNode,offset:c.focusOffset})),Qs&&8===e.input.lastKeyCode)for(let g=s;g>i;g--){let e=o.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){s=g;break}if(!t||t.size)break}let u=e.state.doc,h=e.someProp("domParser")||Oo.fromSchema(e.state.schema),p=u.resolve(a),f=null,m=h.parse(o,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:r,ruleFromNode:Pc,context:p});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),f={anchor:e+a,head:t+a}}return{doc:m,sel:f,from:a,to:l}}(e,t,n),h=e.state.doc,p=h.slice(u.from,u.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,n,r,o){let i=e.findDiffStart(t,n);if(null==i)return null;let{a:s,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==o){r-=s+Math.max(0,i-Math.min(s,a))-i}if(s<i&&e.size<t.size){let e=r<=i&&r>=s?i-r:0;i-=e,i&&i<t.size&&Bc(t.textBetween(i-1,i+1))&&(i+=e?1:-1),a=i+(a-s),s=i}else if(a<i){let t=r<=i&&r>=a?i-r:0;i-=t,i&&i<e.size&&Bc(e.textBetween(i-1,i+1))&&(i+=t?1:-1),s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}(p.content,u.doc.content,u.from,l,c);if(f&&e.input.domChangeCount++,(ta&&e.input.lastIOSEnter>Date.now()-225||oa)&&o.some(e=>1==e.nodeType&&!Lc.test(e.nodeName))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",t=>t(e,Us(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!f){if(!(r&&d instanceof Ui&&!d.empty&&d.$head.sameParent(d.$anchor))||e.composing||u.sel&&u.sel.anchor!=u.sel.head){if(u.sel){let t=zc(e,e.state.doc,u.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);i&&n.setMeta("composition",i),e.dispatch(n)}}return}f={start:d.from,endA:d.to,endB:d.to}}e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof Ui&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=u.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=u.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),Js&&Ys<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>u.from&&" Â "==u.doc.textBetween(f.start-u.from-1,f.start-u.from+1)&&(f.start--,f.endA--,f.endB--);let m=u.doc.resolveNoCache(f.start-u.from),g=u.doc.resolveNoCache(f.endB-u.from),b=h.resolve(f.start),x=m.sameParent(g)&&m.parent.inlineContent&&b.end()>=f.endA;if((ta&&e.input.lastIOSEnter>Date.now()-225&&(!x||o.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!x&&m.pos<u.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&m.pos<g.pos&&!/\S/.test(u.doc.textBetween(m.pos,g.pos,"","")))&&e.someProp("handleKeyDown",t=>t(e,Us(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,n,r,o){if(n-t<=o.pos-r.pos||Fc(r,!0,!1)<o.pos)return!1;let i=e.resolve(t);if(!r.parent.isTextblock){let e=i.nodeAfter;return null!=e&&n==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=e.resolve(Fc(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||Fc(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(h,f.start,f.endA,m,g)&&e.someProp("handleKeyDown",t=>t(e,Us(8,"Backspace"))))return void(oa&&Qs&&e.domObserver.suppressSelectionUpdates());Qs&&f.endB==f.start&&(e.input.lastChromeDelete=Date.now()),oa&&!x&&m.start()!=g.start()&&0==g.parentOffset&&m.depth==g.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==f.endA&&(f.endB-=2,g=u.doc.resolveNoCache(f.endB-u.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,Us(13,"Enter"))})},20));let y,v=f.start,w=f.endA,k=t=>{let n=t||e.state.tr.replace(v,w,u.doc.slice(f.start-u.from,f.endB-u.from));if(u.sel){let t=zc(e,n.doc,u.sel);t&&!(Qs&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==v||t.head==n.mapping.map(w)-1)||Js&&t.empty&&t.head==v)&&n.setSelection(t)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(x)if(m.pos==g.pos){Js&&Ys<=11&&0==m.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Za(e),20));let t=k(e.state.tr.delete(v,w)),n=h.resolve(f.start).marksAcross(h.resolve(f.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(f.endA==f.endB&&(y=function(e,t){let n,r,o,i=e.firstChild.marks,s=t.firstChild.marks,a=i,l=s;for(let d=0;d<s.length;d++)a=s[d].removeFromSet(a);for(let d=0;d<i.length;d++)l=i[d].removeFromSet(l);if(1==a.length&&0==l.length)r=a[0],n="add",o=e=>e.mark(r.addToSet(e.marks));else{if(0!=a.length||1!=l.length)return null;r=l[0],n="remove",o=e=>e.mark(r.removeFromSet(e.marks))}let c=[];for(let d=0;d<t.childCount;d++)c.push(o(t.child(d)));if(zr.from(c).eq(e))return{mark:r,type:n}}(m.parent.content.cut(m.parentOffset,g.parentOffset),b.parent.content.cut(b.parentOffset,f.endA-b.start())))){let t=k(e.state.tr);"add"==y.type?t.addMark(v,w,y.mark):t.removeMark(v,w,y.mark),e.dispatch(t)}else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let t=m.parent.textBetween(m.parentOffset,g.parentOffset),n=()=>k(e.state.tr.insertText(t,v,w));e.someProp("handleTextInput",r=>r(e,v,w,t,n))||e.dispatch(n())}else e.dispatch(k());else e.dispatch(k())}function zc(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:sl(e,t.resolve(n.anchor),t.resolve(n.head))}function Fc(e,t,n){let r=e.depth,o=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,o++}return o}function Bc(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class Uc{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new $l,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(qc),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Hc(this),_c(this),this.nodeViews=Wc(this),this.docView=Pa(this.state.doc,Vc(this),jc(this),this.dom,this),this.domObserver=new Oc(this,(e,t,n,r)=>$c(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in Rl){let n=Rl[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!Ul(e,t)||Bl(e,t)||!e.editable&&t.type in Pl||n(e,t)},Ll[t]?{passive:!0}:void 0)}ea&&e.dom.addEventListener("input",()=>null),Fl(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Fl(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(qc),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let r=this.state,o=!1,i=!1;e.storedMarks&&this.composing&&(ec(this),i=!0),this.state=e;let s=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(s||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=Wc(this);(function(e,t){let n=0,r=0;for(let o in e){if(e[o]!=t[o])return!0;n++}for(let o in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,o=!0)}(s||t.handleDOMEvents!=this._props.handleDOMEvents)&&Fl(this),this.editable=Hc(this),_c(this);let a=jc(this),l=Vc(this),c=r.plugins==e.plugins||r.doc.eq(e.doc)?e.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",d=o||!this.docView.matchesNode(e.doc,l,a);!d&&e.selection.eq(r.selection)||(i=!0);let u="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top);for(let i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){let r=e.root.elementFromPoint(i,s);if(!r||r==e.dom||!e.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=o-20){t=r,n=a.top;break}}return{refDOM:t,refTop:n,stack:ua(e.dom)}}(this);if(i){this.domObserver.stop();let t=d&&(Js||Qs)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(r.selection,e.selection);if(d){let n=Qs?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=tc(this)),!o&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=Pa(e.doc,l,a,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return Ps(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?Za(this,t):(ol(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():u&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;ha(n,0==r?0:r-t)}(u)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof _i){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&da(this,t.getBoundingClientRect(),e)}else da(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new sc(e.slice,e.move,r<0?void 0:_i.create(this.state.doc,r))}someProp(e,t){let n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(let i=0;i<this.directPlugins.length;i++){let r=this.directPlugins[i].props[e];if(null!=r&&(n=t?t(r):r))return n}let o=this.state.plugins;if(o)for(let i=0;i<o.length;i++){let r=o[i].props[e];if(null!=r&&(n=t?t(r):r))return n}}hasFocus(){if(Js){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(pa)return e.focus(pa);let t=ua(e);e.focus(null==pa?{get preventScroll(){return pa={preventScroll:!0},!0}}:void 0),pa||(pa=!1,ha(t,0))}(this.dom),Za(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return ba(this,e)}coordsAtPos(e,t=1){return wa(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return Ta(this,t||this.state,e)}pasteHTML(e,t){return oc(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return oc(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return kl(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],jc(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Is=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){Bl(e,t)||!Rl[t.type]||!e.editable&&t.type in Pl||Rl[t.type](e,t)}(this,e)}domSelectionRange(){let e=this.domSelection();return e?ea&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return Ic(e,n)}let n;function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?Ic(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Vc(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[pc.node(0,e.state.doc.content.size,t)]}function _c(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:pc.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Hc(e){return!e.someProp("editable",t=>!1===t(e.state))}function Wc(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function qc(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}Uc.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var Kc={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Jc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Yc="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Gc="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Xc=0;Xc<10;Xc++)Kc[48+Xc]=Kc[96+Xc]=String(Xc);for(Xc=1;Xc<=24;Xc++)Kc[Xc+111]="F"+Xc;for(Xc=65;Xc<=90;Xc++)Kc[Xc]=String.fromCharCode(Xc+32),Jc[Xc]=String.fromCharCode(Xc);for(var Qc in Kc)Jc.hasOwnProperty(Qc)||(Jc[Qc]=Kc[Qc]);const Zc="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),ed="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function td(e){let t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(let a=0;a<i.length-1;a++){let e=i[a];if(/^(cmd|meta|m)$/i.test(e))o=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);Zc?o=!0:n=!0}}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function nd(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function rd(e){let t=function(e){let t=Object.create(null);for(let n in e)t[td(n)]=e[n];return t}(e);return function(e,n){let r,o=function(e){var t=!(Yc&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||Gc&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?Jc:Kc)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=t[nd(o,n)];if(i&&i(e.state,e.dispatch,e))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=t[nd(o,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(ed&&n.ctrlKey&&n.altKey)&&(r=Kc[n.keyCode])&&r!=o){let o=t[nd(r,n)];if(o&&o(e.state,e.dispatch,e))return!0}}return!1}}var od=Object.defineProperty,id=(e,t)=>{for(var n in t)od(e,n,{get:t[n],enumerable:!0})};function sd(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}}}var ad=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{const n=t(...e)(i);return o.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(o),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s=[],a=!!e,l=e||o.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{const r=this.buildProps(l,t),o=n(...e)(r);return s.push(o),c}])),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(l),s.every(e=>!0===e))};return c}createCan(e){const{rawCommands:t,state:n}=this,r=!1,o=e||n.tr,i=this.buildProps(o,r);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,r)}}buildProps(e,t=!0){const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s={tr:e,editor:r,view:i,state:sd({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(s)]))}};return s}},ld={};id(ld,{blur:()=>cd,clearContent:()=>dd,clearNodes:()=>ud,command:()=>hd,createParagraphNear:()=>pd,cut:()=>fd,deleteCurrentNode:()=>md,deleteNode:()=>bd,deleteRange:()=>xd,deleteSelection:()=>yd,enter:()=>vd,exitCode:()=>wd,extendMarkRange:()=>Md,first:()=>Td,focus:()=>Rd,forEach:()=>Pd,insertContent:()=>Ld,insertContentAt:()=>Bd,joinBackward:()=>_d,joinDown:()=>Vd,joinForward:()=>Hd,joinItemBackward:()=>Wd,joinItemForward:()=>qd,joinTextblockBackward:()=>Kd,joinTextblockForward:()=>Jd,joinUp:()=>Ud,keyboardShortcut:()=>Gd,lift:()=>Qd,liftEmptyBlock:()=>Zd,liftListItem:()=>eu,newlineInCode:()=>tu,resetAttributes:()=>ou,scrollIntoView:()=>iu,selectAll:()=>su,selectNodeBackward:()=>au,selectNodeForward:()=>lu,selectParentNode:()=>cu,selectTextblockEnd:()=>du,selectTextblockStart:()=>uu,setContent:()=>pu,setMark:()=>Wu,setMeta:()=>qu,setNode:()=>Ku,setNodeSelection:()=>Ju,setTextSelection:()=>Yu,sinkListItem:()=>Gu,splitBlock:()=>Qu,splitListItem:()=>Zu,toggleList:()=>nh,toggleMark:()=>rh,toggleNode:()=>oh,toggleWrap:()=>ih,undoInputRule:()=>sh,unsetAllMarks:()=>ah,unsetMark:()=>lh,updateAttributes:()=>ch,wrapIn:()=>dh,wrapInList:()=>uh});var cd=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null==(n=null==window?void 0:window.getSelection())||n.removeAllRanges())}),!0),dd=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),ud=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:o}=r;return!n||(o.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;const{doc:r,mapping:o}=t,i=r.resolve(o.map(n)),s=r.resolve(o.map(n+e.nodeSize)),a=i.blockRange(s);if(!a)return;const l=ui(a);if(e.type.isTextblock){const{defaultType:e}=i.parent.contentMatchAt(i.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)})}),!0)},hd=e=>t=>e(t),pd=()=>({state:e,dispatch:t})=>vs(e,t),fd=(e,t)=>({editor:n,tr:r})=>{const{state:o}=n,i=o.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const s=r.mapping.map(t);return r.insert(s,i.content),r.setSelection(new Ui(r.doc.resolve(Math.max(s-1,0)))),!0},md=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1){if(o.node(i).type===r.type){if(t){const t=o.before(i),n=o.after(i);e.delete(t,n).scrollIntoView()}return!0}}return!1};function gd(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var bd=e=>({tr:t,state:n,dispatch:r})=>{const o=gd(e,n.schema),i=t.selection.$anchor;for(let e=i.depth;e>0;e-=1){if(i.node(e).type===o){if(r){const n=i.before(e),r=i.after(e);t.delete(n,r).scrollIntoView()}return!0}}return!1},xd=e=>({tr:t,dispatch:n})=>{const{from:r,to:o}=e;return n&&t.delete(r,o),!0},yd=()=>({state:e,dispatch:t})=>as(e,t),vd=()=>({commands:e})=>e.keyboardShortcut("Enter"),wd=()=>({state:e,dispatch:t})=>((e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),s=ys(o.contentMatchAt(i));if(!s||!o.canReplaceWith(i,i,s))return!1;if(t){let r=n.after(),o=e.tr.replaceWith(r,r,s.createAndFill());o.setSelection($i.near(o.doc.resolve(r),1)),t(o.scrollIntoView())}return!0})(e,t);function kd(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function Cd(e,t,n={strict:!0}){const r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:kd(t[r])?t[r].test(e[r]):t[r]===e[r])}function Sd(e,t,n={}){return e.find(e=>e.type===t&&Cd(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function Nd(e,t,n={}){return!!Sd(e,t,n)}function jd(e,t,n){var r;if(!e||!t)return;let o=e.parent.childAfter(e.parentOffset);if(o.node&&o.node.marks.some(e=>e.type===t)||(o=e.parent.childBefore(e.parentOffset)),!o.node||!o.node.marks.some(e=>e.type===t))return;n=n||(null==(r=o.node.marks[0])?void 0:r.attrs);if(!Sd([...o.node.marks],t,n))return;let i=o.index,s=e.start()+o.offset,a=i+1,l=s+o.node.nodeSize;for(;i>0&&Nd([...e.parent.child(i-1).marks],t,n);)i-=1,s-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&Nd([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function Ed(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var Md=(e,t={})=>({tr:n,state:r,dispatch:o})=>{const i=Ed(e,r.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:d}=a;if(o){const e=jd(l,i,t);if(e&&e.from<=c&&e.to>=d){const t=Ui.create(s,e.from,e.to);n.setSelection(t)}}return!0},Td=e=>t=>{const n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1};function Od(e){return e instanceof Ui}function Ad(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Dd(e,t=null){if(!t)return null;const n=$i.atStart(e),r=$i.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;const o=n.from,i=r.to;return"all"===t?Ui.create(e,Ad(0,o,i),Ad(e.content.size,o,i)):Ui.create(e,Ad(t,o,i),Ad(t,o,i))}function Id(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Rd=(e=null,t={})=>({editor:n,view:r,tr:o,dispatch:i})=>{t={scrollIntoView:!0,...t};const s=()=>{(Id()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(i&&null===e&&!Od(n.state.selection))return s(),!0;const a=Dd(o.doc,e)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},Pd=(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),Ld=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),$d=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&$d(r)}return e};function zd(e){if("undefined"==typeof window)throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${e}</body>`,n=(new window.DOMParser).parseFromString(t,"text/html").body;return $d(n)}function Fd(e,t,n){if(e instanceof lo||e instanceof zr)return e;n={slice:!0,parseOptions:{},...n};const r="string"==typeof e;if("object"==typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return zr.fromArray(e.map(e=>t.nodeFromJSON(e)));const r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return Fd("",t,n)}if(r){if(n.errorOnInvalidContent){let r=!1,o="";const i=new Mo({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,o="string"==typeof e?e:e.outerHTML,null)}]}})});if(n.slice?Oo.fromSchema(i).parseSlice(zd(e),n.parseOptions):Oo.fromSchema(i).parse(zd(e),n.parseOptions),n.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const r=Oo.fromSchema(t);return n.slice?r.parseSlice(zd(e),n.parseOptions).content:r.parse(zd(e),n.parseOptions)}return Fd("",t,n)}var Bd=(e,t,n)=>({tr:r,dispatch:o,editor:i})=>{var s;if(o){let o;const l=e=>{i.emit("contentError",{editor:i,error:e,disableCollaboration:()=>{"collaboration"in i.storage&&"object"==typeof i.storage.collaboration&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...(n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n}).parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{Fd(t,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(a){l(a)}try{o=Fd(t,i.schema,{parseOptions:c,errorOnInvalidContent:null!=(s=n.errorOnInvalidContent)?s:i.options.enableContentCheck})}catch(a){return l(a),!1}let{from:d,to:u}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},h=!0,p=!0;if(("type"in o?[o]:o).forEach(e=>{e.check(),h=!!h&&(e.isText&&0===e.marks.length),p=!!p&&e.isBlock}),d===u&&p){const{parent:e}=r.doc.resolve(d);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(d-=1,u+=1)}let f;if(h){if(Array.isArray(t))f=t.map(e=>e.text||"").join("");else if(t instanceof zr){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),f=e}else f="object"==typeof t&&t&&t.text?t.text:t;r.insertText(f,d,u)}else{f=o;const e=r.doc.resolve(d),t=e.node(),n=0===e.parentOffset,i=t.isText||t.isTextblock,s=t.content.size>0;n&&i&&s&&(d=Math.max(0,d-1)),r.replaceWith(d,u,f)}n.updateSelection&&function(e,t,n){const r=e.steps.length-1;if(r<t)return;const o=e.steps[r];if(!(o instanceof si||o instanceof ai))return;const i=e.mapping.maps[r];let s=0;i.forEach((e,t,n,r)=>{0===s&&(s=r)}),e.setSelection($i.near(e.doc.resolve(s),n))}(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:f}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:f})}return!0},Ud=()=>({state:e,dispatch:t})=>((e,t)=>{let n,r=e.selection,o=r instanceof _i;if(o){if(r.node.isTextblock||!bi(e.doc,r.from))return!1;n=r.from}else if(n=yi(e.doc,r.from,-1),null==n)return!1;if(t){let r=e.tr.join(n);o&&r.setSelection(_i.create(r.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(r.scrollIntoView())}return!0})(e,t),Vd=()=>({state:e,dispatch:t})=>((e,t)=>{let n,r=e.selection;if(r instanceof _i){if(r.node.isTextblock||!bi(e.doc,r.to))return!1;n=r.to}else if(n=yi(e.doc,r.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(e,t),_d=()=>({state:e,dispatch:t})=>cs(e,t),Hd=()=>({state:e,dispatch:t})=>ms(e,t),Wd=()=>({state:e,dispatch:t,tr:n})=>{try{const r=yi(e.doc,e.selection.$from.pos,-1);return null!=r&&(n.join(r,2),t&&t(n),!0)}catch{return!1}},qd=()=>({state:e,dispatch:t,tr:n})=>{try{const r=yi(e.doc,e.selection.$from.pos,1);return null!=r&&(n.join(r,2),t&&t(n),!0)}catch{return!1}},Kd=()=>({state:e,dispatch:t})=>((e,t,n)=>{let r=ls(e,n);if(!r)return!1;let o=ps(r);return!!o&&ds(e,o,t)})(e,t),Jd=()=>({state:e,dispatch:t})=>((e,t,n)=>{let r=fs(e,n);if(!r)return!1;let o=bs(r);return!!o&&ds(e,o,t)})(e,t);function Yd(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}var Gd=e=>({editor:t,view:n,tr:r,dispatch:o})=>{const i=function(e){const t=e.split(/-(?!$)/);let n,r,o,i,s=t[t.length-1];"Space"===s&&(s=" ");for(let a=0;a<t.length-1;a+=1){const e=t[a];if(/^(cmd|meta|m)$/i.test(e))i=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))r=!0;else if(/^s(hift)?$/i.test(e))o=!0;else{if(!/^mod$/i.test(e))throw new Error(`Unrecognized modifier name: ${e}`);Id()||Yd()?i=!0:r=!0}}return n&&(s=`Alt-${s}`),r&&(s=`Ctrl-${s}`),i&&(s=`Meta-${s}`),o&&(s=`Shift-${s}`),s}(e).split(/-(?!$)/),s=i.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{const t=e.map(r.mapping);t&&o&&r.maybeStep(t)}),!0};function Xd(e,t,n={}){const{from:r,to:o,empty:i}=e.selection,s=t?gd(t,e.schema):null,a=[];e.doc.nodesBetween(r,o,(e,t)=>{if(e.isText)return;const n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);a.push({node:e,from:n,to:i})});const l=o-r,c=a.filter(e=>!s||s.name===e.node.type.name).filter(e=>Cd(e.node.attrs,n,{strict:!1}));if(i)return!!c.length;return c.reduce((e,t)=>e+t.to-t.from,0)>=l}var Qd=(e,t={})=>({state:n,dispatch:r})=>!!Xd(n,gd(e,n.schema),t)&&((e,t)=>{let{$from:n,$to:r}=e.selection,o=n.blockRange(r),i=o&&ui(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)})(n,r),Zd=()=>({state:e,dispatch:t})=>ws(e,t),eu=e=>({state:t,dispatch:n})=>Os(gd(e,t.schema))(t,n),tu=()=>({state:e,dispatch:t})=>xs(e,t);function nu(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function ru(e,t){const n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}var ou=(e,t)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=nu("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=gd(e,r.schema)),"mark"===a&&(s=Ed(e,r.schema)),o&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{i&&i===e.type&&n.setNodeMarkup(r,void 0,ru(e.attrs,t)),s&&e.marks.length&&e.marks.forEach(o=>{s===o.type&&n.addMark(r,r+e.nodeSize,s.create(ru(o.attrs,t)))})})}),!0)},iu=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),su=()=>({tr:e,dispatch:t})=>{if(t){const t=new Wi(e.doc);e.setSelection(t)}return!0},au=()=>({state:e,dispatch:t})=>hs(e,t),lu=()=>({state:e,dispatch:t})=>gs(e,t),cu=()=>({state:e,dispatch:t})=>((e,t)=>{let n,{$from:r,to:o}=e.selection,i=r.sharedDepth(o);return 0!=i&&(n=r.before(i),t&&t(e.tr.setSelection(_i.create(e.doc,n))),!0)})(e,t),du=()=>({state:e,dispatch:t})=>js(e,t),uu=()=>({state:e,dispatch:t})=>Ns(e,t);function hu(e,t,n={},r={}){return Fd(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var pu=(e,{errorOnInvalidContent:t,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:o,tr:i,dispatch:s,commands:a})=>{const{doc:l}=i;if("full"!==r.preserveWhitespace){const a=hu(e,o.schema,r,{errorOnInvalidContent:null!=t?t:o.options.enableContentCheck});return s&&i.replaceWith(0,l.content.size,a).setMeta("preventUpdate",!n),!0}return s&&i.setMeta("preventUpdate",!n),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:r,errorOnInvalidContent:null!=t?t:o.options.enableContentCheck})};function fu(e,t){const n=Ed(t,e.schema),{from:r,to:o,empty:i}=e.selection,s=[];i?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,o,e=>{s.push(...e.marks)});const a=s.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function mu(e,t){const n=new Pi(e);return t.forEach(e=>{e.steps.forEach(e=>{n.step(e)})}),n}function gu(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}(t.$from,e)}function bu(e,t,n){if(void 0===e.config[t]&&e.parent)return bu(e.parent,t,n);if("function"==typeof e.config[t]){return e.config[t].bind({...n,parent:e.parent?bu(e.parent,t,n):null})}return e.config[t]}function xu(e){return e.map(e=>{const t=bu(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...xu(t())]:e}).flat(10)}function yu(e,t){const n=Bo.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function vu(e){return"function"==typeof e}function wu(e,t=void 0,...n){return vu(e)?t?e.bind(t)(...n):e(...n):e}function ku(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function Cu(e){const t=[],{nodeExtensions:n,markExtensions:r}=ku(e),o=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{const n=bu(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:o});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...i,...r}})})})})}),o.forEach(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=bu(e,"addAttributes",n);if(!r)return;const o=r();Object.entries(o).forEach(([n,r])=>{const o={...i,...r};"function"==typeof(null==o?void 0:o.default)&&(o.default=o.default()),(null==o?void 0:o.isRequired)&&void 0===(null==o?void 0:o.default)&&delete o.default,t.push({type:e.name,name:n,attribute:o})})}),t}function Su(...e){return e.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([e,t])=>{if(n[e])if("class"===e){const r=t?String(t).split(" "):[],o=n[e]?n[e].split(" "):[],i=r.filter(e=>!o.includes(e));n[e]=[...o,...i].join(" ")}else if("style"===e){const r=t?t.split(";").map(e=>e.trim()).filter(Boolean):[],o=n[e]?n[e].split(";").map(e=>e.trim()).filter(Boolean):[],i=new Map;o.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),r.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),n[e]=Array.from(i.entries()).map(([e,t])=>`${e}: ${t}`).join("; ")}else n[e]=t;else n[e]=t}),n},{})}function Nu(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>Su(e,t),{})}function ju(e,t){return"style"in e?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;const o=t.reduce((e,t)=>{const r=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!=typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null==r?e:{...e,[t.name]:r}},{});return{...r,...o}}}}function Eu(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>("attrs"!==e||!function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function Mu(e){var t,n,r;const o={};return(null==(t=null==e?void 0:e.attribute)?void 0:t.isRequired)||void 0===(null==(n=null==e?void 0:e.attribute)?void 0:n.default)||(o.default=e.attribute.default),void 0!==(null==(r=null==e?void 0:e.attribute)?void 0:r.validate)&&(o.validate=e.attribute.validate),[e.name,o]}function Tu(e){return e.sort((e,t)=>{const n=bu(e,"priority")||100,r=bu(t,"priority")||100;return n>r?-1:n<r?1:0})}function Ou(e){const t=Tu(xu(e));return function(e){const t=e.filter((t,n)=>e.indexOf(t)!==n);return Array.from(new Set(t))}(t.map(e=>e.name)).length,t}function Au(e,t,n){const{from:r,to:o}=t,{blockSeparator:i="\n\n",textSerializers:s={}}=n||{};let a="";return e.nodesBetween(r,o,(e,n,l,c)=>{var d;e.isBlock&&n>r&&(a+=i);const u=null==s?void 0:s[e.type.name];if(u)return l&&(a+=u({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null==(d=null==e?void 0:e.text)?void 0:d.slice(Math.max(r,n)-n,o-n))}),a}function Du(e,t){return Au(e,{from:0,to:e.content.size},t)}function Iu(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function Ru(e,t){const n=nu("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=gd(t,e.schema),{from:r,to:o}=e.selection,i=[];e.doc.nodesBetween(r,o,e=>{i.push(e)});const s=i.reverse().find(e=>e.type.name===n.name);return s?{...s.attrs}:{}}(e,t):"mark"===n?fu(e,t):{}}function Pu(e){const t=function(e,t=JSON.stringify){const n={};return e.filter(e=>{const r=t(e);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(e);return 1===t.length?t:t.filter((e,n)=>{const r=t.filter((e,t)=>t!==n);return!r.some(t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to)})}function Lu(e){const{mapping:t,steps:n}=e,r=[];return t.maps.forEach((e,o)=>{const i=[];if(e.ranges.length)e.forEach((e,t)=>{i.push({from:e,to:t})});else{const{from:e,to:t}=n[o];if(void 0===e||void 0===t)return;i.push({from:e,to:t})}i.forEach(({from:e,to:n})=>{const i=t.slice(o).map(e,-1),s=t.slice(o).map(n),a=t.invert().map(i,-1),l=t.invert().map(s);r.push({oldRange:{from:a,to:l},newRange:{from:i,to:s}})})}),Pu(r)}function $u(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(t=>{const o=jd(n.resolve(e),t.type);o&&r.push({mark:t,...o})}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==(null==e?void 0:e.nodeSize)&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function zu(e,t){return t.nodes[e]||t.marks[e]||null}function Fu(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{const r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function Bu(e,t,n={}){const{empty:r,ranges:o}=e.selection,i=t?Ed(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!i||i.name===e.type.name).find(e=>Cd(e.attrs,n,{strict:!1}));let s=0;const a=[];if(o.forEach(({$from:t,$to:n})=>{const r=t.pos,o=n.pos;e.doc.nodesBetween(r,o,(e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);s+=i-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:i})))})}),0===s)return!1;const l=a.filter(e=>!i||i.name===e.mark.type.name).filter(e=>Cd(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!i||e.mark.type!==i&&e.mark.type.excludes(i)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=s}function Uu(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}function Vu(e,t){const{nodeExtensions:n}=ku(t),r=n.find(t=>t.name===e);if(!r)return!1;const o=wu(bu(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"==typeof o&&o.split(" ").includes("list")}function _u(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!=(r=e.text)?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(_u(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function Hu(e,t,n){const r=e.state.doc.content.size,o=Ad(t,0,r),i=Ad(n,0,r),s=e.coordsAtPos(o),a=e.coordsAtPos(i,-1),l=Math.min(s.top,a.top),c=Math.max(s.bottom,a.bottom),d=Math.min(s.left,a.left),u=Math.max(s.right,a.right),h={top:l,bottom:c,left:d,right:u,width:u-d,height:c-l,x:d,y:l};return{...h,toJSON:()=>h}}var Wu=(e,t={})=>({tr:n,state:r,dispatch:o})=>{const{selection:i}=n,{empty:s,ranges:a}=i,l=Ed(e,r.schema);if(o)if(s){const e=fu(r,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach(e=>{const o=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(o,i,(e,r)=>{const s=Math.max(r,o),a=Math.min(r+e.nodeSize,i);e.marks.find(e=>e.type===l)?e.marks.forEach(e=>{l===e.type&&n.addMark(s,a,l.create({...e.attrs,...t}))}):n.addMark(s,a,l.create(t))})});return function(e,t,n){var r;const{selection:o}=t;let i=null;if(Od(o)&&(i=o.$cursor),i){const t=null!=(r=e.storedMarks)?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(t)||!t.some(e=>e.type.excludes(n)))}const{ranges:s}=o;return s.some(({$from:t,$to:r})=>{let o=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(o)return!1;if(e.isInline){const t=!r||r.type.allowsMarkType(n),i=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));o=t&&i}return!o}),o})}(r,n,l)},qu=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),Ku=(e,t={})=>({state:n,dispatch:r,chain:o})=>{const i=gd(e,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),!!i.isTextblock&&o().command(({commands:e})=>!!Es(i,{...s,...t})(n)||e.clearNodes()).command(({state:e})=>Es(i,{...s,...t})(e,r)).run()},Ju=e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,r=Ad(e,0,n.content.size),o=_i.create(n,r);t.setSelection(o)}return!0},Yu=e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,{from:r,to:o}="number"==typeof e?{from:e,to:e}:e,i=Ui.atStart(n).from,s=Ui.atEnd(n).to,a=Ad(r,i,s),l=Ad(o,i,s),c=Ui.create(n,a,l);t.setSelection(c)}return!0},Gu=e=>({state:t,dispatch:n})=>{const r=gd(e,t.schema);return(o=r,function(e,t){let{$from:n,$to:r}=e.selection,i=n.blockRange(r,e=>e.childCount>0&&e.firstChild.type==o);if(!i)return!1;let s=i.startIndex;if(0==s)return!1;let a=i.parent,l=a.child(s-1);if(l.type!=o)return!1;if(t){let n=l.lastChild&&l.lastChild.type==a.type,r=zr.from(n?o.create():null),s=new Hr(zr.from(o.create(null,zr.from(a.type.create(null,r)))),n?3:1,0),c=i.start,d=i.end;t(e.tr.step(new ai(c-(n?3:1),d,c,d,s,1,!0)).scrollIntoView())}return!0})(t,n);var o};function Xu(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}var Qu=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:o})=>{const{selection:i,doc:s}=t,{$from:a,$to:l}=i,c=Fu(o.extensionManager.attributes,a.node().type.name,a.node().attrs);if(i instanceof _i&&i.node.isBlock)return!(!a.parentOffset||!gi(s,a.pos))&&(r&&(e&&Xu(n,o.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,u=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&u?[{type:u,attrs:c}]:void 0,p=gi(t.doc,t.mapping.map(a.pos),1,h);if(h||p||!gi(t.doc,t.mapping.map(a.pos),1,u?[{type:u}]:void 0)||(p=!0,h=u?[{type:u,attrs:c}]:void 0),r){if(p&&(i instanceof Ui&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,h),u&&!d&&!a.parentOffset&&a.parent.type!==u)){const e=t.mapping.map(a.before()),n=t.doc.resolve(e);a.node(-1).canReplaceWith(n.index(),n.index()+1,u)&&t.setNodeMarkup(t.mapping.map(a.before()),u)}e&&Xu(n,o.extensionManager.splittableMarks),t.scrollIntoView()}return p},Zu=(e,t={})=>({tr:n,state:r,dispatch:o,editor:i})=>{var s;const a=gd(e,r.schema),{$from:l,$to:c}=r.selection,d=r.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;const u=l.node(-1);if(u.type!==a)return!1;const h=i.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(o){let e=zr.empty;const r=l.index(-1)?1:l.index(-2)?2:3;for(let t=l.depth-r;t>=l.depth-3;t-=1)e=zr.from(l.node(t).copy(e));const o=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,i={...Fu(h,l.node().type.name,l.node().attrs),...t},c=(null==(s=a.contentMatch.defaultType)?void 0:s.createAndFill(i))||void 0;e=e.append(zr.from(a.createAndFill(null,c)||void 0));const d=l.before(l.depth-(r-1));n.replace(d,l.after(-o),new Hr(e,4-r,0));let u=-1;n.doc.nodesBetween(d,n.doc.content.size,(e,t)=>{if(u>-1)return!1;e.isTextblock&&0===e.content.size&&(u=t+1)}),u>-1&&n.setSelection(Ui.near(n.doc.resolve(u))),n.scrollIntoView()}return!0}const p=c.pos===l.end()?u.contentMatchAt(0).defaultType:null,f={...Fu(h,u.type.name,u.attrs),...t},m={...Fu(h,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,c.pos);const g=p?[{type:a,attrs:f},{type:p,attrs:m}]:[{type:a,attrs:f}];if(!gi(n.doc,l.pos,2))return!1;if(o){const{selection:e,storedMarks:t}=r,{splittableMarks:s}=i.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(n.split(l.pos,2,g).scrollIntoView(),!a||!o)return!0;const c=a.filter(e=>s.includes(e.type.name));n.ensureMarks(c)}return!0},eh=(e,t)=>{const n=gu(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const o=e.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!bi(e.doc,n.pos)||(e.join(n.pos),!0)},th=(e,t)=>{const n=gu(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const o=e.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!bi(e.doc,r)||(e.join(r),!0)},nh=(e,t,n,r={})=>({editor:o,tr:i,state:s,dispatch:a,chain:l,commands:c,can:d})=>{const{extensions:u,splittableMarks:h}=o.extensionManager,p=gd(e,s.schema),f=gd(t,s.schema),{selection:m,storedMarks:g}=s,{$from:b,$to:x}=m,y=b.blockRange(x),v=g||m.$to.parentOffset&&m.$from.marks();if(!y)return!1;const w=gu(e=>Vu(e.type.name,u))(m);if(y.depth>=1&&w&&y.depth-w.depth<=1){if(w.node.type===p)return c.liftListItem(f);if(Vu(w.node.type.name,u)&&p.validContent(w.node.content)&&a)return l().command(()=>(i.setNodeMarkup(w.pos,p),!0)).command(()=>eh(i,p)).command(()=>th(i,p)).run()}return n&&v&&a?l().command(()=>{const e=d().wrapInList(p,r),t=v.filter(e=>h.includes(e.type.name));return i.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(p,r).command(()=>eh(i,p)).command(()=>th(i,p)).run():l().command(()=>!!d().wrapInList(p,r)||c.clearNodes()).wrapInList(p,r).command(()=>eh(i,p)).command(()=>th(i,p)).run()},rh=(e,t={},n={})=>({state:r,commands:o})=>{const{extendEmptyMarkRange:i=!1}=n,s=Ed(e,r.schema);return Bu(r,s,t)?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,t)},oh=(e,t,n={})=>({state:r,commands:o})=>{const i=gd(e,r.schema),s=gd(t,r.schema),a=Xd(r,i,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?o.setNode(s,l):o.setNode(i,{...l,...n})},ih=(e,t={})=>({state:n,commands:r})=>{const o=gd(e,n.schema);return Xd(n,o,t)?r.lift(o):r.wrapIn(o,t)},sh=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const o=n[r];let i;if(o.spec.isInputRules&&(i=o.getState(e))){if(t){const t=e.tr,n=i.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(i.text){const n=t.doc.resolve(i.from).marks();t.replaceWith(i.from,i.to,e.schema.text(i.text,n))}else t.delete(i.from,i.to)}return!0}}return!1},ah=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:o}=n;return r||t&&o.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0},lh=(e,t={})=>({tr:n,state:r,dispatch:o})=>{var i;const{extendEmptyMarkRange:s=!1}=t,{selection:a}=n,l=Ed(e,r.schema),{$from:c,empty:d,ranges:u}=a;if(!o)return!0;if(d&&s){let{from:e,to:t}=a;const r=null==(i=c.marks().find(e=>e.type===l))?void 0:i.attrs,o=jd(c,l,r);o&&(e=o.from,t=o.to),n.removeMark(e,t,l)}else u.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},ch=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=nu("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=gd(e,r.schema)),"mark"===a&&(s=Ed(e,r.schema)),o&&n.selection.ranges.forEach(e=>{const o=e.$from.pos,a=e.$to.pos;let l,c,d,u;n.selection.empty?r.doc.nodesBetween(o,a,(e,t)=>{i&&i===e.type&&(d=Math.max(t,o),u=Math.min(t+e.nodeSize,a),l=t,c=e)}):r.doc.nodesBetween(o,a,(e,r)=>{r<o&&i&&i===e.type&&(d=Math.max(r,o),u=Math.min(r+e.nodeSize,a),l=r,c=e),r>=o&&r<=a&&(i&&i===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),s&&e.marks.length&&e.marks.forEach(i=>{if(s===i.type){const l=Math.max(r,o),c=Math.min(r+e.nodeSize,a);n.addMark(l,c,s.create({...i.attrs,...t}))}}))}),c&&(void 0!==l&&n.setNodeMarkup(l,void 0,{...c.attrs,...t}),s&&c.marks.length&&c.marks.forEach(e=>{s===e.type&&n.addMark(d,u,s.create({...e.attrs,...t}))}))}),!0)},dh=(e,t={})=>({state:n,dispatch:r})=>function(e,t=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i),a=s&&hi(s,e,t);return!!a&&(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0)}}(gd(e,n.schema),t)(n,r),uh=(e,t={})=>({state:n,dispatch:r})=>Ts(gd(e,n.schema),t)(n,r),hh=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){const n=(...r)=>{this.off(e,n),t.apply(this,r)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}},ph=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=null==(t=e.undoable)||t}};function fh(e){var t;const{editor:n,from:r,to:o,text:i,rules:s,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(t=c.nodeBefore||c.nodeAfter)?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let d=!1;const u=((e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,o,i)=>{var s,a;const l=(null==(a=(s=e.type.spec).toText)?void 0:a.call(s,{node:e,pos:t,parent:o,index:i}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,r-t))}),n})(c)+i;return s.forEach(e=>{if(d)return;const t=((e,t)=>{if(kd(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith),r.push(n.replaceWith)),r})(u,e.find);if(!t)return;const s=l.state.tr,c=sd({state:l.state,transaction:s}),h={from:r-(t[0].length-i.length),to:o},{commands:p,chain:f,can:m}=new ad({editor:n,state:c});null!==e.handler({state:c,range:h,match:t,commands:p,chain:f,can:m})&&s.steps.length&&(e.undoable&&s.setMeta(a,{transform:s,from:r,to:o,text:i}),l.dispatch(s),d=!0)}),d}function mh(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function gh(e,t){const n={...e};return mh(e)&&mh(t)&&Object.keys(t).forEach(r=>{mh(t[r])&&mh(e[r])?n[r]=gh(e[r],t[r]):n[r]=t[r]}),n}var bh=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...wu(bu(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...wu(bu(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){const t=this.extend({...this.config,addOptions:()=>gh(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},xh=class e extends bh{constructor(){super(...arguments),this.type="mark"}static create(t={}){const n="function"==typeof t?t():t;return new e(n)}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;const i=o.find(e=>(null==e?void 0:e.type.name)===t.name);return i&&n.removeStoredMark(i),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){const t="function"==typeof e?e():e;return super.extend(t)}};var yh=class{constructor(e){this.find=e.find,this.handler=e.handler}};function vh(e){const{editor:t,state:n,from:r,to:o,rule:i,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:d}=new ad({editor:t,state:n}),u=[];n.doc.nodesBetween(r,o,(e,t)=>{var h,p,f,m,g;if((null==(p=null==(h=e.type)?void 0:h.spec)?void 0:p.code)||!(e.isText||e.isTextblock||e.isInline))return;const b=null!=(g=null!=(m=null==(f=e.content)?void 0:f.size)?m:e.nodeSize)?g:0,x=Math.max(r,t),y=Math.min(o,t+b);if(x>=y)return;((e,t,n)=>{if(kd(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith),n.push(t.replaceWith)),n}):[]})(e.isText?e.text||"":e.textBetween(x-t,y-t,void 0,"ï¿¼"),i.find,s).forEach(e=>{if(void 0===e.index)return;const t=x+e.index+1,r=t+e[0].length,o={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},h=i.handler({state:n,range:o,match:e,commands:l,chain:c,can:d,pasteEvent:s,dropEvent:a});u.push(h)})});return u.every(e=>null!==e)}var wh=null;function kh(e){const{editor:t,rules:n}=e;let r,o=null,i=!1,s=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}const l=({state:e,from:n,to:o,rule:i,pasteEvt:s})=>{const l=e.tr,c=sd({state:e,transaction:l});if(vh({editor:t,state:c,from:Math.max(n-1,0),to:o.b-1,rule:i,pasteEvent:s,dropEvent:r})&&l.steps.length){try{r="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{r=null}return a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,l}};return n.map(e=>new ns({view(e){const n=n=>{var r;o=(null==(r=e.dom.parentElement)?void 0:r.contains(n.target))?e.dom.parentElement:null,o&&(wh=t)},r=()=>{wh&&(wh=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(s=o===e.dom.parentElement,r=t,!s){const e=wh;(null==e?void 0:e.isEditable)&&setTimeout(()=>{const t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;const r=null==(n=t.clipboardData)?void 0:n.getData("text/html");return a=t,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{const o=t[0],c="paste"===o.getMeta("uiEvent")&&!i,d="drop"===o.getMeta("uiEvent")&&!s,u=o.getMeta("applyPasteRules"),h=!!u;if(!c&&!d&&!h)return;if(h){let{text:t}=u;"string"==typeof t||(t=yu(zr.from(t),r.schema));const{from:n}=u,o=n+t.length,i=(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(t=n.clipboardData)||t.setData("text/html",e),n})(t);return l({rule:e,state:r,from:n,to:{b:o},pasteEvt:i})}const p=n.doc.content.findDiffStart(r.doc.content),f=n.doc.content.findDiffEnd(r.doc.content);return"number"==typeof p&&f&&p!==f.b?l({rule:e,state:r,from:p,to:f,pasteEvt:a}):void 0}}))}var Ch=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=Ou(e),this.schema=function(e,t){var n;const r=Cu(e),{nodeExtensions:o,markExtensions:i}=ku(e),s=null==(n=o.find(e=>bu(e,"topNode")))?void 0:n.name,a=Object.fromEntries(o.map(n=>{const o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=Eu({...e.reduce((e,t)=>{const r=bu(t,"extendNodeSchema",i);return{...e,...r?r(n):{}}},{}),content:wu(bu(n,"content",i)),marks:wu(bu(n,"marks",i)),group:wu(bu(n,"group",i)),inline:wu(bu(n,"inline",i)),atom:wu(bu(n,"atom",i)),selectable:wu(bu(n,"selectable",i)),draggable:wu(bu(n,"draggable",i)),code:wu(bu(n,"code",i)),whitespace:wu(bu(n,"whitespace",i)),linebreakReplacement:wu(bu(n,"linebreakReplacement",i)),defining:wu(bu(n,"defining",i)),isolating:wu(bu(n,"isolating",i)),attrs:Object.fromEntries(o.map(Mu))}),a=wu(bu(n,"parseHTML",i));a&&(s.parseDOM=a.map(e=>ju(e,o)));const l=bu(n,"renderHTML",i);l&&(s.toDOM=e=>l({node:e,HTMLAttributes:Nu(e,o)}));const c=bu(n,"renderText",i);return c&&(s.toText=c),[n.name,s]})),l=Object.fromEntries(i.map(n=>{const o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=Eu({...e.reduce((e,t)=>{const r=bu(t,"extendMarkSchema",i);return{...e,...r?r(n):{}}},{}),inclusive:wu(bu(n,"inclusive",i)),excludes:wu(bu(n,"excludes",i)),group:wu(bu(n,"group",i)),spanning:wu(bu(n,"spanning",i)),code:wu(bu(n,"code",i)),attrs:Object.fromEntries(o.map(Mu))}),a=wu(bu(n,"parseHTML",i));a&&(s.parseDOM=a.map(e=>ju(e,o)));const l=bu(n,"renderHTML",i);return l&&(s.toDOM=e=>l({mark:e,HTMLAttributes:Nu(e,o)})),[n.name,s]}));return new Mo({topNode:s,nodes:a,marks:l})}(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const n=bu(t,"addCommands",{name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:zu(t.name,this.schema)});return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this;return Tu([...this.extensions].reverse()).flatMap(t=>{const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:zu(t.name,this.schema)},r=[],o=bu(t,"addKeyboardShortcuts",n);let i={};if("mark"===t.type&&bu(t,"exitable",n)&&(i.ArrowRight=()=>xh.handleExit({editor:e,mark:t})),o){const t=Object.fromEntries(Object.entries(o()).map(([t,n])=>[t,()=>n({editor:e})]));i={...i,...t}}const s=new ns({props:{handleKeyDown:rd(i)}});r.push(s);const a=bu(t,"addInputRules",n);if(Uu(t,e.options.enableInputRules)&&a){const t=a();if(t&&t.length){const n=function(e){const{editor:t,rules:n}=e,r=new ns({state:{init:()=>null,apply(e,o,i){const s=e.getMeta(r);if(s)return s;const a=e.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:e}=a;"string"==typeof e||(e=yu(zr.from(e),i.schema));const{from:o}=a,s=o+e.length;fh({editor:t,from:o,to:s,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:o}},props:{handleTextInput:(e,o,i,s)=>fh({editor:t,from:o,to:i,text:s,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{const{$cursor:o}=e.state.selection;o&&fh({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,o){if("Enter"!==o.key)return!1;const{$cursor:i}=e.state.selection;return!!i&&fh({editor:t,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:t}),o=Array.isArray(n)?n:[n];r.push(...o)}}const l=bu(t,"addPasteRules",n);if(Uu(t,e.options.enablePasteRules)&&l){const t=l();if(t&&t.length){const n=kh({editor:e,rules:t});r.push(...n)}}const c=bu(t,"addProseMirrorPlugins",n);if(c){const e=c();r.push(...e)}return r})}get attributes(){return Cu(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=ku(this.extensions);return Object.fromEntries(t.filter(e=>!!bu(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:gd(t.name,this.schema)},o=bu(t,"addNodeView",r);if(!o)return[];const i=o();if(!i)return[];return[t.name,(r,o,s,a,l)=>{const c=Nu(r,n);return i({node:r,view:o,getPos:s,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]}))}get markViews(){const{editor:e}=this,{markExtensions:t}=ku(this.extensions);return Object.fromEntries(t.filter(e=>!!bu(e,"addMarkView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:Ed(t.name,this.schema)},o=bu(t,"addMarkView",r);if(!o)return[];return[t.name,(r,i,s)=>{const a=Nu(r,n);return o()({mark:r,view:i,inline:s,editor:e,extension:t,HTMLAttributes:a,updateAttributes:t=>{!function(e,t,n={}){const{state:r}=t,{doc:o,tr:i}=r,s=e;o.descendants((t,r)=>{const o=i.mapping.map(r),a=i.mapping.map(r)+t.nodeSize;let l=null;if(t.marks.forEach(e=>{if(e!==s)return!1;l=e}),!l)return;let c=!1;if(Object.keys(n).forEach(e=>{n[e]!==l.attrs[e]&&(c=!0)}),c){const t=e.type.create({...e.attrs,...n});i.removeMark(o,a,e.type),i.addMark(o,a,t)}}),i.docChanged&&t.view.dispatch(i)}(r,e,t)}})}]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(e=>[e.name,e.storage])),e.forEach(e=>{var t;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:zu(e.name,this.schema)};if("mark"===e.type){(null==(t=wu(bu(e,"keepOnSplit",n)))||t)&&this.splittableMarks.push(e.name)}const r=bu(e,"onBeforeCreate",n),o=bu(e,"onCreate",n),i=bu(e,"onUpdate",n),s=bu(e,"onSelectionUpdate",n),a=bu(e,"onTransaction",n),l=bu(e,"onFocus",n),c=bu(e,"onBlur",n),d=bu(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),s&&this.editor.on("selectionUpdate",s),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}};Ch.resolve=Ou,Ch.sort=Tu,Ch.flatten=xu;id({},{ClipboardTextSerializer:()=>Nh,Commands:()=>jh,Delete:()=>Eh,Drop:()=>Mh,Editable:()=>Th,FocusEvents:()=>Ah,Keymap:()=>Dh,Paste:()=>Ih,Tabindex:()=>Rh,focusEventsPluginKey:()=>Oh});var Sh=class e extends bh{constructor(){super(...arguments),this.type="extension"}static create(t={}){const n="function"==typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"==typeof e?e():e;return super.extend(t)}},Nh=Sh.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new ns({key:new ss("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:o}=t,{ranges:i}=o,s=Math.min(...i.map(e=>e.$from.pos)),a=Math.max(...i.map(e=>e.$to.pos)),l=Iu(n);return Au(r,{from:s,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),jh=Sh.create({name:"commands",addCommands:()=>({...ld})}),Eh=Sh.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var n,r,o;const i=()=>{var n,r,o,i;if(null!=(i=null==(o=null==(r=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:r.filterTransaction)?void 0:o.call(r,e))?i:e.getMeta("y-sync$"))return;const s=mu(e.before,[e,...t]);Lu(s).forEach(t=>{s.mapping.mapResult(t.oldRange.from).deletedAfter&&s.mapping.mapResult(t.oldRange.to).deletedBefore&&s.before.nodesBetween(t.oldRange.from,t.oldRange.to,(n,r)=>{const o=r+n.nodeSize-2,i=t.oldRange.from<=r&&o<=t.oldRange.to;this.editor.emit("delete",{type:"node",node:n,from:r,to:o,newFrom:s.mapping.map(r),newTo:s.mapping.map(o),deletedRange:t.oldRange,newRange:t.newRange,partial:!i,editor:this.editor,transaction:e,combinedTransform:s})})});const a=s.mapping;s.steps.forEach((t,n)=>{var r,o;if(t instanceof ri){const i=a.slice(n).map(t.from,-1),l=a.slice(n).map(t.to),c=a.invert().map(i,-1),d=a.invert().map(l),u=null==(r=s.doc.nodeAt(i-1))?void 0:r.marks.some(e=>e.eq(t.mark)),h=null==(o=s.doc.nodeAt(l))?void 0:o.marks.some(e=>e.eq(t.mark));this.editor.emit("delete",{type:"mark",mark:t.mark,from:t.from,to:t.to,deletedRange:{from:c,to:d},newRange:{from:i,to:l},partial:Boolean(h||u),editor:this.editor,transaction:e,combinedTransform:s})}})};null==(o=null==(r=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:r.async)||o?setTimeout(i,0):i()}}),Mh=Sh.create({name:"drop",addProseMirrorPlugins(){return[new ns({key:new ss("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),Th=Sh.create({name:"editable",addProseMirrorPlugins(){return[new ns({key:new ss("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Oh=new ss("focusEvents"),Ah=Sh.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new ns({key:Oh,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Dh=Sh.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{const{selection:n,doc:r}=t,{empty:o,$anchor:i}=n,{pos:s,parent:a}=i,l=i.parent.isTextblock&&s>0?t.doc.resolve(s-1):i,c=l.parent.type.spec.isolating,d=i.pos-i.parentOffset,u=c&&1===l.parent.childCount?d===i.pos:$i.atStart(r).from===s;return!(!o||!a.type.isTextblock||a.textContent.length||!u||u&&"paragraph"===i.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},o={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Id()||Yd()?o:r},addProseMirrorPlugins(){return[new ns({key:new ss("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;const r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),o=e.some(e=>e.getMeta("preventClearDocument"));if(!r||o)return;const{empty:i,from:s,to:a}=t.selection,l=$i.atStart(t.doc).from,c=$i.atEnd(t.doc).to;if(i||!(s===l&&a===c))return;if(!_u(n.doc))return;const d=n.tr,u=sd({state:n,transaction:d}),{commands:h}=new ad({editor:this.editor,state:u});return h.clearNodes(),d.steps.length?d:void 0}})]}}),Ih=Sh.create({name:"paste",addProseMirrorPlugins(){return[new ns({key:new ss("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),Rh=Sh.create({name:"tabindex",addProseMirrorPlugins(){return[new ns({key:new ss("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Ph=class e{constructor(e,t,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!=(e=this.actualDepth)?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return;t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new e(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new e(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new e(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const o=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,s=this.pos+r+(i?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!o&&a.depth<=this.depth)return;const l=new e(a,this.editor,o,o?n:null);o&&(l.actualDepth=this.depth+1),t.push(new e(a,this.editor,o,o?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(t).length>0){const e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];if(e[o]!==t[o])break}}else n=r;r=r.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let r=[];if(!this.children||0===this.children.length)return r;const o=Object.keys(t);return this.children.forEach(i=>{if(!(n&&r.length>0)){if(i.node.type.name===e){o.every(e=>t[e]===i.node.attrs[e])&&r.push(i)}n&&r.length>0||(r=r.concat(i.querySelectorAll(e,t,n)))}}),r}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}};var Lh=class extends hh{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:"undefined"!=typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:e,slice:t,moved:n})=>this.options.onDrop(e,t,n)),this.on("paste",({event:e,slice:t})=>this.options.onPaste(e,t)),this.on("delete",this.options.onDelete);const t=this.createDoc(),n=Dd(t,this.options.autofocus);this.editorState=es.create({doc:t,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if("undefined"==typeof document)throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(!1!==this.options.autofocus&&null!==this.options.autofocus&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;(null==e?void 0:e.editor)&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{"function"==typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&"undefined"!=typeof document&&(this.css=function(e,t){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style",""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}',this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if("state"===t)return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const n=vu(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(e=>{const t="string"==typeof e?`${e}$`:e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[Th,Nh.configure({blockSeparator:null==(t=null==(e=this.options.coreExtensionOptions)?void 0:e.clipboardTextSerializer)?void 0:t.blockSeparator}),jh,Ah,Dh,Rh,Mh,Ih,Eh].filter(e=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new Ch(n,this)}createCommandManager(){this.commandManager=new ad({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=hu(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message)))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&"object"==typeof this.storage.collaboration&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),e=hu(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new Uc(e,{...this.options.editorProps,attributes:{role:"textbox",...null==(t=this.options.editorProps)?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null==(t=this.capturedTransaction)?void 0:t.step(e)}):void(this.capturedTransaction=e);const{state:t,transactions:n}=this.state.applyTransaction(e),r=!this.state.selection.eq(t.selection),o=n.includes(e),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!o)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=n.findLast(e=>e.getMeta("focus")||e.getMeta("blur")),a=null==s?void 0:s.getMeta("focus"),l=null==s?void 0:s.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),e.getMeta("preventUpdate")||!n.some(e=>e.docChanged)||i.doc.eq(t.doc)||this.emit("update",{editor:this,transaction:e,appendedTransactions:n.slice(1)})}getAttributes(e){return Ru(this.state,e)}isActive(e,t){const n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return Xd(e,null,n)||Bu(e,null,n);const r=nu(t,e.schema);return"node"===r?Xd(e,t,n):"mark"===r&&Bu(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return yu(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return Du(this.state.doc,{blockSeparator:t,textSerializers:{...Iu(this.schema),...n}})}get isEmpty(){return _u(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return null==(t=null==(e=this.editorView)?void 0:e.isDestroyed)||t}$node(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Ph(t,this)}get $doc(){return this.$pos(0)}};function $h(e){return new ph({find:e.find,handler:({state:t,range:n,match:r})=>{const o=wu(e.getAttributes,void 0,r);if(!1===o||null===o)return null;const{tr:i}=t,s=r[r.length-1],a=r[0];if(s){const r=a.search(/\S/),l=n.from+a.indexOf(s),c=l+s.length;if($u(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>l).length)return null;c<n.to&&i.delete(c,n.to),l>n.from&&i.delete(n.from+r,l);const d=n.from+r+s.length;i.addMark(n.from+r,d,e.type.create(o||{})),i.removeStoredMark(e.type)}},undoable:e.undoable})}function zh(e){if(!(null==e?void 0:e.trim()))return{};const t={},n=[],r=e.replace(/["']([^"']*)["']/g,e=>(n.push(e),`__QUOTED_${n.length-1}__`)),o=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){const e=o.map(e=>e.trim().slice(1));t.class=e.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(t.id=i[1]);Array.from(r.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(([,e,r])=>{var o;const i=parseInt((null==(o=r.match(/__QUOTED_(\d+)__/))?void 0:o[1])||"0",10),s=n[i];s&&(t[e]=s.slice(1,-1))});const s=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();if(s){s.split(/\s+/).filter(Boolean).forEach(e=>{e.match(/^[a-zA-Z][\w-]*$/)&&(t[e]=!0)})}return t}function Fh(e){if(!e||0===Object.keys(e).length)return"";const t=[];if(e.class){String(e.class).split(/\s+/).filter(Boolean).forEach(e=>t.push(`.${e}`))}return e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([e,n])=>{"class"!==e&&"id"!==e&&(!0===n?t.push(e):!1!==n&&null!=n&&t.push(`${e}="${String(n)}"`))}),t.join(" ")}function Bh(e){const{nodeName:t,name:n,parseAttributes:r=zh,serializeAttributes:o=Fh,defaultAttributes:i={},requiredAttributes:s=[],allowedAttributes:a}=e,l=n||t;return{parseMarkdown:(e,n)=>{const r={...i,...e.attributes};return n.createNode(t,r,[])},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp(`^:::${l}(?:\\s|$)`,"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,o){const i=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),a=e.match(i);if(!a)return;const c=a[1]||"",d=r(c);return s.find(e=>!(e in d))?void 0:{type:t,raw:a[0],attributes:d}}},renderMarkdown:e=>{const t=(e=>{if(!a)return e;const t={};return a.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),n=o(t);return`:::${l}${n?` {${n}}`:""} :::`}}}function Uh(e){const{nodeName:t,name:n,getContent:r,parseAttributes:o=zh,serializeAttributes:i=Fh,defaultAttributes:s={},content:a="block",allowedAttributes:l}=e,c=n||t;return{parseMarkdown:(e,n)=>{let o;if(r){const t=r(e);o="string"==typeof t?[{type:"text",text:t}]:t}else o="block"===a?n.parseChildren(e.tokens||[]):n.parseInline(e.tokens||[]);const i={...s,...e.attributes};return n.createNode(t,i,o)},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp(`^:::${c}`,"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,r){var i;const s=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),l=e.match(s);if(!l)return;const[d,u=""]=l,h=o(u);let p=1;const f=d.length;let m="";const g=/^:::([\w-]*)(\s.*)?/gm,b=e.slice(f);for(g.lastIndex=0;;){const n=g.exec(b);if(null===n)break;const o=n.index,s=n[1];if(!(null==(i=n[2])?void 0:i.endsWith(":::")))if(s)p+=1;else if(p-=1,0===p){const i=b.slice(0,o);m=i.trim();const s=e.slice(0,f+o+n[0].length);let l=[];if(m)if("block"===a)for(l=r.blockTokens(i),l.forEach(e=>{!e.text||e.tokens&&0!==e.tokens.length||(e.tokens=r.inlineTokens(e.text))});l.length>0;){const e=l[l.length-1];if("paragraph"!==e.type||e.text&&""!==e.text.trim())break;l.pop()}else l=r.inlineTokens(m);return{type:t,raw:s,attributes:h,content:m,tokens:l}}}}},renderMarkdown:(e,t)=>{const n=(e=>{if(!l)return e;const t={};return l.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),r=i(n),o=r?` {${r}}`:"",s=t.renderChildren(e.content||[],"\n\n");return`:::${c}${o}\n\n${s}\n\n:::`}}}function Vh(e){if(!e.trim())return{};const t={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(e);for(;null!==r;){const[,o,i,s]=r;t[o]=i||s,r=n.exec(e)}return t}function _h(e){return Object.entries(e).filter(([,e])=>null!=e).map(([e,t])=>`${e}="${t}"`).join(" ")}function Hh(e){const{nodeName:t,name:n,getContent:r,parseAttributes:o=Vh,serializeAttributes:i=_h,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=e,c=n||t,d=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(e,n)=>{const o={...s,...e.attributes};if(a)return n.createNode(t,o);const i=r?r(e):e.content||"";return i?n.createNode(t,o,[n.createTextNode(i)]):n.createNode(t,o,[])},markdownTokenizer:{name:t,level:"inline",start(e){const t=a?new RegExp(`\\[${d}\\s*[^\\]]*\\]`):new RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),n=e.match(t),r=null==n?void 0:n.index;return void 0!==r?r:-1},tokenize(e,n,r){const i=a?new RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),s=e.match(i);if(!s)return;let l="",c="";if(a){const[,e]=s;c=e}else{const[,e,t]=s;c=e,l=t||""}const u=o(c.trim());return{type:t,raw:s[0],content:l.trim(),attributes:u}}},renderMarkdown:e=>{let t="";r?t=r(e):e.content&&e.content.length>0&&(t=e.content.filter(e=>"text"===e.type).map(e=>e.text).join(""));const n=(e=>{if(!l)return e;const t={};return l.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),o=i(n),s=o?` ${o}`:"";return a?`[${c}${s}]`:`[${c}${s}]${t}[/${c}]`}}}function Wh(e,t,n){var r,o,i,s;const a=e.split("\n"),l=[];let c="",d=0;const u=t.baseIndentSize||2;for(;d<a.length;){const e=a[d],h=e.match(t.itemPattern);if(!h){if(l.length>0)break;if(""===e.trim()){d+=1;continue}return}const p=t.extractItemData(h),{indentLevel:f,mainContent:m}=p;c=`${c}${e}\n`;const g=[m];for(d+=1;d<a.length;){const e=a[d];if(""===e.trim()){const t=a.slice(d+1).findIndex(e=>""!==e.trim());if(-1===t)break;if(((null==(o=null==(r=a[d+1+t].match(/^(\s*)/))?void 0:r[1])?void 0:o.length)||0)>f){g.push(e),c=`${c}${e}\n`,d+=1;continue}break}if(!(((null==(s=null==(i=e.match(/^(\s*)/))?void 0:i[1])?void 0:s.length)||0)>f))break;g.push(e),c=`${c}${e}\n`,d+=1}let b;const x=g.slice(1);if(x.length>0){const e=x.map(e=>e.slice(f+u)).join("\n");e.trim()&&(b=t.customNestedParser?t.customNestedParser(e):n.blockTokens(e))}const y=t.createToken(p,b);l.push(y)}if(0!==l.length)return{items:l,raw:c.trim()}}function qh(e,t,n,r){if(!e||!Array.isArray(e.content))return"";const o="function"==typeof n?n(r):n,[i,...s]=e.content,a=[`${o}${t.renderChildren([i])}`];return s&&s.length>0&&s.forEach(e=>{const n=t.renderChildren([e]);if(n){const e=n.split("\n").map(e=>e?t.indent(e):"").join("\n");a.push(e)}}),a.join("\n")}id({},{createAtomBlockMarkdownSpec:()=>Bh,createBlockMarkdownSpec:()=>Uh,createInlineMarkdownSpec:()=>Hh,parseAttributes:()=>zh,parseIndentedBlocks:()=>Wh,renderNestedMarkdownContent:()=>qh,serializeAttributes:()=>Fh});var Kh,Jh,Yh=class e extends bh{constructor(){super(...arguments),this.type="node"}static create(t={}){const n="function"==typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"==typeof e?e():e;return super.extend(t)}};function Gh(e){return new yh({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:o})=>{const i=wu(e.getAttributes,void 0,r,o);if(!1===i||null===i)return null;const{tr:s}=t,a=r[r.length-1],l=r[0];let c=n.to;if(a){const r=l.search(/\S/),o=n.from+l.indexOf(a),d=o+a.length;if($u(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>o).length)return null;d<n.to&&s.delete(d,n.to),o>n.from&&s.delete(n.from+r,o),c=n.from+r+a.length,s.addMark(n.from+r,c,e.type.create(i||{})),s.removeStoredMark(e.type)}}})}var Xh=(Jh||(Jh=1,Kh=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,o,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!==o--;)if(!e(t[o],n[o]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(o of t.entries())if(!n.has(o[0]))return!1;for(o of t.entries())if(!e(o[1],n.get(o[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(o of t.entries())if(!n.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((r=t.length)!=n.length)return!1;for(o=r;0!==o--;)if(t[o]!==n[o])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!==o--;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;0!==o--;){var s=i[o];if(!("_owner"===s&&t.$$typeof||e(t[s],n[s])))return!1}return!0}return t!=t&&n!=n}),Kh);const Qh=$(Xh);var Zh,ep,tp={exports:{}},np={};var rp=(ep||(ep=1,tp.exports=function(){if(Zh)return np;Zh=1;var e=L(),t=Ir(),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,a=e.useDebugValue;return np.useSyncExternalStoreWithSelector=function(e,t,l,c,d){var u=o(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=s(function(){function e(e){if(!i){if(i=!0,r=e,e=c(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return o=t}return o=e}if(t=o,n(r,e))return t;var s=c(e);return void 0!==d&&d(t,s)?(r=e,t):(r=e,o=s)}var r,o,i=!1,s=void 0===l?null:l;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]},[t,l,c,d]);var p=r(e,u[0],u[1]);return i(function(){h.hasValue=!0,h.value=p},[p]),a(p),p},np}()),tp.exports),op=(...e)=>t=>{e.forEach(e=>{"function"==typeof e?e(t):e&&(e.current=t)})},ip=({contentComponent:e})=>{const t=Rr.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return T.jsx(T.Fragment,{children:Object.values(t)})};var sp=class extends n.Component{constructor(e){var t;super(e),this.editorContentRef=n.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:Boolean(null==(t=e.editor)?void 0:t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(e.view.dom),e.setOptions({element:t}),e.contentComponent=function(){const e=new Set;let t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t={...t,[n]:z.createPortal(r.reactElement,r.element,n)},e.forEach(e=>e())},removeRenderer(n){const r={...t};delete r[n],t=r,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!(null==(e=t.view.dom)?void 0:e.firstChild))return;const n=document.createElement("div");n.append(t.view.dom),t.setOptions({element:n})}catch{}}}render(){const{editor:e,innerRef:t,...n}=this.props;return T.jsxs(T.Fragment,{children:[T.jsx("div",{ref:op(t,this.editorContentRef),...n}),(null==e?void 0:e.contentComponent)&&T.jsx(ip,{contentComponent:e.contentComponent})]})}},ap=e.forwardRef((e,t)=>{const r=n.useMemo(()=>Math.floor(4294967295*Math.random()).toString(),[e.editor]);return n.createElement(sp,{key:r,innerRef:t,...e})}),lp=n.memo(ap),cp="undefined"!=typeof window?e.useLayoutEffect:e.useEffect,dp=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}};var up="undefined"==typeof window,hp=up||Boolean("undefined"!=typeof window&&window.next),pp=class e{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?up||hp?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onBeforeCreate)?void 0:n.call(t,...e)},onBlur:(...e)=>{var t,n;return null==(n=(t=this.options.current).onBlur)?void 0:n.call(t,...e)},onCreate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onCreate)?void 0:n.call(t,...e)},onDestroy:(...e)=>{var t,n;return null==(n=(t=this.options.current).onDestroy)?void 0:n.call(t,...e)},onFocus:(...e)=>{var t,n;return null==(n=(t=this.options.current).onFocus)?void 0:n.call(t,...e)},onSelectionUpdate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onSelectionUpdate)?void 0:n.call(t,...e)},onTransaction:(...e)=>{var t,n;return null==(n=(t=this.options.current).onTransaction)?void 0:n.call(t,...e)},onUpdate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onUpdate)?void 0:n.call(t,...e)},onContentError:(...e)=>{var t,n;return null==(n=(t=this.options.current).onContentError)?void 0:n.call(t,...e)},onDrop:(...e)=>{var t,n;return null==(n=(t=this.options.current).onDrop)?void 0:n.call(t,...e)},onPaste:(...e)=>{var t,n;return null==(n=(t=this.options.current).onPaste)?void 0:n.call(t,...e)},onDelete:(...e)=>{var t,n;return null==(n=(t=this.options.current).onDelete)?void 0:n.call(t,...e)}};return new Lh(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var r;return e===(null==(r=t.extensions)?void 0:r[n])}):e[n]===t[n]))}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===t.length?e.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps)return void(this.previousDeps=e);if(this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{this.isComponentMounted&&this.instanceId===e?t&&t.setOptions(this.options.current):t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function fp(t={},n=[]){const r=e.useRef(t);r.current=t;const[o]=e.useState(()=>new pp(r)),i=Rr.useSyncExternalStore(o.subscribe,o.getEditor,o.getServerSnapshot);return e.useDebugValue(i),e.useEffect(o.onRender(n)),function(t){var n;const[r]=e.useState(()=>new dp(t.editor)),o=rp.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,t.selector,null!=(n=t.equalityFn)?n:Qh);cp(()=>r.watch(t.editor),[t.editor,r]),e.useDebugValue(o)}({editor:i,selector:({transactionNumber:e})=>!1===t.shouldRerenderOnTransaction||void 0===t.shouldRerenderOnTransaction?null:t.immediatelyRender&&0===e?0:e+1}),i}var mp=e.createContext({editor:null});mp.Consumer;var gp=()=>e.useContext(mp),bp=e.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}});n.forwardRef((t,n)=>{const{onDragStart:r}=e.useContext(bp),o=t.as||"div";return T.jsx(o,{...t,ref:n,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...t.style}})}),n.createContext({markViewContentRef:()=>{}});const xp="numeric",yp="ascii",vp="alpha",wp="asciinumeric",kp="alphanumeric",Cp="domain",Sp="emoji",Np="scheme",jp="slashscheme",Ep="whitespace";function Mp(e,t){return e in t||(t[e]=[]),t[e]}function Tp(e,t,n){t[xp]&&(t[wp]=!0,t[kp]=!0),t[yp]&&(t[wp]=!0,t[vp]=!0),t[wp]&&(t[kp]=!0),t[vp]&&(t[kp]=!0),t[kp]&&(t[Cp]=!0),t[Sp]&&(t[Cp]=!0);for(const r in t){const t=Mp(r,n);t.indexOf(e)<0&&t.push(e)}}function Op(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Op.groups={},Op.prototype={accepts(){return!!this.t},go(e){const t=this,n=t.j[e];if(n)return n;for(let r=0;r<t.jr.length;r++){const n=t.jr[r][0],o=t.jr[r][1];if(o&&n.test(e))return o}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,n,r){for(let o=0;o<e.length;o++)this.tt(e[o],t,n,r)},tr(e,t,n,r){let o;return r=r||Op.groups,t&&t.j?o=t:(o=new Op(t),n&&r&&Tp(t,n,r)),this.jr.push([e,o]),o},ts(e,t,n,r){let o=this;const i=e.length;if(!i)return o;for(let s=0;s<i-1;s++)o=o.tt(e[s]);return o.tt(e[i-1],t,n,r)},tt(e,t,n,r){r=r||Op.groups;const o=this;if(t&&t.j)return o.j[e]=t,t;const i=t;let s,a=o.go(e);if(a?(s=new Op,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Op,i){if(r)if(s.t&&"string"==typeof s.t){const e=Object.assign(function(e,t){const n={};for(const r in t)t[r].indexOf(e)>=0&&(n[r]=!0);return n}(s.t,r),n);Tp(i,e,r)}else n&&Tp(i,n,r);s.t=i}return o.j[e]=s,s}};const Ap=(e,t,n,r,o)=>e.ta(t,n,r,o),Dp=(e,t,n,r,o)=>e.tr(t,n,r,o),Ip=(e,t,n,r,o)=>e.ts(t,n,r,o),Rp=(e,t,n,r,o)=>e.tt(t,n,r,o),Pp="WORD",Lp="UWORD",$p="ASCIINUMERICAL",zp="ALPHANUMERICAL",Fp="LOCALHOST",Bp="TLD",Up="UTLD",Vp="SCHEME",_p="SLASH_SCHEME",Hp="NUM",Wp="WS",qp="NL",Kp="OPENBRACE",Jp="CLOSEBRACE",Yp="OPENBRACKET",Gp="CLOSEBRACKET",Xp="OPENPAREN",Qp="CLOSEPAREN",Zp="OPENANGLEBRACKET",ef="CLOSEANGLEBRACKET",tf="FULLWIDTHLEFTPAREN",nf="FULLWIDTHRIGHTPAREN",rf="LEFTCORNERBRACKET",of="RIGHTCORNERBRACKET",sf="LEFTWHITECORNERBRACKET",af="RIGHTWHITECORNERBRACKET",lf="FULLWIDTHLESSTHAN",cf="FULLWIDTHGREATERTHAN",df="AMPERSAND",uf="APOSTROPHE",hf="ASTERISK",pf="AT",ff="BACKSLASH",mf="BACKTICK",gf="CARET",bf="COLON",xf="COMMA",yf="DOLLAR",vf="DOT",wf="EQUALS",kf="EXCLAMATION",Cf="HYPHEN",Sf="PERCENT",Nf="PIPE",jf="PLUS",Ef="POUND",Mf="QUERY",Tf="QUOTE",Of="FULLWIDTHMIDDLEDOT",Af="SEMI",Df="SLASH",If="TILDE",Rf="UNDERSCORE",Pf="EMOJI",Lf="SYM";var $f=Object.freeze({__proto__:null,ALPHANUMERICAL:zp,AMPERSAND:df,APOSTROPHE:uf,ASCIINUMERICAL:$p,ASTERISK:hf,AT:pf,BACKSLASH:ff,BACKTICK:mf,CARET:gf,CLOSEANGLEBRACKET:ef,CLOSEBRACE:Jp,CLOSEBRACKET:Gp,CLOSEPAREN:Qp,COLON:bf,COMMA:xf,DOLLAR:yf,DOT:vf,EMOJI:Pf,EQUALS:wf,EXCLAMATION:kf,FULLWIDTHGREATERTHAN:cf,FULLWIDTHLEFTPAREN:tf,FULLWIDTHLESSTHAN:lf,FULLWIDTHMIDDLEDOT:Of,FULLWIDTHRIGHTPAREN:nf,HYPHEN:Cf,LEFTCORNERBRACKET:rf,LEFTWHITECORNERBRACKET:sf,LOCALHOST:Fp,NL:qp,NUM:Hp,OPENANGLEBRACKET:Zp,OPENBRACE:Kp,OPENBRACKET:Yp,OPENPAREN:Xp,PERCENT:Sf,PIPE:Nf,PLUS:jf,POUND:Ef,QUERY:Mf,QUOTE:Tf,RIGHTCORNERBRACKET:of,RIGHTWHITECORNERBRACKET:af,SCHEME:Vp,SEMI:Af,SLASH:Df,SLASH_SCHEME:_p,SYM:Lf,TILDE:If,TLD:Bp,UNDERSCORE:Rf,UTLD:Up,UWORD:Lp,WORD:Pp,WS:Wp});const zf=/[a-z]/,Ff=new RegExp("\\p{L}","u"),Bf=new RegExp("\\p{Emoji}","u"),Uf=/\d/,Vf=/\s/;let _f=null,Hf=null;function Wf(e,t){const n=function(e){const t=[],n=e.length;let r=0;for(;r<n;){let o,i=e.charCodeAt(r),s=i<55296||i>56319||r+1===n||(o=e.charCodeAt(r+1))<56320||o>57343?e[r]:e.slice(r,r+2);t.push(s),r+=s.length}return t}(t.replace(/[A-Z]/g,e=>e.toLowerCase())),r=n.length,o=[];let i=0,s=0;for(;s<r;){let a=e,l=null,c=0,d=null,u=-1,h=-1;for(;s<r&&(l=a.go(n[s]));)a=l,a.accepts()?(u=0,h=0,d=a):u>=0&&(u+=n[s].length,h++),c+=n[s].length,i+=n[s].length,s++;i-=u,s-=h,c-=u,o.push({t:d.t,v:t.slice(i-c,i),s:i-c,e:i})}return o}function qf(e,t,n,r,o){let i;const s=t.length;for(let a=0;a<s-1;a++){const n=t[a];e.j[n]?i=e.j[n]:(i=new Op(r),i.jr=o.slice(),e.j[n]=i),e=i}return i=new Op(n),i.jr=o.slice(),e.j[t[s-1]]=i,i}function Kf(e){const t=[],n=[];let r=0;for(;r<e.length;){let o=0;for(;"0123456789".indexOf(e[r+o])>=0;)o++;if(o>0){t.push(n.join(""));for(let t=parseInt(e.substring(r,r+o),10);t>0;t--)n.pop();r+=o}else n.push(e[r]),r++}return t}const Jf={defaultProtocol:"http",events:null,format:Gf,formatHref:Gf,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Yf(e,t=null){let n=Object.assign({},Jf);e&&(n=Object.assign(n,e instanceof Yf?e.o:e));const r=n.ignoreTags,o=[];for(let i=0;i<r.length;i++)o.push(r[i].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=o}function Gf(e){return e}function Xf(e,t){this.t="token",this.v=e,this.tk=t}function Qf(e,t){class n extends Xf{constructor(t,n){super(t,n),this.t=e}}for(const r in t)n.prototype[r]=t[r];return n.t=e,n}Yf.prototype={o:Jf,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,n){const r=null!=t;let o=this.o[e];return o?("object"==typeof o?(o=n.t in o?o[n.t]:Jf[e],"function"==typeof o&&r&&(o=o(t,n))):"function"==typeof o&&r&&(o=o(t,n.t,n)),o):o},getObj(e,t,n){let r=this.o[e];return"function"==typeof r&&null!=t&&(r=r(t,n.t,n)),r},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}},Xf.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),n=e.get("truncate",t,this),r=e.get("format",t,this);return n&&r.length>n?r.substring(0,n)+"â€¦":r},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=Jf.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,n=this.toHref(e.get("defaultProtocol")),r=e.get("formatHref",n,this),o=e.get("tagName",n,t),i=this.toFormattedString(e),s={},a=e.get("className",n,t),l=e.get("target",n,t),c=e.get("rel",n,t),d=e.getObj("attributes",n,t),u=e.getObj("events",n,t);return s.href=r,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),d&&Object.assign(s,d),{tagName:o,attributes:s,content:i,eventListeners:u}}};const Zf=Qf("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),em=Qf("text"),tm=Qf("nl"),nm=Qf("url",{isLink:!0,toHref(e=Jf.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==Fp&&e[1].t===bf}}),rm=e=>new Op(e);function om(e,t,n){const r=n[0].s,o=n[n.length-1].e;return new e(t.slice(r,o),n)}const im="undefined"!=typeof console&&console&&console.warn||(()=>{}),sm={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function am(e,t=!1){if(sm.initialized&&im(`linkifyjs: already initialized - will not register custom scheme "${e}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');sm.customSchemes.push([e,t])}function lm(){sm.scanner=function(e=[]){const t={};Op.groups=t;const n=new Op;null==_f&&(_f=Kf("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mÃ¶gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==Hf&&(Hf=Kf("ÎµÎ»1Ï…2Ð±Ð³1ÐµÐ»3Ð´ÐµÑ‚Ð¸4ÐµÑŽ2ÐºÐ°Ñ‚Ð¾Ð»Ð¸Ðº6Ð¾Ð¼3Ð¼ÐºÐ´2Ð¾Ð½1ÑÐºÐ²Ð°6Ð¾Ð½Ð»Ð°Ð¹Ð½5Ñ€Ð³3Ñ€ÑƒÑ2Ñ„2ÑÐ°Ð¹Ñ‚3Ñ€Ð±3ÑƒÐºÑ€3Ò›Ð°Ð·3Õ°Õ¡Õµ3×™×©×¨××œ5×§×•×3Ø§Ø¨ÙˆØ¸Ø¨ÙŠ5Ø±Ø§Ù…ÙƒÙˆ5Ù„Ø§Ø±Ø¯Ù†4Ø¨Ø­Ø±ÙŠÙ†5Ø¬Ø²Ø§Ø¦Ø±5Ø³Ø¹ÙˆØ¯ÙŠØ©6Ø¹Ù„ÙŠØ§Ù†5Ù…ØºØ±Ø¨5Ù…Ø§Ø±Ø§Øª5ÛŒØ±Ø§Ù†5Ø¨Ø§Ø±Øª2Ø²Ø§Ø±4ÙŠØªÙƒ3Ú¾Ø§Ø±Øª5ØªÙˆÙ†Ø³4Ø³ÙˆØ¯Ø§Ù†3Ø±ÙŠØ©5Ø´Ø¨ÙƒØ©4Ø¹Ø±Ø§Ù‚2Ø¨2Ù…Ø§Ù†4ÙÙ„Ø³Ø·ÙŠÙ†6Ù‚Ø·Ø±3ÙƒØ§Ø«ÙˆÙ„ÙŠÙƒ6ÙˆÙ…3Ù…ØµØ±2Ù„ÙŠØ³ÙŠØ§5ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§7Ù‚Ø¹4Ù‡Ù…Ø±Ø§Ù‡5Ù¾Ø§Ú©Ø³ØªØ§Ù†7Ú€Ø§Ø±Øª4à¤•à¥‰à¤®3à¤¨à¥‡à¤Ÿ3à¤­à¤¾à¤°à¤¤0à¤®à¥3à¥‹à¤¤5à¤¸à¤‚à¤—à¤ à¤¨5à¦¬à¦¾à¦‚à¦²à¦¾5à¦­à¦¾à¦°à¦¤2à§°à¦¤4à¨­à¨¾à¨°à¨¤4àª­àª¾àª°àª¤4à¬­à¬¾à¬°à¬¤4à®‡à®¨à¯à®¤à®¿à®¯à®¾6à®²à®™à¯à®•à¯ˆ6à®šà®¿à®™à¯à®•à®ªà¯à®ªà¯‚à®°à¯11à°­à°¾à°°à°¤à±5à²­à²¾à²°à²¤4à´­à´¾à´°à´¤à´‚5à¶½à¶‚à¶šà·4à¸„à¸­à¸¡3à¹„à¸—à¸¢3àº¥àº²àº§3áƒ’áƒ”2ã¿ã‚“ãª3ã‚¢ãƒžã‚¾ãƒ³4ã‚¯ãƒ©ã‚¦ãƒ‰4ã‚°ãƒ¼ã‚°ãƒ«4ã‚³ãƒ 2ã‚¹ãƒˆã‚¢3ã‚»ãƒ¼ãƒ«3ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³6ãƒã‚¤ãƒ³ãƒˆ4ä¸–ç•Œ2ä¸­ä¿¡1å›½1åœ‹1æ–‡ç½‘3äºšé©¬é€Š3ä¼ä¸š2ä½›å±±2ä¿¡æ¯2å¥åº·2å…«å¦2å…¬å¸1ç›Š2å°æ¹¾1ç£2å•†åŸŽ1åº—1æ ‡2å˜‰é‡Œ0å¤§é…’åº—5åœ¨çº¿2å¤§æ‹¿2å¤©ä¸»æ•™3å¨±ä¹2å®¶é›»2å¹¿ä¸œ2å¾®åš2æ…ˆå–„2æˆ‘çˆ±ä½ 3æ‰‹æœº2æ‹›è˜2æ”¿åŠ¡1åºœ2æ–°åŠ å¡2é—»2æ—¶å°š2æ›¸ç±2æœºæž„2æ·¡é©¬é”¡3æ¸¸æˆ2æ¾³é–€2ç‚¹çœ‹2ç§»åŠ¨2ç»„ç»‡æœºæž„4ç½‘å€1åº—1ç«™1ç»œ2è”é€š2è°·æ­Œ2è´­ç‰©2é€šè²©2é›†å›¢2é›»è¨Šç›ˆç§‘4é£žåˆ©æµ¦3é£Ÿå“2é¤åŽ…2é¦™æ ¼é‡Œæ‹‰3æ¸¯2ë‹·ë„·1ì»´2ì‚¼ì„±2í•œêµ­2")),Rp(n,"'",uf),Rp(n,"{",Kp),Rp(n,"}",Jp),Rp(n,"[",Yp),Rp(n,"]",Gp),Rp(n,"(",Xp),Rp(n,")",Qp),Rp(n,"<",Zp),Rp(n,">",ef),Rp(n,"ï¼ˆ",tf),Rp(n,"ï¼‰",nf),Rp(n,"ã€Œ",rf),Rp(n,"ã€",of),Rp(n,"ã€Ž",sf),Rp(n,"ã€",af),Rp(n,"ï¼œ",lf),Rp(n,"ï¼ž",cf),Rp(n,"&",df),Rp(n,"*",hf),Rp(n,"@",pf),Rp(n,"`",mf),Rp(n,"^",gf),Rp(n,":",bf),Rp(n,",",xf),Rp(n,"$",yf),Rp(n,".",vf),Rp(n,"=",wf),Rp(n,"!",kf),Rp(n,"-",Cf),Rp(n,"%",Sf),Rp(n,"|",Nf),Rp(n,"+",jf),Rp(n,"#",Ef),Rp(n,"?",Mf),Rp(n,'"',Tf),Rp(n,"/",Df),Rp(n,";",Af),Rp(n,"~",If),Rp(n,"_",Rf),Rp(n,"\\",ff),Rp(n,"ãƒ»",Of);const r=Dp(n,Uf,Hp,{[xp]:!0});Dp(r,Uf,r);const o=Dp(r,zf,$p,{[wp]:!0}),i=Dp(r,Ff,zp,{[kp]:!0}),s=Dp(n,zf,Pp,{[yp]:!0});Dp(s,Uf,o),Dp(s,zf,s),Dp(o,Uf,o),Dp(o,zf,o);const a=Dp(n,Ff,Lp,{[vp]:!0});Dp(a,zf),Dp(a,Uf,i),Dp(a,Ff,a),Dp(i,Uf,i),Dp(i,zf),Dp(i,Ff,i);const l=Rp(n,"\n",qp,{[Ep]:!0}),c=Rp(n,"\r",Wp,{[Ep]:!0}),d=Dp(n,Vf,Wp,{[Ep]:!0});Rp(n,"ï¿¼",d),Rp(c,"\n",l),Rp(c,"ï¿¼",d),Dp(c,Vf,d),Rp(d,"\r"),Rp(d,"\n"),Dp(d,Vf,d),Rp(d,"ï¿¼",d);const u=Dp(n,Bf,Pf,{[Sp]:!0});Rp(u,"#"),Dp(u,Bf,u),Rp(u,"ï¸",u);const h=Rp(u,"â€");Rp(h,"#"),Dp(h,Bf,u);const p=[[zf,s],[Uf,o]],f=[[zf,null],[Ff,a],[Uf,i]];for(let m=0;m<_f.length;m++)qf(n,_f[m],Bp,Pp,p);for(let m=0;m<Hf.length;m++)qf(n,Hf[m],Up,Lp,f);Tp(Bp,{tld:!0,ascii:!0},t),Tp(Up,{utld:!0,alpha:!0},t),qf(n,"file",Vp,Pp,p),qf(n,"mailto",Vp,Pp,p),qf(n,"http",_p,Pp,p),qf(n,"https",_p,Pp,p),qf(n,"ftp",_p,Pp,p),qf(n,"ftps",_p,Pp,p),Tp(Vp,{scheme:!0,ascii:!0},t),Tp(_p,{slashscheme:!0,ascii:!0},t),e=e.sort((e,t)=>e[0]>t[0]?1:-1);for(let m=0;m<e.length;m++){const t=e[m][0],r=e[m][1]?{[Np]:!0}:{[jp]:!0};t.indexOf("-")>=0?r[Cp]=!0:zf.test(t)?Uf.test(t)?r[wp]=!0:r[yp]=!0:r[xp]=!0,Ip(n,t,t,r)}return Ip(n,"localhost",Fp,{ascii:!0}),n.jd=new Op(Lf),{start:n,tokens:Object.assign({groups:t},$f)}}(sm.customSchemes);for(let e=0;e<sm.tokenQueue.length;e++)sm.tokenQueue[e][1]({scanner:sm.scanner});sm.parser=function({groups:e}){const t=e.domain.concat([df,hf,pf,ff,mf,gf,yf,wf,Cf,Hp,Sf,Nf,jf,Ef,Df,Lf,If,Rf]),n=[uf,bf,xf,vf,kf,Sf,Mf,Tf,Af,Zp,ef,Kp,Jp,Gp,Yp,Xp,Qp,tf,nf,rf,of,sf,af,lf,cf],r=[df,uf,hf,ff,mf,gf,yf,wf,Cf,Kp,Jp,Sf,Nf,jf,Ef,Mf,Df,Lf,If,Rf],o=rm(),i=Rp(o,If);Ap(i,r,i),Ap(i,e.domain,i);const s=rm(),a=rm(),l=rm();Ap(o,e.domain,s),Ap(o,e.scheme,a),Ap(o,e.slashscheme,l),Ap(s,r,i),Ap(s,e.domain,s);const c=Rp(s,pf);Rp(i,pf,c),Rp(a,pf,c),Rp(l,pf,c);const d=Rp(i,vf);Ap(d,r,i),Ap(d,e.domain,i);const u=rm();Ap(c,e.domain,u),Ap(u,e.domain,u);const h=Rp(u,vf);Ap(h,e.domain,u);const p=rm(Zf);Ap(h,e.tld,p),Ap(h,e.utld,p),Rp(c,Fp,p);const f=Rp(u,Cf);Rp(f,Cf,f),Ap(f,e.domain,u),Ap(p,e.domain,u),Rp(p,vf,h),Rp(p,Cf,f);const m=Rp(p,bf);Ap(m,e.numeric,Zf);const g=Rp(s,Cf),b=Rp(s,vf);Rp(g,Cf,g),Ap(g,e.domain,s),Ap(b,r,i),Ap(b,e.domain,s);const x=rm(nm);Ap(b,e.tld,x),Ap(b,e.utld,x),Ap(x,e.domain,s),Ap(x,r,i),Rp(x,vf,b),Rp(x,Cf,g),Rp(x,pf,c);const y=Rp(x,bf),v=rm(nm);Ap(y,e.numeric,v);const w=rm(nm),k=rm();Ap(w,t,w),Ap(w,n,k),Ap(k,t,w),Ap(k,n,k),Rp(x,Df,w),Rp(v,Df,w);const C=Rp(a,bf),S=Rp(l,bf),N=Rp(S,Df),j=Rp(N,Df);Ap(a,e.domain,s),Rp(a,vf,b),Rp(a,Cf,g),Ap(l,e.domain,s),Rp(l,vf,b),Rp(l,Cf,g),Ap(C,e.domain,w),Rp(C,Df,w),Rp(C,Mf,w),Ap(j,e.domain,w),Ap(j,t,w),Rp(j,Df,w);const E=[[Kp,Jp],[Yp,Gp],[Xp,Qp],[Zp,ef],[tf,nf],[rf,of],[sf,af],[lf,cf]];for(let M=0;M<E.length;M++){const[e,r]=E[M],o=Rp(w,e);Rp(k,e,o),Rp(o,r,w);const i=rm(nm);Ap(o,t,i);const s=rm();Ap(o,n),Ap(i,t,i),Ap(i,n,s),Ap(s,t,i),Ap(s,n,s),Rp(i,r,w),Rp(s,r,w)}return Rp(o,Fp,x),Rp(o,qp,tm),{start:o,tokens:$f}}(sm.scanner.tokens);for(let e=0;e<sm.pluginQueue.length;e++)sm.pluginQueue[e][1]({scanner:sm.scanner,parser:sm.parser});return sm.initialized=!0,sm}function cm(e){return sm.initialized||lm(),function(e,t,n){let r=n.length,o=0,i=[],s=[];for(;o<r;){let a=e,l=null,c=null,d=0,u=null,h=-1;for(;o<r&&!(l=a.go(n[o].t));)s.push(n[o++]);for(;o<r&&(c=l||a.go(n[o].t));)l=null,a=c,a.accepts()?(h=0,u=a):h>=0&&h++,o++,d++;if(h<0)o-=d,o<r&&(s.push(n[o]),o++);else{s.length>0&&(i.push(om(em,t,s)),s=[]),o-=h,d-=h;const e=u.t,r=n.slice(o-d,o);i.push(om(e,t,r))}}return s.length>0&&i.push(om(em,t,s)),i}(sm.parser.start,e,Wf(sm.scanner.start,e))}function dm(e,t=null,n=null){if(t&&"object"==typeof t){if(n)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);n=t,t=null}const r=new Yf(n),o=cm(e),i=[];for(let s=0;s<o.length;s++){const e=o[s];!e.isLink||t&&e.t!==t||!r.check(e)||i.push(e.toFormattedObject(r))}return i}cm.scan=Wf;var um="[\0- Â áš€á Žâ€€-\u2029âŸã€€]",hm=new RegExp(um),pm=new RegExp(`${um}$`),fm=new RegExp(um,"g");function mm(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(e=>{const t="string"==typeof e?e:e.scheme;t&&n.push(t)}),!e||e.replace(fm,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var gm=xh.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate),this.options.protocols.forEach(e=>{"string"!=typeof e?am(e.scheme,e.optionalSlashes):am(e)})},onDestroy(){Op.groups={},sm.scanner=null,sm.parser=null,sm.tokenQueue=[],sm.pluginQueue=[],sm.customSchemes=[],sm.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!mm(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}),addAttributes(){return{href:{default:null,parseHTML:e=>e.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!(!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!mm(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:e=>!!mm(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Su(this.options.HTMLAttributes,e),0]:["a",Su(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var n;const r=(null==(n=e.attrs)?void 0:n.href)||"";return`[${t.renderChildren(e)}](${r})`},addCommands(){return{setLink:e=>({chain:t})=>{const{href:n}=e;return!!this.options.isAllowedUri(n,{defaultValidate:e=>!!mm(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&t().setMark(this.name,e).setMeta("preventAutolink",!0).run()},toggleLink:e=>({chain:t})=>{const{href:n}=e||{};return!(n&&!this.options.isAllowedUri(n,{defaultValidate:e=>!!mm(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Gh({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:r}=this.options,o=dm(e).filter(e=>e.isLink&&this.options.isAllowedUri(e.value,{defaultValidate:e=>!!mm(e,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(e=>{this.options.shouldAutoLink(e.value)&&t.push({text:e.value,data:{href:e.href},index:e.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:null==(t=e.data)?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;var r;return this.options.autolink&&e.push((r={type:this.type,defaultProtocol:this.options.defaultProtocol,validate:e=>this.options.isAllowedUri(e,{defaultValidate:e=>!!mm(e,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink},new ns({key:new ss("autolink"),appendTransaction:(e,t,n)=>{const o=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),i=e.some(e=>e.getMeta("preventAutolink"));if(!o||i)return;const{tr:s}=n;return Lu(mu(t.doc,[...e])).forEach(({newRange:e})=>{const t=function(e,t,n){const r=[];return e.nodesBetween(t.from,t.to,(e,t)=>{n(e)&&r.push({node:e,pos:t})}),r}(n.doc,e,e=>e.isTextblock);let o,i;if(t.length>1)o=t[0],i=n.doc.textBetween(o.pos,o.pos+o.node.nodeSize,void 0," ");else if(t.length){const r=n.doc.textBetween(e.from,e.to," "," ");if(!pm.test(r))return;o=t[0],i=n.doc.textBetween(o.pos,e.to,void 0," ")}if(o&&i){const e=i.split(hm).filter(Boolean);if(e.length<=0)return!1;const t=e[e.length-1],l=o.pos+i.lastIndexOf(t);if(!t)return!1;const c=cm(t).map(e=>e.toObject(r.defaultProtocol));if(!(1===(a=c).length?a[0].isLink:3===a.length&&a[1].isLink&&["()","[]"].includes(a[0].value+a[2].value)))return!1;c.filter(e=>e.isLink).map(e=>({...e,from:l+e.start+1,to:l+e.end+1})).filter(e=>!n.schema.marks.code||!n.doc.rangeHasMark(e.from,e.to,n.schema.marks.code)).filter(e=>r.validate(e.value)).filter(e=>r.shouldAutoLink(e.value)).forEach(e=>{$u(e.from,e.to,n.doc).some(e=>e.mark.type===r.type)||s.addMark(e.from,e.to,r.type.create({href:e.href}))})}var a}),s.steps.length?s:void 0}}))),!0===this.options.openOnClick&&e.push(function(e){return new ns({key:new ss("handleClickLink"),props:{handleClick:(t,n,r)=>{var o,i;if(0!==r.button)return!1;if(!t.editable)return!1;let s=null;if(r.target instanceof HTMLAnchorElement)s=r.target;else{let e=r.target;const t=[];for(;"DIV"!==e.nodeName;)t.push(e),e=e.parentNode;s=t.find(e=>"A"===e.nodeName)}if(!s)return!1;const a=Ru(t.state,e.type.name),l=null!=(o=null==s?void 0:s.href)?o:a.href,c=null!=(i=null==s?void 0:s.target)?i:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),!(!s||!l||(window.open(l,c),0))}}})}({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(function(e){return new ns({key:new ss("handlePasteLink"),props:{handlePaste:(t,n,r)=>{const{shouldAutoLink:o}=e,{state:i}=t,{selection:s}=i,{empty:a}=s;if(a)return!1;let l="";r.content.forEach(e=>{l+=e.textContent});const c=dm(l,{defaultProtocol:e.defaultProtocol}).find(e=>e.isLink&&e.value===l);return!(!l||!c||void 0!==o&&!o(c.href))&&e.editor.commands.setMark(e.type,{href:c.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}});function bm(e={}){return new ns({view:t=>new xm(t,e)})}class xm{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,r=this.editorView.dom,o=r.getBoundingClientRect(),i=o.width/r.offsetWidth,s=o.height/r.offsetHeight;if(n){let n=t.nodeBefore,r=t.nodeAfter;if(n||r){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let o=t.getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let a=this.width/2*s;e={left:o.left,right:o.right,top:i-a,bottom:i+a}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*i;e={left:t.left-n,right:t.left+n,top:t.top,bottom:t.bottom}}let a,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)a=-pageXOffset,l=-pageYOffset;else{let e=c.getBoundingClientRect(),t=e.width/c.offsetWidth,n=e.height/c.offsetHeight;a=e.left-c.scrollLeft*t,l=e.top-c.scrollTop*n}this.element.style.left=(e.left-a)/i+"px",this.element.style.top=(e.top-l)/s+"px",this.element.style.width=(e.right-e.left)/i+"px",this.element.style.height=(e.bottom-e.top)/s+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,t,e):r;if(t&&!o){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=vi(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class ym extends $i{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return ym.valid(n)?new ym(n):$i.near(n)}content(){return Hr.empty}eq(e){return e instanceof ym&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new ym(e.resolve(t.pos))}getBookmark(){return new vm(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0!=n)for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||wm(e.type))return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||wm(e.type))return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&ym.valid(e))return e;let r=e.pos,o=null;for(let n=e.depth;;n--){let i=e.node(n);if(t>0?e.indexAfter(n)<i.childCount:e.index(n)>0){o=i.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let s=e.doc.resolve(r);if(ym.valid(s))return s}for(;;){let i=t>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!_i.isSelectable(o)){e=e.doc.resolve(r+o.nodeSize*t),n=!1;continue e}break}o=i,r+=t;let s=e.doc.resolve(r);if(ym.valid(s))return s}return null}}}ym.prototype.visible=!1,ym.findFrom=ym.findGapCursorFrom,$i.jsonID("gapcursor",ym);class vm{constructor(e){this.pos=e}map(e){return new vm(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ym.valid(t)?new ym(t):$i.near(t)}}function wm(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}const km=rd({ArrowLeft:Cm("horiz",-1),ArrowRight:Cm("horiz",1),ArrowUp:Cm("vert",-1),ArrowDown:Cm("vert",1)});function Cm(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){let i=e.selection,s=t>0?i.$to:i.$from,a=i.empty;if(i instanceof Ui){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}let l=ym.findGapCursorFrom(s,t,a);return!!l&&(r&&r(e.tr.setSelection(new ym(l))),!0)}}function Sm(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!ym.valid(r))return!1;let o=e.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&_i.isSelectable(e.state.doc.nodeAt(o.inside)))&&(e.dispatch(e.state.tr.setSelection(new ym(r))),!0)}function Nm(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof ym))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let o=zr.empty;for(let s=r.length-1;s>=0;s--)o=zr.from(r[s].createAndFill(null,o));let i=e.state.tr.replace(n.pos,n.pos,new Hr(o,0,0));return i.setSelection(Ui.near(i.doc.resolve(n.pos+1))),e.dispatch(i),!1}function jm(e){if(!(e.selection instanceof ym))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",gc.create(e.doc,[pc.widget(e.selection.head,t,{key:"gapcursor"})])}var Em=200,Mm=function(){};Mm.prototype.append=function(e){return e.length?(e=Mm.from(e),!this.length&&e||e.length<Em&&this.leafAppend(e)||this.length<Em&&e.leafPrepend(this)||this.appendInner(e)):this},Mm.prototype.prepend=function(e){return e.length?Mm.from(e).append(this):this},Mm.prototype.appendInner=function(e){return new Om(this,e)},Mm.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?Mm.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},Mm.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},Mm.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},Mm.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},Mm.from=function(e){return e instanceof Mm?e:e&&e.length?new Tm(e):Mm.empty};var Tm=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=Em)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=Em)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(Mm);Mm.empty=new Tm([]);var Om=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(Mm);class Am{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,r,o=this.items.length;for(;;o--){if(this.items.get(o-1).selection){--o;break}}t&&(n=this.remapping(o,this.items.length),r=n.maps.length);let i,s,a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(o,t+1),r=n.maps.length),r--,void c.push(e);if(n){c.push(new Dm(e.map));let t,o=e.step.map(n.slice(r));o&&a.maybeStep(o).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new Dm(t,void 0,void 0,l.length+c.length))),r--,t&&n.appendMap(t,r)}else a.maybeStep(e.step);return e.selection?(i=n?e.selection.map(n.slice(r)):e.selection,s=new Am(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:s,transform:a,selection:i}}addTransform(e,t,n,r){let o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),d=new Dm(e.mapping.maps[c],l,t);(n=a&&a.merge(d))&&(d=n,c?o.pop():s=s.slice(0,s.length-1)),o.push(d),t&&(i++,t=void 0),r||(a=d)}let l=i-n.depth;return l>Rm&&(s=function(e,t){let n;return e.forEach((e,r)=>{if(e.selection&&0==t--)return n=r,!1}),e.slice(n)}(s,l),i-=l),new Am(s.append(o),i)}remapping(e,t){let n=new Xo;return this.items.forEach((t,r)=>{let o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)},e,t),n}addMaps(e){return 0==this.eventCount?this:new Am(this.items.append(e.map(e=>new Dm(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,s=this.eventCount;this.items.forEach(e=>{e.selection&&s--},r);let a=t;this.items.forEach(t=>{let r=o.getMirror(--a);if(null==r)return;i=Math.min(i,r);let l=o.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(o.slice(a+1,r));c&&s++,n.push(new Dm(l,i,c))}else n.push(new Dm(l))},r);let l=[];for(let u=t;u<i;u++)l.push(new Dm(o.maps[u]));let c=this.items.slice(0,r).append(l).append(n),d=new Am(c,s);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-n.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((i,s)=>{if(s>=e)r.push(i),i.selection&&o++;else if(i.step){let e=i.step.map(t.slice(n)),s=e&&e.getMap();if(n--,s&&t.appendMap(s,n),e){let a=i.selection&&i.selection.map(t.slice(n));a&&o++;let l,c=new Dm(s.invert(),e,a),d=r.length-1;(l=r.length&&r[d].merge(c))?r[d]=l:r.push(c)}}else i.map&&n--},this.items.length,0),new Am(Mm.from(r.reverse()),o)}}Am.empty=new Am(Mm.empty,0);class Dm{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Dm(t.getMap().invert(),t,this.selection)}}}class Im{constructor(e,t,n,r,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}const Rm=20;function Pm(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,o)=>t.push(r,o));return t}function Lm(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}let $m=!1,zm=null;function Fm(e){let t=e.plugins;if(zm!=t){$m=!1,zm=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){$m=!0;break}}return $m}const Bm=new ss("history"),Um=new ss("closeHistory");function Vm(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new ns({key:Bm,state:{init:()=>new Im(Am.empty,Am.empty,null,0,-1),apply:(t,n,r)=>function(e,t,n,r){let o,i=n.getMeta(Bm);if(i)return i.historyState;n.getMeta(Um)&&(e=new Im(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(Bm))return s.getMeta(Bm).redo?new Im(e.done.addTransform(n,void 0,r,Fm(t)),e.undone,Pm(n.mapping.maps),e.prevTime,e.prevComposition):new Im(e.done,e.undone.addTransform(n,void 0,r,Fm(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new Im(e.done.rebased(n,o),e.undone.rebased(n,o),Lm(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new Im(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),Lm(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let o=n.getMeta("composition"),i=0==e.prevTime||!s&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),a=s?Lm(e.prevRanges,n.mapping):Pm(n.mapping.maps);return new Im(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,Fm(t)),Am.empty,a,n.time,null==o?e.prevComposition:o)}}(n,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?Hm:"historyRedo"==n?Wm:null;return!(!r||!e.editable)&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function _m(e,t){return(n,r)=>{let o=Bm.getState(n);if(!o||0==(e?o.undone:o.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=Fm(t),o=Bm.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),a=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),o,r),l=new Im(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(s).setMeta(Bm,{redo:n,historyState:l})}(o,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}const Hm=_m(!1,!0),Wm=_m(!0,!0);Sh.create({name:"characterCount",addOptions:()=>({limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(e=>""!==e).length}),addStorage:()=>({characters:()=>0,words:()=>0}),onBeforeCreate(){this.storage.characters=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc;if("textSize"===((null==e?void 0:e.mode)||this.options.mode)){const e=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(e)}return t.nodeSize},this.storage.words=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let e=!1;return[new ns({key:new ss("characterCount"),appendTransaction:(t,n,r)=>{if(e)return;const o=this.options.limit;if(null==o||0===o)return void(e=!0);const i=this.storage.characters({node:r.doc});if(i>o){const t=0,n=i-o,s=r.tr.deleteRange(t,n);return e=!0,s}e=!0},filterTransaction:(e,t)=>{const n=this.options.limit;if(!e.docChanged||0===n||null==n)return!0;const r=this.storage.characters({node:t.doc}),o=this.storage.characters({node:e.doc});if(o<=n)return!0;if(r>n&&o>n&&o<=r)return!0;if(r>n&&o>n&&o>r)return!1;if(!e.getMeta("paste"))return!1;const i=e.selection.$head.pos,s=i-(o-n),a=i;e.deleteRange(s,a);return!(this.storage.characters({node:e.doc})>n)}})]}}),Sh.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[bm(this.options)]}}),Sh.create({name:"focus",addOptions:()=>({className:"has-focus",mode:"all"}),addProseMirrorPlugins(){return[new ns({key:new ss("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:o}=t,i=[];if(!n||!r)return gc.create(e,[]);let s=0;"deepest"===this.options.mode&&e.descendants((e,t)=>{if(e.isText)return;if(!(o>=t&&o<=t+e.nodeSize-1))return!1;s+=1});let a=0;return e.descendants((e,t)=>{if(e.isText)return!1;if(!(o>=t&&o<=t+e.nodeSize-1))return!1;a+=1;if("deepest"===this.options.mode&&s-a>0||"shallowest"===this.options.mode&&a>1)return"deepest"===this.options.mode;i.push(pc.node(t,t+e.nodeSize,{class:this.options.className}))}),gc.create(e,i)}}})]}}),Sh.create({name:"gapCursor",addProseMirrorPlugins:()=>[new ns({props:{decorations:jm,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&ym.valid(n)?new ym(n):null,handleClick:Sm,handleKeyDown:km,handleDOMEvents:{beforeinput:Nm}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!=(t=wu(bu(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))?t:null}}});var qm=Sh.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something â€¦",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new ns({key:new ss("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,o=[];if(!n)return null;const i=this.editor.isEmpty;return e.descendants((e,t)=>{const n=r>=t&&r<=t+e.nodeSize,s=!e.isLeaf&&_u(e);if((n||!this.options.showOnlyCurrent)&&s){const r=[this.options.emptyNodeClass];i&&r.push(this.options.emptyEditorClass);const s=pc.node(t,t+e.nodeSize,{class:r.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});o.push(s)}return this.options.includeChildren}),gc.create(e,o)}}})]}});function Km({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||(null==t?void 0:t.type)===e}Sh.create({name:"selection",addOptions:()=>({className:"selection"}),addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new ns({key:new ss("selection"),props:{decorations:n=>n.selection.empty||e.isFocused||!e.isEditable||n.selection instanceof _i||e.view.dragging?null:gc.create(n.doc,[pc.inline(n.selection.from,n.selection.to,{class:t.className})])}})]}}),Sh.create({name:"trailingNode",addOptions:()=>({node:void 0,notAfter:[]}),addProseMirrorPlugins(){var e;const t=new ss(this.name),n=(null==(e=this.editor.schema.topNodeType.contentMatch.defaultType)?void 0:e.name)||this.options.node||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,e])=>e).filter(e=>(this.options.notAfter||[]).concat(n).includes(e.name));return[new ns({key:t,appendTransaction:(e,r,o)=>{const{doc:i,tr:s,schema:a}=o,l=t.getState(o),c=i.content.size,d=a.nodes[n];if(l)return s.insert(c,d.create())},state:{init:(e,t)=>!Km({node:t.tr.doc.lastChild,types:r}),apply:(e,t)=>{if(!e.docChanged)return t;if(e.getMeta("__uniqueIDTransaction"))return t;return!Km({node:e.doc.lastChild,types:r})}}})]}}),Sh.create({name:"undoRedo",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>Hm(e,t),redo:()=>({state:e,dispatch:t})=>Wm(e,t)}),addProseMirrorPlugins(){return[Vm(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Ñ":()=>this.editor.commands.undo(),"Shift-Mod-Ñ":()=>this.editor.commands.redo()}}});var Jm=Yh.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),Ym=Yh.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n\n"):""}),Gm=Yh.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",Su(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{const n=e.tokens||[];return 1===n.length&&"image"===n[0].type?t.parseChildren([n[0]]):t.createNode("paragraph",void 0,t.parseInline(n))},renderMarkdown:(e,t)=>e&&Array.isArray(e.content)?t.renderChildren(e.content):"",addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Xm=Yh.create({name:"hardBreak",markdownTokenName:"br",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",Su(this.options.HTMLAttributes,e)]},renderText:()=>"\n",renderMarkdown:()=>"  \n",parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:e,storedMarks:o}=n;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:s}=r.extensionManager,a=o||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{if(t&&a&&i){const t=a.filter(e=>s.includes(e.type.name));e.ensureMarks(t)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Qm=(e,t)=>{if("slot"===e)return 0;if(e instanceof Function)return e(t);const{children:n,...r}=null!=t?t:{};if("svg"===e)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,r,n]},Zm=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,eg=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,tg=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ng=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,rg=xh.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return Qm("strong",{...Su(this.options.HTMLAttributes,e),children:Qm("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[$h({find:Zm,type:this.type}),$h({find:tg,type:this.type})]},addPasteRules(){return[Gh({find:eg,type:this.type}),Gh({find:ng,type:this.type})]}}),og=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,ig=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,sg=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,ag=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,lg=xh.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",Su(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[$h({find:og,type:this.type}),$h({find:sg,type:this.type})]},addPasteRules(){return[Gh({find:ig,type:this.type}),Gh({find:ag,type:this.type})]}}),cg=xh.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("underline")&&{}}],renderHTML({HTMLAttributes:e}){return["u",Su(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown:(e,t)=>`++${t.renderChildren(e)}++`,markdownTokenizer:{name:"underline",level:"inline",start:e=>e.indexOf("++"),tokenize(e,t,n){const r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!r)return;const o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),dg=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,ug=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,hg=xh.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",Su(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[$h({find:dg,type:this.type})]},addPasteRules(){return[Gh({find:ug,type:this.type})]}});const pg=(e="")=>[Ym,Gm,Jm,rg,lg,cg,hg,gm.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 hover:text-blue-800 underline cursor-pointer"}}),qm.configure({placeholder:e}),Sh.create({name:"customShortcuts",addKeyboardShortcuts:()=>({Enter:()=>!0})})],fg=(e="")=>[Ym,Gm,Jm,Xm,rg,lg,cg,hg,gm.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 hover:text-blue-800 underline cursor-pointer"}}),qm.configure({placeholder:e})],mg=e=>{if(!e)return"";let t=e;return t=t.replace(/\[([^\]]+)\]\(([^\)]+)\)/g,'<a href="$2">$1</a>'),t=t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>"),t=t.replace(/__(.+?)__/g,"<strong>$1</strong>"),t=t.replace(/\*(.+?)\*/g,"<em>$1</em>"),t=t.replace(/_(.+?)_/g,"<em>$1</em>"),t=t.replace(/~~(.+?)~~/g,"<s>$1</s>"),t=t.replace(/\+\+(.+?)\+\+/g,"<u>$1</u>"),t.replace(/\n/g,"<br>")},gg=e=>{if(!e)return"";let t=e.replace(/<p>/g,"").replace(/<\/p>/g,"\n");return t=t.replace(/<a\s+[^>]*href="([^"]+)"[^>]*>([^<]+)<\/a>/g,"[$2]($1)"),t=t.replace(/<strong>([^<]+)<\/strong>/g,"**$1**"),t=t.replace(/<b>([^<]+)<\/b>/g,"**$1**"),t=t.replace(/<em>([^<]+)<\/em>/g,"*$1*"),t=t.replace(/<i>([^<]+)<\/i>/g,"*$1*"),t=t.replace(/<s>([^<]+)<\/s>/g,"~~$1~~"),t=t.replace(/<del>([^<]+)<\/del>/g,"~~$1~~"),t=t.replace(/<u>([^<]+)<\/u>/g,"++$1++"),t=t.replace(/<br\s*\/?>/g,"\n"),t=t.trim(),t=t.replace(/\n+$/,""),t};var bg,xg;if("undefined"!=typeof WeakMap){let e=new WeakMap;bg=t=>e.get(t),xg=(t,n)=>(e.set(t,n),n)}else{const e=[],t=10;let n=0;bg=t=>{for(let n=0;n<e.length;n+=2)if(e[n]==t)return e[n+1]},xg=(r,o)=>(n==t&&(n=0),e[n++]=r,e[n++]=o)}var yg=class{constructor(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r}findCell(e){for(let t=0;t<this.map.length;t++){const n=this.map[t];if(n!=e)continue;const r=t%this.width,o=t/this.width|0;let i=r+1,s=o+1;for(let e=1;i<this.width&&this.map[t+e]==n;e++)i++;for(let e=1;s<this.height&&this.map[t+this.width*e]==n;e++)s++;return{left:r,top:o,right:i,bottom:s}}throw new RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError(`No cell with offset ${e} found`)}nextCell(e,t,n){const{left:r,right:o,top:i,bottom:s}=this.findCell(e);return"horiz"==t?(n<0?0==r:o==this.width)?null:this.map[i*this.width+(n<0?r-1:o)]:(n<0?0==i:s==this.height)?null:this.map[r+this.width*(n<0?i-1:s)]}rectBetween(e,t){const{left:n,right:r,top:o,bottom:i}=this.findCell(e),{left:s,right:a,top:l,bottom:c}=this.findCell(t);return{left:Math.min(n,s),top:Math.min(o,l),right:Math.max(r,a),bottom:Math.max(i,c)}}cellsInRect(e){const t=[],n={};for(let r=e.top;r<e.bottom;r++)for(let o=e.left;o<e.right;o++){const i=r*this.width+o,s=this.map[i];n[s]||(n[s]=!0,o==e.left&&o&&this.map[i-1]==s||r==e.top&&r&&this.map[i-this.width]==s||t.push(s))}return t}positionAt(e,t,n){for(let r=0,o=0;;r++){const i=o+n.child(r).nodeSize;if(r==e){let n=t+e*this.width;const r=(e+1)*this.width;for(;n<r&&this.map[n]<o;)n++;return n==r?i-1:this.map[n]}o=i}}static get(e){return bg(e)||xg(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);const t=function(e){let t=-1,n=!1;for(let r=0;r<e.childCount;r++){const o=e.child(r);let i=0;if(n)for(let t=0;t<r;t++){const n=e.child(t);for(let e=0;e<n.childCount;e++){const o=n.child(e);t+o.attrs.rowspan>r&&(i+=o.attrs.colspan)}}for(let e=0;e<o.childCount;e++){const t=o.child(e);i+=t.attrs.colspan,t.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[];let o=0,i=null;const s=[];for(let c=0,d=t*n;c<d;c++)r[c]=0;for(let c=0,d=0;c<n;c++){const a=e.child(c);d++;for(let e=0;;e++){for(;o<r.length&&0!=r[o];)o++;if(e==a.childCount)break;const l=a.child(e),{colspan:u,rowspan:h,colwidth:p}=l.attrs;for(let e=0;e<h;e++){if(e+c>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:d,n:h-e});break}const a=o+e*t;for(let e=0;e<u;e++){0==r[a+e]?r[a+e]=d:(i||(i=[])).push({type:"collision",row:c,pos:d,n:u-e});const n=p&&p[e];if(n){const r=(a+e)%t*2,o=s[r];null==o||o!=n&&1==s[r+1]?(s[r]=n,s[r+1]=1):o==n&&s[r+1]++}}}o+=u,d+=l.nodeSize}const l=(c+1)*t;let u=0;for(;o<l;)0==r[o++]&&u++;u&&(i||(i=[])).push({type:"missing",row:c,n:u}),d++}0!==t&&0!==n||(i||(i=[])).push({type:"zero_sized"});const a=new yg(t,n,r,i);let l=!1;for(let c=0;!l&&c<s.length;c+=2)null!=s[c]&&s[c+1]<n&&(l=!0);l&&function(e,t,n){e.problems||(e.problems=[]);const r={};for(let o=0;o<e.map.length;o++){const i=e.map[o];if(r[i])continue;r[i]=!0;const s=n.nodeAt(i);if(!s)throw new RangeError(`No cell with offset ${i} found`);let a=null;const l=s.attrs;for(let n=0;n<l.colspan;n++){const r=t[2*((o+n)%e.width)];null==r||l.colwidth&&l.colwidth[n]==r||((a||(a=vg(l)))[n]=r)}a&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}(a,s,e);return a}(e))}};function vg(e){if(e.colwidth)return e.colwidth.slice();const t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}function wg(e){let t=e.cached.tableNodeTypes;if(!t){t=e.cached.tableNodeTypes={};for(const n in e.nodes){const r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}}return t}function kg(e){const t=e.selection.$head;for(let n=t.depth;n>0;n--)if("row"==t.node(n).type.spec.tableRole)return!0;return!1}function Cg(e){return"row"==e.parent.type.spec.tableRole&&!!e.nodeAfter}function Sg(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function Ng(e,t,n){const r=e.node(-1),o=yg.get(r),i=e.start(-1),s=o.nextCell(e.pos-i,t,n);return null==s?null:e.node(0).resolve(i+s)}function jg(e,t,n=1){const r={...e,colspan:e.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some(e=>e>0)||(r.colwidth=null)),r}new ss("selectingCells");var Eg=class e extends $i{constructor(e,t=e){const n=e.node(-1),r=yg.get(n),o=e.start(-1),i=r.rectBetween(e.pos-o,t.pos-o),s=e.node(0),a=r.cellsInRect(i).filter(e=>e!=t.pos-o);a.unshift(t.pos-o);const l=a.map(e=>{const t=n.nodeAt(e);if(!t)throw RangeError(`No cell with offset ${e} found`);const r=o+e+1;return new zi(s.resolve(r),s.resolve(r+t.content.size))});super(l[0].$from,l[0].$to,l),this.$anchorCell=e,this.$headCell=t}map(t,n){const r=t.resolve(n.map(this.$anchorCell.pos)),o=t.resolve(n.map(this.$headCell.pos));if(Cg(r)&&Cg(o)&&Sg(r,o)){const t=this.$anchorCell.node(-1)!=r.node(-1);return t&&this.isRowSelection()?e.rowSelection(r,o):t&&this.isColSelection()?e.colSelection(r,o):new e(r,o)}return Ui.between(r,o)}content(){const e=this.$anchorCell.node(-1),t=yg.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[];for(let a=r.top;a<r.bottom;a++){const n=[];for(let i=a*t.width+r.left,s=r.left;s<r.right;s++,i++){const s=t.map[i];if(o[s])continue;o[s]=!0;const a=t.findCell(s);let l=e.nodeAt(s);if(!l)throw RangeError(`No cell with offset ${s} found`);const c=r.left-a.left,d=a.right-r.right;if(c>0||d>0){let e=l.attrs;if(c>0&&(e=jg(e,0,c)),d>0&&(e=jg(e,e.colspan-d,d)),a.left<r.left){if(l=l.type.createAndFill(e),!l)throw RangeError(`Could not create cell with attrs ${JSON.stringify(e)}`)}else l=l.type.create(e,l.content)}if(a.top<r.top||a.bottom>r.bottom){const e={...l.attrs,rowspan:Math.min(a.bottom,r.bottom)-Math.max(a.top,r.top)};l=a.top<r.top?l.type.createAndFill(e):l.type.create(e,l.content)}n.push(l)}i.push(e.child(a).copy(zr.from(n)))}const s=this.isColSelection()&&this.isRowSelection()?e:i;return new Hr(zr.from(s),1,1)}replace(e,t=Hr.empty){const n=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){const{$from:o,$to:s}=r[i],a=e.mapping.slice(n);e.replace(a.map(o.pos),a.map(s.pos),i?Hr.empty:t)}const o=$i.findFrom(e.doc.resolve(e.mapping.slice(n).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new Hr(zr.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),n=yg.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let i=0;i<o.length;i++)e(t.nodeAt(o[i]),r+o[i])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const n=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount}static colSelection(t,n=t){const r=t.node(-1),o=yg.get(r),i=t.start(-1),s=o.findCell(t.pos-i),a=o.findCell(n.pos-i),l=t.node(0);return s.top<=a.top?(s.top>0&&(t=l.resolve(i+o.map[s.left])),a.bottom<o.height&&(n=l.resolve(i+o.map[o.width*(o.height-1)+a.right-1]))):(a.top>0&&(n=l.resolve(i+o.map[a.left])),s.bottom<o.height&&(t=l.resolve(i+o.map[o.width*(o.height-1)+s.right-1]))),new e(t,n)}isRowSelection(){const e=this.$anchorCell.node(-1),t=yg.get(e),n=this.$anchorCell.start(-1),r=t.colCount(this.$anchorCell.pos-n),o=t.colCount(this.$headCell.pos-n);if(Math.min(r,o)>0)return!1;const i=r+this.$anchorCell.nodeAfter.attrs.colspan,s=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(i,s)==t.width}eq(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,n=t){const r=t.node(-1),o=yg.get(r),i=t.start(-1),s=o.findCell(t.pos-i),a=o.findCell(n.pos-i),l=t.node(0);return s.left<=a.left?(s.left>0&&(t=l.resolve(i+o.map[s.top*o.width])),a.right<o.width&&(n=l.resolve(i+o.map[o.width*(a.top+1)-1]))):(a.left>0&&(n=l.resolve(i+o.map[a.top*o.width])),s.right<o.width&&(t=l.resolve(i+o.map[o.width*(s.top+1)-1]))),new e(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,n){return new e(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,r=n){return new e(t.resolve(n),t.resolve(r))}getBookmark(){return new Mg(this.$anchorCell.pos,this.$headCell.pos)}};Eg.prototype.visible=!1,$i.jsonID("cell",Eg);var Mg=class e{constructor(e,t){this.anchor=e,this.head=t}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(e){const t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&Sg(t,n)?new Eg(t,n):$i.near(n,1)}};function Tg(e){const t=e.selection,n=function(e){const t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&"cell"==t.node.type.spec.tableRole)return t.$anchor;const n=function(e){for(let t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}(t.$head)||function(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){const r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){const r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n-t.nodeSize)}}(t.$head);if(n)return n;throw new RangeError(`No cell found around position ${t.head}`)}(e),r=n.node(-1),o=n.start(-1),i=yg.get(r);return{...t instanceof Eg?i.rectBetween(t.$anchorCell.pos-o,t.$headCell.pos-o):i.findCell(n.pos-o),tableStart:o,map:i,table:r}}function Og(e,t,n){const r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1});for(let o=0;o<r.length;o++){const e=t.table.nodeAt(r[o]);if(e&&e.type!==n.header_cell)return!1}return!0}function Ag(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,n){if(!kg(t))return!1;if(n){const r=wg(t.schema),o=Tg(t),i=t.tr,s=o.map.cellsInRect("column"==e?{left:o.left,top:0,right:o.right,bottom:o.map.height}:"row"==e?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),a=s.map(e=>o.table.nodeAt(e));for(let e=0;e<s.length;e++)a[e].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[e],r.cell,a[e].attrs);if(0==i.steps.length)for(let e=0;e<s.length;e++)i.setNodeMarkup(o.tableStart+s[e],r.header_cell,a[e].attrs);n(i)}return!0}}(e):function(t,n){if(!kg(t))return!1;if(n){const r=wg(t.schema),o=Tg(t),i=t.tr,s=Og("row",o,r),a=Og("column",o,r),l=("column"===e?s:"row"===e&&a)?1:0,c="column"==e?{left:0,top:l,right:1,bottom:o.map.height}:"row"==e?{left:l,top:0,right:o.map.width,bottom:1}:o,d="column"==e?a?r.cell:r.header_cell:"row"==e?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(c).forEach(e=>{const t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,d,n.attrs)}),n(i)}return!0}}function Dg(e,t){const n=e.selection;if(!(n instanceof Eg))return!1;if(t){const r=e.tr,o=wg(e.schema).cell.createAndFill().content;n.forEachCell((e,t)=>{e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new Hr(o,0,0))}),r.docChanged&&t(r)}return!0}function Ig(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function Rg(e,t){return(n,r,o)=>{if(!o)return!1;const i=n.selection;if(i instanceof Eg)return Ig(n,r,$i.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;const s=Lg(o,e,t);if(null==s)return!1;if("horiz"==e)return Ig(n,r,$i.near(n.doc.resolve(i.head+t),t));{const o=n.doc.resolve(s),i=Ng(o,e,t);let a;return a=i?$i.near(i,1):t<0?$i.near(n.doc.resolve(o.before(-1)),-1):$i.near(n.doc.resolve(o.after(-1)),1),Ig(n,r,a)}}}function Pg(e,t){return(n,r,o)=>{if(!o)return!1;const i=n.selection;let s;if(i instanceof Eg)s=i;else{const r=Lg(o,e,t);if(null==r)return!1;s=new Eg(n.doc.resolve(r))}const a=Ng(s.$headCell,e,t);return!!a&&Ig(n,r,new Eg(s.$anchorCell,a))}}function Lg(e,t,n){if(!(e.state.selection instanceof Ui))return null;const{$head:r}=e.state.selection;for(let o=r.depth-1;o>=0;o--){const i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){const i=r.before(o),s="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(s)?i:null}}return null}new ss("fix-tables"),Ag("row",{useDeprecatedLogic:!0}),Ag("column",{useDeprecatedLogic:!0}),Ag("cell",{useDeprecatedLogic:!0}),rd({ArrowLeft:Rg("horiz",-1),ArrowRight:Rg("horiz",1),ArrowUp:Rg("vert",-1),ArrowDown:Rg("vert",1),"Shift-ArrowLeft":Pg("horiz",-1),"Shift-ArrowRight":Pg("horiz",1),"Shift-ArrowUp":Pg("vert",-1),"Shift-ArrowDown":Pg("vert",1),Backspace:Dg,"Mod-Backspace":Dg,Delete:Dg,"Mod-Delete":Dg}),new ss("tableColumnResizing");var $g=class{constructor({editor:e,element:t,view:n,updateDelay:r=250,resizeDelay:o=60,shouldShow:i,appendTo:s,getReferencedVirtualElement:a,options:l}){var c;this.preventHide=!1,this.isVisible=!1,this.scrollTarget=window,this.floatingUIOptions={strategy:"absolute",placement:"top",offset:8,flip:{},shift:{},arrow:!1,size:!1,autoPlacement:!1,hide:!1,inline:!1,onShow:void 0,onHide:void 0,onUpdate:void 0,onDestroy:void 0},this.shouldShow=({view:e,state:t,from:n,to:r})=>{const{doc:o,selection:i}=t,{empty:s}=i,a=!o.textBetween(n,r).length&&Od(t.selection),l=this.element.contains(document.activeElement);return!(!e.hasFocus()&&!l||s||a||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.resizeHandler=()=>{this.resizeDebounceTimer&&clearTimeout(this.resizeDebounceTimer),this.resizeDebounceTimer=window.setTimeout(()=>{this.updatePosition()},this.resizeDelay)},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;this.editor.isDestroyed?this.destroy():this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null==(t=this.element.parentNode)?void 0:t.contains(e.relatedTarget))||(null==e?void 0:e.relatedTarget)!==this.editor.view.dom&&this.hide()},this.handleDebouncedUpdate=(e,t)=>{const n=!(null==t?void 0:t.selection.eq(e.state.selection)),r=!(null==t?void 0:t.doc.eq(e.state.doc));(n||r)&&(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(e,n,r,t)},this.updateDelay))},this.updateHandler=(e,t,n,r)=>{const{composing:o}=e;if(o||!t&&!n)return;this.getShouldShow(r)?(this.updatePosition(),this.show()):this.hide()},this.transactionHandler=({transaction:e})=>{"updatePosition"===e.getMeta("bubbleMenu")&&this.updatePosition()},this.editor=e,this.element=t,this.view=n,this.updateDelay=r,this.resizeDelay=o,this.appendTo=s,this.scrollTarget=null!=(c=null==l?void 0:l.scrollTarget)?c:window,this.getReferencedVirtualElement=a,this.floatingUIOptions={...this.floatingUIOptions,...l},this.element.tabIndex=0,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.editor.on("transaction",this.transactionHandler),window.addEventListener("resize",this.resizeHandler),this.scrollTarget.addEventListener("scroll",this.resizeHandler),this.update(n,n.state),this.getShouldShow()&&(this.show(),this.updatePosition())}get middlewares(){const e=[];return this.floatingUIOptions.flip&&e.push(F("boolean"!=typeof this.floatingUIOptions.flip?this.floatingUIOptions.flip:void 0)),this.floatingUIOptions.shift&&e.push(B("boolean"!=typeof this.floatingUIOptions.shift?this.floatingUIOptions.shift:void 0)),this.floatingUIOptions.offset&&e.push(U("boolean"!=typeof this.floatingUIOptions.offset?this.floatingUIOptions.offset:void 0)),this.floatingUIOptions.arrow&&e.push(V(this.floatingUIOptions.arrow)),this.floatingUIOptions.size&&e.push(_("boolean"!=typeof this.floatingUIOptions.size?this.floatingUIOptions.size:void 0)),this.floatingUIOptions.autoPlacement&&e.push(H("boolean"!=typeof this.floatingUIOptions.autoPlacement?this.floatingUIOptions.autoPlacement:void 0)),this.floatingUIOptions.hide&&e.push(W("boolean"!=typeof this.floatingUIOptions.hide?this.floatingUIOptions.hide:void 0)),this.floatingUIOptions.inline&&e.push(q("boolean"!=typeof this.floatingUIOptions.inline?this.floatingUIOptions.inline:void 0)),e}get virtualElement(){var e;const{selection:t}=this.editor.state,n=null==(e=this.getReferencedVirtualElement)?void 0:e.call(this);if(n)return n;const r=Hu(this.view,t.from,t.to);let o={getBoundingClientRect:()=>r,getClientRects:()=>[r]};if(t instanceof _i){let e=this.view.nodeDOM(t.from);const n=e.dataset.nodeViewWrapper?e:e.querySelector("[data-node-view-wrapper]");n&&(e=n),e&&(o={getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>[e.getBoundingClientRect()]})}if(t instanceof Eg){const{$anchorCell:e,$headCell:n}=t,r=e?e.pos:n.pos,i=n?n.pos:e.pos,s=this.view.nodeDOM(r),a=this.view.nodeDOM(i);if(!s||!a)return;const l=s===a?s.getBoundingClientRect():function(e,t){const n=Math.min(e.top,t.top),r=Math.max(e.bottom,t.bottom),o=Math.min(e.left,t.left),i=Math.max(e.right,t.right);return new DOMRect(o,n,i-o,r-n)}(s.getBoundingClientRect(),a.getBoundingClientRect());o={getBoundingClientRect:()=>l,getClientRects:()=>[l]}}return o}updatePosition(){const e=this.virtualElement;e&&K(e,this.element,{placement:this.floatingUIOptions.placement,strategy:this.floatingUIOptions.strategy,middleware:this.middlewares}).then(({x:e,y:t,strategy:n})=>{this.element.style.width="max-content",this.element.style.position=n,this.element.style.left=`${e}px`,this.element.style.top=`${t}px`,this.isVisible&&this.floatingUIOptions.onUpdate&&this.floatingUIOptions.onUpdate()})}update(e,t){const{state:n}=e,r=n.selection.from!==n.selection.to;if(this.updateDelay>0&&r)return void this.handleDebouncedUpdate(e,t);const o=!(null==t?void 0:t.selection.eq(e.state.selection)),i=!(null==t?void 0:t.doc.eq(e.state.doc));this.updateHandler(e,o,i,t)}getShouldShow(e){var t;const{state:n}=this.view,{selection:r}=n,{ranges:o}=r,i=Math.min(...o.map(e=>e.$from.pos)),s=Math.max(...o.map(e=>e.$to.pos));return(null==(t=this.shouldShow)?void 0:t.call(this,{editor:this.editor,element:this.element,view:this.view,state:n,oldState:e,from:i,to:s}))||!1}show(){var e;if(this.isVisible)return;this.element.style.visibility="visible",this.element.style.opacity="1";const t="function"==typeof this.appendTo?this.appendTo():this.appendTo;null==(e=null!=t?t:this.view.dom.parentElement)||e.appendChild(this.element),this.floatingUIOptions.onShow&&this.floatingUIOptions.onShow(),this.isVisible=!0}hide(){this.isVisible&&(this.element.style.visibility="hidden",this.element.style.opacity="0",this.element.remove(),this.floatingUIOptions.onHide&&this.floatingUIOptions.onHide(),this.isVisible=!1)}destroy(){this.hide(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),window.removeEventListener("resize",this.resizeHandler),this.scrollTarget.removeEventListener("scroll",this.resizeHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler),this.editor.off("transaction",this.transactionHandler),this.floatingUIOptions.onDestroy&&this.floatingUIOptions.onDestroy()}},zg=e=>new ns({key:"string"==typeof e.pluginKey?new ss(e.pluginKey):e.pluginKey,view:t=>new $g({view:t,...e})});Sh.create({name:"bubbleMenu",addOptions:()=>({element:null,pluginKey:"bubbleMenu",updateDelay:void 0,appendTo:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[zg({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,updateDelay:this.options.updateDelay,options:this.options.options,appendTo:this.options.appendTo,getReferencedVirtualElement:this.options.getReferencedVirtualElement,shouldShow:this.options.shouldShow})]:[]}});var Fg=class{constructor({editor:e,element:t,view:n,options:r,appendTo:o,shouldShow:i}){this.preventHide=!1,this.isVisible=!1,this.shouldShow=({view:e,state:t})=>{const{selection:n}=t,{$anchor:r,empty:o}=n,i=1===r.depth,s=r.parent.isTextblock&&!r.parent.type.spec.code&&!r.parent.textContent&&0===r.parent.childCount&&!this.getTextContent(r.parent);return!!(e.hasFocus()&&o&&i&&s&&this.editor.isEditable)},this.floatingUIOptions={strategy:"absolute",placement:"right",offset:8,flip:{},shift:{},arrow:!1,size:!1,autoPlacement:!1,hide:!1,inline:!1},this.updateHandler=(e,t,n,r)=>{const{composing:o}=e;if(o||!t&&!n)return;this.getShouldShow(r)?(this.updatePosition(),this.show()):this.hide()},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null==(t=this.element.parentNode)?void 0:t.contains(e.relatedTarget))||(null==e?void 0:e.relatedTarget)!==this.editor.view.dom&&this.hide()},this.editor=e,this.element=t,this.view=n,this.appendTo=o,this.floatingUIOptions={...this.floatingUIOptions,...r},this.element.tabIndex=0,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.update(n,n.state),this.getShouldShow()&&(this.show(),this.updatePosition())}getTextContent(e){return Du(e,{textSerializers:Iu(this.editor.schema)})}get middlewares(){const e=[];return this.floatingUIOptions.flip&&e.push(F("boolean"!=typeof this.floatingUIOptions.flip?this.floatingUIOptions.flip:void 0)),this.floatingUIOptions.shift&&e.push(B("boolean"!=typeof this.floatingUIOptions.shift?this.floatingUIOptions.shift:void 0)),this.floatingUIOptions.offset&&e.push(U("boolean"!=typeof this.floatingUIOptions.offset?this.floatingUIOptions.offset:void 0)),this.floatingUIOptions.arrow&&e.push(V(this.floatingUIOptions.arrow)),this.floatingUIOptions.size&&e.push(_("boolean"!=typeof this.floatingUIOptions.size?this.floatingUIOptions.size:void 0)),this.floatingUIOptions.autoPlacement&&e.push(H("boolean"!=typeof this.floatingUIOptions.autoPlacement?this.floatingUIOptions.autoPlacement:void 0)),this.floatingUIOptions.hide&&e.push(W("boolean"!=typeof this.floatingUIOptions.hide?this.floatingUIOptions.hide:void 0)),this.floatingUIOptions.inline&&e.push(q("boolean"!=typeof this.floatingUIOptions.inline?this.floatingUIOptions.inline:void 0)),e}getShouldShow(e){var t;const{state:n}=this.view,{selection:r}=n,{ranges:o}=r,i=Math.min(...o.map(e=>e.$from.pos)),s=Math.max(...o.map(e=>e.$to.pos));return null==(t=this.shouldShow)?void 0:t.call(this,{editor:this.editor,view:this.view,state:n,oldState:e,from:i,to:s})}updatePosition(){const{selection:e}=this.editor.state,t=Hu(this.view,e.from,e.to);K({getBoundingClientRect:()=>t,getClientRects:()=>[t]},this.element,{placement:this.floatingUIOptions.placement,strategy:this.floatingUIOptions.strategy,middleware:this.middlewares}).then(({x:e,y:t,strategy:n})=>{this.element.style.width="max-content",this.element.style.position=n,this.element.style.left=`${e}px`,this.element.style.top=`${t}px`,this.isVisible&&this.floatingUIOptions.onUpdate&&this.floatingUIOptions.onUpdate()})}update(e,t){const n=!(null==t?void 0:t.selection.eq(e.state.selection)),r=!(null==t?void 0:t.doc.eq(e.state.doc));this.updateHandler(e,n,r,t)}show(){var e;if(this.isVisible)return;this.element.style.visibility="visible",this.element.style.opacity="1";const t="function"==typeof this.appendTo?this.appendTo():this.appendTo;null==(e=null!=t?t:this.view.dom.parentElement)||e.appendChild(this.element),this.floatingUIOptions.onShow&&this.floatingUIOptions.onShow(),this.isVisible=!0}hide(){this.isVisible&&(this.element.style.visibility="hidden",this.element.style.opacity="0",this.element.remove(),this.floatingUIOptions.onHide&&this.floatingUIOptions.onHide(),this.isVisible=!1)}destroy(){this.hide(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler),this.floatingUIOptions.onDestroy&&this.floatingUIOptions.onDestroy()}},Bg=e=>new ns({key:"string"==typeof e.pluginKey?new ss(e.pluginKey):e.pluginKey,view:t=>new Fg({view:t,...e})});Sh.create({name:"floatingMenu",addOptions:()=>({element:null,options:{},pluginKey:"floatingMenu",appendTo:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[Bg({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,options:this.options.options,appendTo:this.options.appendTo,shouldShow:this.options.shouldShow})]:[]}});var Ug=n.forwardRef(({pluginKey:t="bubbleMenu",editor:n,updateDelay:r,resizeDelay:o,appendTo:i,shouldShow:s=null,getReferencedVirtualElement:a,options:l,children:c,...d},u)=>{const h=e.useRef(document.createElement("div"));"function"==typeof u?u(h.current):u&&(u.current=h.current);const{editor:p}=gp(),f=n||p,m={updateDelay:r,resizeDelay:o,appendTo:i,pluginKey:t,shouldShow:s,getReferencedVirtualElement:a,options:l},g=e.useRef(m);return g.current=m,e.useEffect(()=>{if(null==f?void 0:f.isDestroyed)return;if(!f)return;const e=h.current;e.style.visibility="hidden",e.style.position="absolute";const t=zg({...g.current,editor:f,element:e});f.registerPlugin(t);const n=g.current.pluginKey;return()=>{f.unregisterPlugin(n),window.requestAnimationFrame(()=>{e.parentNode&&e.parentNode.removeChild(e)})}},[f]),J.createPortal(T.jsx("div",{...d,children:c}),h.current)});n.forwardRef(({pluginKey:t="floatingMenu",editor:n,appendTo:r,shouldShow:o=null,options:i,children:s,...a},l)=>{const c=e.useRef(document.createElement("div"));"function"==typeof l?l(c.current):l&&(l.current=c.current);const{editor:d}=gp();return e.useEffect(()=>{const e=c.current;if(e.style.visibility="hidden",e.style.position="absolute",(null==n?void 0:n.isDestroyed)||(null==d?void 0:d.isDestroyed))return;const s=n||d;if(!s)return;const a=Bg({editor:s,element:e,pluginKey:t,appendTo:r,shouldShow:o,options:i});return s.registerPlugin(a),()=>{s.unregisterPlugin(t),window.requestAnimationFrame(()=>{e.parentNode&&e.parentNode.removeChild(e)})}},[n,d,r,t,o,i]),J.createPortal(T.jsx("div",{...a,children:s}),c.current)});const Vg=({isOpen:t,onClose:n,onInsert:r,onRemove:o,initialText:i="",initialUrl:s="",isEditMode:a=!1})=>{const[l,c]=e.useState(i),[d,u]=e.useState(s),[h,p]=e.useState("");e.useEffect(()=>{t&&(c(i),u(s),p(""))},[t,i,s]);const f=()=>{if(!l.trim())return;if(!((e=d).trim()?/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/i.test(e)?(p(""),1):(p("Please enter a valid URL (e.g., https://example.com)"),0):(p("URL is required"),0)))return;var e;let t=d.trim();/^https?:\/\//i.test(t)||(t=`https://${t}`),r(l.trim()||t,t),n()};if(!t)return null;const m=l.trim()&&d.trim()?`[${l.trim()}](${d.trim()})`:"";return T.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:n,children:T.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl max-w-md w-full",onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),f()):"Escape"===e.key&&n()},children:[T.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:a?"Edit Link":"Insert Link"}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{children:[T.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Link Text",T.jsx("span",{className:"text-gray-500 font-normal ml-1",children:"(what users will see)"})]}),T.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"e.g., Visit our website",className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",autoFocus:!0})]}),T.jsxs("div",{children:[T.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["URL",T.jsx("span",{className:"text-red-500",children:"*"})]}),T.jsx("input",{type:"text",value:d,onChange:e=>{u(e.target.value),p("")},placeholder:"e.g., https://example.com",className:`w-full border ${h?"border-red-500":"border-gray-300"} rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all`}),h&&T.jsx("p",{className:"text-red-500 text-sm mt-1",children:h})]}),m&&T.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[T.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Preview (markdown):"}),T.jsx("code",{className:"text-sm text-gray-800 break-all",children:m})]})]}),T.jsxs("div",{className:"flex gap-3 mt-6",children:[T.jsx("button",{onClick:f,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition-all duration-200",children:a?"Update Link":"Insert Link"}),a&&o&&T.jsx("button",{onClick:()=>{o(),n()},className:"px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all duration-200",title:"Remove Link",children:"Remove"}),T.jsx("button",{onClick:n,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all duration-200",children:"Cancel"})]})]})})},_g=({editor:t})=>{const[n,r]=e.useState(!1),[o,i]=e.useState(null);return T.jsxs(T.Fragment,{children:[T.jsxs(Ug,{editor:t,options:{placement:"top",offset:8},id:"tour-bubble-menu",className:"bubble-menu bg-white rounded-lg shadow-lg border border-gray-200 p-1 flex items-center gap-0.5 z-50",children:[T.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleBold().run(),className:"p-2 rounded transition-all hover:bg-gray-100 "+(t.isActive("bold")?"bg-blue-100 text-blue-700":"text-gray-700"),title:"Bold (Ctrl+B)",children:T.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2.5,children:[T.jsx("path",{d:"M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"}),T.jsx("path",{d:"M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"})]})}),T.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleItalic().run(),className:"p-2 rounded transition-all hover:bg-gray-100 "+(t.isActive("italic")?"bg-blue-100 text-blue-700":"text-gray-700"),title:"Italic (Ctrl+I)",children:T.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:[T.jsx("line",{x1:"19",y1:"4",x2:"10",y2:"4"}),T.jsx("line",{x1:"14",y1:"20",x2:"5",y2:"20"}),T.jsx("line",{x1:"15",y1:"4",x2:"9",y2:"20"})]})}),T.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleUnderline().run(),className:"p-2 rounded transition-all hover:bg-gray-100 "+(t.isActive("underline")?"bg-blue-100 text-blue-700":"text-gray-700"),title:"Underline (Ctrl+U)",children:T.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:[T.jsx("path",{d:"M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"}),T.jsx("line",{x1:"4",y1:"21",x2:"20",y2:"21"})]})}),T.jsx("button",{type:"button",onClick:()=>t.chain().focus().toggleStrike().run(),className:"p-2 rounded transition-all hover:bg-gray-100 "+(t.isActive("strike")?"bg-blue-100 text-blue-700":"text-gray-700"),title:"Strikethrough (Ctrl+Shift+S)",children:T.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:T.jsx("path",{d:"M17.3 14c0 1.3-.5 2.3-1.6 3-.9.7-2.2 1-3.7 1-2.8 0-4.8-1.2-6-3.6M6.2 9c0-1.3.6-2.3 1.7-3 1-.7 2.2-1 3.6-1 2.7 0 4.7 1.2 5.9 3.6M4 12h16"})})}),T.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),T.jsx("button",{type:"button",onClick:()=>{const{from:e}=t.state.selection,n=((e,t)=>{const{state:n}=e,{doc:r}=n;try{const e=r.resolve(t),n=e.parent;if(n&&"paragraph"===n.type.name){let r=null,o="",i="";if(n.forEach((n,s)=>{const a=e.start()+s,l=a+n.nodeSize;if(t>=a&&t<=l){const e=(n.marks||[]).find(e=>"link"===e.type.name);e&&n.text&&(r=n,o=n.text,i=e.attrs.href)}}),r&&i)return{text:o,url:i}}}catch(o){}return null})(t,e);i(n||null),r(!0)},className:"p-2 rounded transition-all hover:bg-gray-100 "+(t.isActive("link")?"bg-blue-100 text-blue-700":"text-blue-600"),title:"Insert Link (Ctrl+K)",children:T.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]}),T.jsx(Vg,{isOpen:n,onClose:()=>{r(!1),i(null)},onInsert:(e,n)=>{if(o)t.chain().focus().extendMarkRange("link").unsetLink().insertContent(e).setLink({href:n}).run();else{const{from:r,to:o}=t.state.selection;t.state.doc.textBetween(r,o," ")?t.chain().focus().setLink({href:n}).run():t.chain().focus().insertContent(`<a href="${n}">${e}</a> `).run()}i(null),r(!1)},onRemove:o?()=>{t.chain().focus().extendMarkRange("link").unsetLink().run(),i(null),r(!1)}:void 0,initialText:(null==o?void 0:o.text)||"",initialUrl:(null==o?void 0:o.url)||"",isEditMode:!!o})]})},Hg=({value:t,onChange:n,placeholder:r="",className:o="",disabled:i=!1})=>{const s=fp({extensions:pg(r),content:mg(t),editable:!i,onUpdate:({editor:e})=>{const t=e.getHTML(),r=gg(t);n(r)},editorProps:{attributes:{class:"focus:outline-none",role:"textbox"}}});e.useEffect(()=>{if(s){gg(s.getHTML())!==t&&s.commands.setContent(mg(t))}},[t,s]);const a=o||"w-full border border-gray-300 rounded-lg p-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200 min-h-[44px]";return T.jsx("div",{className:"relative",children:T.jsxs("div",{className:`${a} relative`,children:[T.jsx(lp,{editor:s}),s&&T.jsx(_g,{editor:s})]})})},Wg=({sectionName:t,experiences:n,onUpdate:r,onTitleEdit:o,onTitleSave:i,onTitleCancel:s,onDelete:a,onDeleteEntry:l,isEditingTitle:c,temporaryTitle:d,setTemporaryTitle:u,supportsIcons:h=!1,iconRegistry:p})=>{const[f,m]=e.useState(()=>"undefined"!=typeof window&&window.innerWidth<1024);e.useEffect(()=>{const e=()=>{window.innerWidth>=1024&&f&&m(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[f]);const g=(e,t,o)=>{const i=[...n];i[e]={...i[e],[t]:o},r(i)};return T.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 sm:p-8 mb-8 border border-gray-200",children:[T.jsx(Er,{title:t,isEditing:c,temporaryTitle:d,onTitleEdit:o,onTitleSave:i,onTitleCancel:s,onTitleChange:u,onDelete:a,showHint:t.startsWith("New "),isCollapsed:f,onToggleCollapse:()=>{m(!f)}}),!f&&n.map((e,t)=>T.jsxs("div",{className:"bg-gray-50/80 backdrop-blur-sm p-6 mb-6 rounded-xl border border-gray-200 shadow-md",children:[T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsxs("h3",{className:"text-lg font-medium",children:["Experience #",t+1]}),T.jsx("button",{onClick:()=>{if(l)l(t);else{const e=[...n];e.splice(t,1),r(e)}},className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Delete experience entry",title:"Delete this experience",children:T.jsx(Y,{className:"text-xl"})})]}),T.jsxs("div",{className:"mt-4",children:[h&&p&&T.jsx("div",{className:"mb-4",children:T.jsx(Nr,{value:e.icon||null,onChange:(e,o)=>((e,t,o)=>{const i=[...n];i[e]={...i[e],icon:t,iconFile:o,iconBase64:null},r(i)})(t,e,o),registerIcon:p.registerIcon,getIconFile:p.getIconFile,removeIcon:p.removeIcon})}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Company"}),T.jsx(Hg,{value:e.company,onChange:e=>g(t,"company",e),placeholder:"Enter company name",className:"w-full border border-gray-300 rounded-lg p-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Title"}),T.jsx(Hg,{value:e.title,onChange:e=>g(t,"title",e),placeholder:"Enter job title",className:"w-full border border-gray-300 rounded-lg p-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Dates"}),T.jsx("input",{type:"text",value:e.dates,onChange:e=>g(t,"dates",e.target.value),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"e.g., Jan 2020 - Present"})]})]}),T.jsxs("div",{className:"w-full",children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Job Description & Achievements"}),T.jsx(Mr,{}),T.jsx("div",{className:"space-y-3 mt-2",children:e.description.map((e,o)=>T.jsxs("div",{className:"flex items-start gap-3",children:[T.jsx("div",{className:"flex-1",children:T.jsx(Hg,{value:e,onChange:e=>{const i=[...n];i[t].description[o]=e,r(i)},placeholder:"Describe your responsibilities, achievements, or key projects...",className:"w-full border border-gray-300 rounded-lg p-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200"})}),T.jsx("button",{onClick:()=>{const e=[...n];e[t].description.splice(o,1),r(e)},className:"text-red-600 hover:text-red-800 p-2 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0 mt-2",title:"Remove description point",children:"âœ•"})]},o))}),T.jsx("button",{onClick:()=>{const e=[...n];e[t].description.push(""),r(e)},className:"mt-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-lg font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2",children:"+ Add Description Point"})]})]})]},t)),!f&&T.jsx("button",{onClick:()=>{r([...n,{company:"",title:"",dates:"",description:[],icon:null,iconFile:null,iconBase64:null}])},className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2",children:"Add Experience"})]})},qg=({sectionName:t,education:n,onUpdate:r,onTitleEdit:o,onTitleSave:i,onTitleCancel:s,onDelete:a,onDeleteEntry:l,isEditingTitle:c,temporaryTitle:d,setTemporaryTitle:u,supportsIcons:h=!1,iconRegistry:p})=>{const[f,m]=e.useState(()=>"undefined"!=typeof window&&window.innerWidth<1024);e.useEffect(()=>{const e=()=>{window.innerWidth>=1024&&f&&m(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[f]);const g=(e,t,o)=>{const i=[...n];i[e]={...i[e],[t]:o},r(i)};return T.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 sm:p-8 mb-8 border border-gray-200",children:[T.jsx(Er,{title:t,isEditing:c,temporaryTitle:d,onTitleEdit:o,onTitleSave:i,onTitleCancel:s,onTitleChange:u,onDelete:a,showHint:t.startsWith("New "),isCollapsed:f,onToggleCollapse:()=>{m(!f)}}),!f&&T.jsx(Mr,{className:"mb-4"}),!f&&n.map((e,t)=>T.jsxs("div",{className:"bg-gray-50/80 backdrop-blur-sm p-6 mb-6 rounded-xl border border-gray-200 shadow-md",children:[T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsxs("h3",{className:"text-lg font-semibold",children:["Entry ",t+1]}),T.jsx("button",{onClick:()=>(e=>{if(l)l(e);else{const t=[...n];t.splice(e,1),r(t)}})(t),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Delete education entry",title:"Delete this entry",children:T.jsx(Y,{className:"text-xl"})})]}),T.jsxs("div",{className:"mt-4",children:[h&&p&&T.jsx("div",{className:"mb-4",children:T.jsx(Nr,{value:e.icon||null,onChange:(e,o)=>((e,t,o)=>{const i=[...n];i[e]={...i[e],icon:t,iconFile:o,iconBase64:null},r(i)})(t,e,o),registerIcon:p.registerIcon,getIconFile:p.getIconFile,removeIcon:p.removeIcon})}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Degree"}),T.jsx(Hg,{value:e.degree,onChange:e=>g(t,"degree",e),placeholder:"e.g., Bachelor of Science",className:"w-full border border-gray-300 rounded-lg p-2"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"School"}),T.jsx(Hg,{value:e.school,onChange:e=>g(t,"school",e),placeholder:"e.g., University Name",className:"w-full border border-gray-300 rounded-lg p-2"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Year"}),T.jsx("input",{type:"text",value:e.year,onChange:e=>g(t,"year",e.target.value),className:"w-full border border-gray-300 rounded-lg p-2"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Field of Study"}),T.jsx(Hg,{value:e.field_of_study||"",onChange:e=>g(t,"field_of_study",e),placeholder:"e.g., Computer Science",className:"w-full border border-gray-300 rounded-lg p-2"})]})]})]})]},t)),!f&&T.jsx("button",{onClick:()=>{r([...n,{degree:"",school:"",year:"",field_of_study:"",icon:null,iconFile:null,iconBase64:null}])},className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2 mt-4",children:"Add Entry"})]})},Kg=({value:t,onChange:n,placeholder:r="",className:o="",rows:i=4,disabled:s=!1})=>{const a=fp({extensions:fg(r),content:mg(t),editable:!s,onUpdate:({editor:e})=>{const t=e.getHTML(),r=gg(t);n(r)},editorProps:{attributes:{class:"focus:outline-none prose prose-sm max-w-none",role:"textbox"}}});e.useEffect(()=>{if(a){gg(a.getHTML())!==t&&a.commands.setContent(mg(t))}},[t,a]);const l=o||"w-full border border-gray-300 rounded-lg p-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200",c=24*i+24+"px";return T.jsx("div",{className:"relative",children:T.jsxs("div",{className:`${l} relative`,style:{minHeight:c},children:[T.jsx(lp,{editor:a}),a&&T.jsx(_g,{editor:a})]})})},Jg=({section:t,onUpdate:n,onEditTitle:r,onSaveTitle:o,onCancelTitle:i,onDelete:s,onDeleteEntry:a,isEditing:l,temporaryTitle:c,setTemporaryTitle:d})=>{const[u,h]=e.useState(!0),[p,f]=e.useState(()=>"undefined"!=typeof window&&window.innerWidth<1024);e.useEffect(()=>{if(t.name.startsWith("New ")){const e=setTimeout(()=>{h(!1)},5e3);return()=>clearTimeout(e)}h(!1)},[t.name]),e.useEffect(()=>{const e=()=>{window.innerWidth>=1024&&p&&f(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[p]);const m=(e,r)=>{if(Array.isArray(t.content)){const o=[...t.content];void 0!==r?o[r]=e:o.push(e),n({...t,content:o})}else n({...t,content:e})},g=e=>{if(a)a(e);else{const r=t.content.filter((t,n)=>n!==e);n({...t,content:r})}};return T.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 sm:p-8 mb-8 border border-gray-200",children:[T.jsxs("div",{className:"flex items-center justify-between mb-4",children:[T.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[T.jsx("button",{onClick:()=>{f(!p)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors","aria-label":p?"Expand section":"Collapse section",title:p?"Expand section":"Collapse section",children:p?T.jsx(D,{className:"text-2xl"}):T.jsx(A,{className:"text-2xl"})}),l?T.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[T.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),className:"border border-gray-300 rounded-lg p-2 w-full text-xl font-semibold",autoFocus:!0}),T.jsx("button",{onClick:o,className:"text-green-600 hover:text-green-800",title:"Save Title",children:"âœ…"}),T.jsx("button",{onClick:i,className:"text-red-600 hover:text-red-800",title:"Cancel",children:"âœ•"})]}):T.jsxs("h2",{className:"text-xl font-semibold "+(t.name.startsWith("New ")?"text-gray-500 italic":""),children:[t.name,T.jsx("button",{onClick:r,className:"ml-2 text-gray-500 hover:text-gray-700",title:"Edit Title",children:"âœï¸"}),t.name.startsWith("New ")&&u&&T.jsx("span",{className:"ml-2 text-sm text-blue-500 font-normal",children:"(Click âœï¸ to rename)"})]})]}),T.jsx("button",{onClick:s,className:"bg-red-500 text-white px-3 py-1 rounded-lg",title:"Remove Section",children:"Remove"})]}),!p&&T.jsxs("div",{className:"mt-4",children:["text"===t.type&&T.jsxs(T.Fragment,{children:[T.jsx(Mr,{className:"mb-2"}),T.jsx(Kg,{value:t.content||"",onChange:e=>m(e),placeholder:"Enter text...",className:"w-full border border-gray-300 rounded-lg p-2 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200",rows:4})]}),"bulleted-list"===t.type&&T.jsxs(T.Fragment,{children:[T.jsx(Mr,{className:"mb-2"}),Array.isArray(t.content)&&t.content.map((e,t)=>T.jsx("div",{className:"mb-4",children:T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"flex-1",children:T.jsx(Hg,{value:e,onChange:e=>m(e,t),placeholder:"Add item...",className:"w-full border border-gray-300 rounded-lg p-2 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200"})}),T.jsx("button",{onClick:()=>g(t),className:"text-red-600 hover:text-red-800 flex-shrink-0",title:"Remove Item",children:"âœ•"})]})},t)),T.jsx("button",{onClick:()=>{const e=[...t.content||[],""];n({...t,content:e})},className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2 mt-2",children:"Add Item"})]}),"inline-list"===t.type&&T.jsxs(T.Fragment,{children:[T.jsx(Mr,{className:"mb-2"}),T.jsx("div",{className:"space-y-2 mb-4",children:Array.isArray(t.content)&&t.content.map((e,t)=>T.jsx("div",{children:T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"flex-1",children:T.jsx(Hg,{value:e,onChange:e=>m(e,t),placeholder:"Add skill or item...",className:"w-full border border-gray-300 rounded-lg p-2 text-sm focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200"})}),T.jsx("button",{onClick:()=>g(t),className:"text-red-500 hover:text-red-700 text-sm flex-shrink-0",title:"Remove Item",children:"âœ•"})]})},t))}),T.jsx("button",{onClick:()=>{const e=[...t.content||[],""];n({...t,content:e})},className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2 text-sm",children:"Add Item"})]}),"dynamic-column-list"===t.type&&T.jsxs(T.Fragment,{children:[T.jsx(Mr,{className:"mb-2"}),T.jsx("div",{className:"space-y-2 mb-4",children:Array.isArray(t.content)&&t.content.map((e,t)=>T.jsx("div",{children:T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"flex-1",children:T.jsx(Hg,{value:e,onChange:e=>m(e,t),placeholder:"Add item...",className:"w-full border border-gray-300 rounded-lg p-2 text-sm focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all duration-200"})}),T.jsx("button",{onClick:()=>g(t),className:"text-red-500 hover:text-red-700 text-sm flex-shrink-0",title:"Remove Item",children:"âœ•"})]})},t))}),T.jsx("button",{onClick:()=>{const e=[...t.content||[],""];n({...t,content:e})},className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2 text-sm",children:"Add Item"})]})]})]})},Yg=({data:t,onUpdate:n,onDelete:r,onDeleteEntry:o,sectionName:i="Certifications",onEditTitle:s,onSaveTitle:a,onCancelTitle:l,isEditing:c=!1,temporaryTitle:d="",setTemporaryTitle:u,iconRegistry:h})=>{const[p,f]=e.useState(!0),[m,g]=e.useState(()=>"undefined"!=typeof window&&window.innerWidth<1024);e.useEffect(()=>{if(i.startsWith("New ")){const e=setTimeout(()=>{f(!1)},5e3);return()=>clearTimeout(e)}f(!1)},[i]),e.useEffect(()=>{const e=()=>{window.innerWidth>=1024&&m&&g(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[m]);const b=(e,r,o)=>{const i=[...t];i[e]={...i[e],[r]:o},n(i)};return T.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 sm:p-8 mb-8 border border-gray-200",children:[T.jsxs("div",{className:"flex justify-between items-center mb-4",children:[T.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[T.jsx("button",{onClick:()=>{g(!m)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors","aria-label":m?"Expand section":"Collapse section",title:m?"Expand section":"Collapse section",children:m?T.jsx(D,{className:"text-2xl"}):T.jsx(A,{className:"text-2xl"})}),c?T.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[T.jsx("input",{type:"text",value:d,onChange:e=>null==u?void 0:u(e.target.value),className:"border border-gray-300 rounded-lg p-2 w-full text-xl font-semibold",autoFocus:!0}),T.jsx("button",{onClick:a,className:"text-green-600 hover:text-green-800",title:"Save Title",children:"âœ…"}),T.jsx("button",{onClick:l,className:"text-red-600 hover:text-red-800",title:"Cancel",children:"âœ•"})]}):T.jsxs("h2",{className:"text-xl font-semibold "+(i.startsWith("New ")?"text-gray-500 italic":""),children:[i,s&&T.jsx("button",{onClick:s,className:"ml-2 text-gray-500 hover:text-gray-700",title:"Edit Title",children:"âœï¸"}),i.startsWith("New ")&&p&&T.jsx("span",{className:"ml-2 text-sm text-blue-500 font-normal",children:"(Click âœï¸ to rename)"})]})]}),r&&T.jsx("button",{onClick:r,className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600",children:"Remove"})]}),!m&&t.length>0?t.map((e,r)=>T.jsx("div",{className:"bg-gray-50/80 backdrop-blur-sm p-6 mb-6 rounded-xl border border-gray-200 shadow-md",children:T.jsxs("div",{children:[h&&T.jsx("div",{className:"mb-4",children:T.jsx(Nr,{value:e.icon||null,onChange:(e,o)=>((e,r,o)=>{const i=[...t];i[e]={...i[e],icon:r,iconFile:o,iconBase64:null},n(i)})(r,e,o),registerIcon:h.registerIcon,getIconFile:h.getIconFile,removeIcon:h.removeIcon})}),T.jsxs("div",{children:[T.jsx(Mr,{className:"mb-2"}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Certification"}),T.jsx(Hg,{value:e.certification,onChange:e=>b(r,"certification",e),placeholder:"e.g., AWS Certified Solutions Architect",className:"w-full border border-gray-300 rounded-lg p-2"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Issuer"}),T.jsx(Hg,{value:e.issuer,onChange:e=>b(r,"issuer",e),placeholder:"e.g., Amazon Web Services",className:"w-full border border-gray-300 rounded-lg p-2"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Date"}),T.jsx(Hg,{value:e.date,onChange:e=>b(r,"date",e),placeholder:"e.g., 2024",className:"w-full border border-gray-300 rounded-lg p-2"})]})]}),T.jsx("div",{className:"flex justify-end mt-4",children:T.jsx("button",{onClick:()=>(e=>{if(o)o(e);else{const r=t.filter((t,n)=>n!==e);n(r)}})(r),className:"text-red-600 hover:text-red-800 text-lg",title:"Remove Certification",children:"âœ•"})})]})]})},r)):null,!m&&T.jsx("button",{onClick:()=>{n([...t,{certification:"",issuer:"",date:"",icon:null,iconFile:null,iconBase64:null}])},className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2",children:"Add Item"})]})},Gg=({onClose:e,onSelect:t,supportsIcons:n=!0})=>{const r=[{type:"experience",title:"Experience Section",description:"Structured format for work experience, projects, or any timeline-based entries with company, title, dates, and achievements.",useFor:"Work Experience, Independent Projects, Volunteer Work, Research Experience, Teaching Experience, Consulting Projects"},{type:"education",title:"Education Section",description:"Structured format for academic qualifications with degree, institution, year, and field of study.",useFor:"Education, Certifications, Professional Training, Online Courses, Academic Background, Qualifications"},{type:"text",title:"Text Section",description:"A simple text block for single-paragraph sections.",useFor:"Summary, Objective, About Me, Career Goal, Personal Statement"},{type:"bulleted-list",title:"List with Bullets",description:"Traditional bulleted list format with clear visual separation.",useFor:"Technical Skills, Hobbies, Key Achievements, Certifications, Volunteer Work, Strengths"},{type:"inline-list",title:"Horizontal List",description:"Items displayed in a single row, separated by commas.",useFor:"Key Skills, Software Proficiencies, Technologies, Languages, Personal Interests"},{type:"dynamic-column-list",title:"Smart Table",description:"Automatically arranges items in columns for optimal space usage.",useFor:"Technical Skills, Certifications, Tools, Key Projects, Accomplishments"},{type:"icon-list",title:"Bullet List with Icons",description:"Traditional bulleted list enhanced with visual icons for each item.",useFor:"Certifications, Awards, Professional Memberships, Licenses, Achievements"}],o=n?r:r.filter(e=>"icon-list"!==e.type);return T.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:T.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg max-w-sm sm:max-w-xl w-full",children:[T.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6",children:"Select Section Type"}),T.jsx("div",{className:"space-y-3 sm:space-y-4",children:o.map(e=>T.jsxs("div",{className:"p-3 sm:p-4 border rounded-lg shadow-sm hover:shadow-md cursor-pointer flex flex-col",onClick:()=>t(e.type),children:[T.jsx("h3",{className:"font-semibold text-base sm:text-lg",children:e.title}),T.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-1 sm:mb-2",children:e.description}),T.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 italic",children:[T.jsx("strong",{children:"Use for:"})," ",e.useFor]})]},e.type))}),T.jsx("button",{className:"mt-4 sm:mt-6 bg-red-500 text-white px-4 py-2 rounded-lg w-full",onClick:e,children:"Cancel"})]})})};function Xg({onAddSection:e,onGenerateResume:t,onExportYAML:n,onImportYAML:r,onToggleHelp:o,onLoadEmptyTemplate:i,loadingAddSection:s,generating:a,loadingSave:l,loadingLoad:c,showAdvancedMenu:d,setShowAdvancedMenu:u,mode:h="floating"}){const p="transform transition-all duration-300",f="floating"===h?`${p} hover:-translate-y-0.5 hover:scale-105 shadow-lg hover:shadow-xl`:`${p} hover:scale-105`;return T.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 "+("integrated"===h?"w-full lg:w-auto":""),children:[T.jsxs("div",{className:"relative group",children:[T.jsx("button",{onClick:e,disabled:s,className:`bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-3 sm:p-4 rounded-full border border-blue-500/20 hover:border-blue-400/40 ${f} ${s?"scale-95 opacity-80":""}`,children:s?T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-2 border-white border-t-transparent"}):T.jsx(G,{className:"text-lg sm:text-xl"})}),"floating"===h&&T.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 lg:left-auto lg:right-0 lg:transform-none mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none",children:["Add New Section",T.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 lg:left-auto lg:right-4 lg:transform-none border-4 border-transparent border-t-gray-800"})]})]}),T.jsxs("button",{onClick:t,className:`bg-gradient-to-r from-green-600 to-emerald-600 text-white px-4 sm:px-8 py-3 sm:py-4 rounded-full border border-green-500/20 hover:border-green-400/40 font-semibold text-sm sm:text-lg flex items-center gap-2 sm:gap-3 ${f} ${a?"opacity-75 cursor-not-allowed scale-95":""}`,disabled:a,children:[a?T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-2 border-white border-t-transparent"}):T.jsx(X,{className:"text-lg sm:text-xl"}),T.jsx("span",{className:"hidden sm:inline",children:a?"Creating Your Resume...":"Download My Resume"}),T.jsx("span",{className:"sm:hidden",children:a?"Creating...":"Download"})]}),T.jsxs("div",{className:"relative group advanced-menu-container",children:[T.jsx("button",{onClick:()=>u(!d),className:`bg-gradient-to-r from-gray-600 to-gray-700 text-white p-3 sm:p-4 rounded-full border border-gray-500/20 hover:border-gray-400/40 ${f}`,children:T.jsx(Q,{className:"text-lg sm:text-xl"})}),"floating"===h&&T.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 lg:left-auto lg:right-0 lg:transform-none mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none",children:["Save/Load Work",T.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 lg:left-auto lg:right-4 lg:transform-none border-4 border-transparent border-t-gray-800"})]}),d&&T.jsx("div",{className:"absolute bottom-full mb-4 left-1/2 transform -translate-x-1/2 lg:left-auto lg:right-0 lg:transform-none w-48 sm:w-56 bg-white/95 backdrop-blur-sm rounded-xl shadow-xl border border-gray-200 z-[9999] max-w-[90vw]",children:T.jsxs("div",{className:"p-2",children:[T.jsxs("button",{onClick:()=>{n(),u(!1)},disabled:l,className:"w-full text-left px-3 py-2 text-gray-700 hover:bg-blue-50 rounded-lg transition-all duration-300 flex items-center gap-3 "+(l?"bg-blue-50 cursor-not-allowed animate-pulse":""),children:[l?T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}):T.jsx(Z,{className:"text-blue-600"}),T.jsxs("div",{children:[T.jsx("div",{className:"font-medium",children:l?"Preparing File...":"Save My Work"}),T.jsx("div",{className:"text-xs text-gray-500",children:l?"This will start downloading shortly":"Download to continue later"})]})]}),T.jsxs("label",{className:"w-full text-left px-3 py-2 text-gray-700 hover:bg-green-50 rounded-lg transition-all duration-300 flex items-center gap-3 "+(c?"bg-green-50 cursor-not-allowed animate-pulse":"cursor-pointer"),children:[c?T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-green-600 border-t-transparent"}):T.jsx(ee,{className:"text-green-600"}),T.jsxs("div",{children:[T.jsx("div",{className:"font-medium",children:c?"Processing File...":"Load Previous Work"}),T.jsx("div",{className:"text-xs text-gray-500",children:c?"Reading and validating your resume":"Upload your saved resume"})]}),T.jsx("input",{type:"file",accept:".yaml,.yml",className:"hidden",disabled:c,onChange:e=>{r(e),u(!1)}})]}),T.jsxs("button",{onClick:()=>{o(),u(!1)},className:"w-full text-left px-3 py-2 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors flex items-center gap-3",children:[T.jsx(O,{className:"text-purple-600"}),T.jsxs("div",{children:[T.jsx("div",{className:"font-medium",children:"Help & Tips"}),T.jsx("div",{className:"text-xs text-gray-500",children:"How to save your work"})]})]}),T.jsxs("button",{onClick:()=>{i(),u(!1)},disabled:l,className:"w-full text-left px-3 py-2 text-gray-700 hover:bg-orange-50 rounded-lg transition-all duration-300 flex items-center gap-3 "+(l?"bg-orange-50 cursor-not-allowed animate-pulse":""),children:[l?T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-orange-600 border-t-transparent"}):T.jsx(te,{className:"text-orange-600"}),T.jsxs("div",{children:[T.jsx("div",{className:"font-medium",children:"Clear Template"}),T.jsx("div",{className:"text-xs text-gray-500",children:"Start with empty sections"})]})]})]})})]})]})}const Qg=({onNavigationClick:e,onPreviewClick:t,onDownloadClick:n,isSaving:r=!1,isGenerating:o=!1,isGeneratingPreview:i=!1,previewIsStale:s=!1,lastSaved:a=null,saveError:l=!1})=>T.jsxs("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 shadow-lg",children:[(r||a||l)&&T.jsx("div",{className:"px-4 py-1 bg-gray-50 border-b border-gray-100",children:T.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[r&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),T.jsx("span",{className:"text-gray-600",children:"Saving..."})]}),!r&&a&&!l&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),T.jsxs("span",{className:"text-gray-600",children:["Saved ",(()=>{if(!a)return"";const e=(new Date).getTime()-a.getTime(),t=Math.floor(e/6e4);if(t<1)return"Just now";if(1===t)return"1 min ago";if(t<60)return`${t} mins ago`;const n=Math.floor(t/60);return 1===n?"1 hour ago":`${n} hours ago`})()]})]}),l&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),T.jsx("span",{className:"text-red-600",children:"Save failed - retrying..."})]})]})}),T.jsxs("div",{className:"grid grid-cols-3 gap-3 px-4 py-3 safe-area-inset-bottom",children:[T.jsxs("button",{onClick:e,disabled:o||i,className:"flex flex-col items-center justify-center min-h-[60px] px-3 py-2 rounded-xl transition-all disabled:opacity-50 hover:bg-gray-100 active:bg-gray-200 active:scale-[0.98] border border-gray-200","aria-label":"Open navigation menu",style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx(ne,{className:"text-2xl text-gray-700 mb-1.5","aria-hidden":"true"}),T.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Menu"})]}),t&&T.jsxs("button",{onClick:t,disabled:i||o,className:"flex flex-col items-center justify-center min-h-[60px] px-3 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl shadow-lg transition-all hover:shadow-xl active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed relative","aria-label":"Preview resume PDF",style:{WebkitTapHighlightColor:"transparent"},children:[s&&!i&&T.jsx("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-amber-400 rounded-full border-2 border-white animate-pulse shadow-sm"}),i?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white mb-1.5"}),T.jsx("span",{className:"text-xs font-semibold",children:"Loading..."})]}):T.jsxs(T.Fragment,{children:[T.jsx(re,{className:"text-2xl mb-1.5","aria-hidden":"true"}),T.jsx("span",{className:"text-xs font-semibold",children:"Preview"})]})]}),T.jsx("button",{onClick:n,disabled:o||i,className:"flex flex-col items-center justify-center min-h-[60px] px-3 py-2 bg-gradient-to-r from-emerald-600 to-green-600 text-white rounded-xl shadow-lg transition-all hover:shadow-xl active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Download resume as PDF",style:{WebkitTapHighlightColor:"transparent"},children:o?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white mb-1.5"}),T.jsx("span",{className:"text-xs font-semibold",children:"Creating..."})]}):T.jsxs(T.Fragment,{children:[T.jsx(Z,{className:"text-2xl mb-1.5","aria-hidden":"true"}),T.jsx("span",{className:"text-xs font-semibold",children:"Download"})]})})]}),T.jsx("style",{dangerouslySetInnerHTML:{__html:"\n        .safe-area-inset-bottom {\n          padding-bottom: max(0.5rem, env(safe-area-inset-bottom));\n        }\n      "}})]}),Zg=({isOpen:t,onClose:n,sections:r,onSectionClick:o,activeSectionIndex:i,onAddSection:s,onExportYAML:a,onImportYAML:l,onStartFresh:c,onHelp:d,loadingSave:u=!1,loadingLoad:h=!1})=>{const[p,f]=e.useState(!1);if(!t)return null;const m=e=>{o(e),n()},g=e=>{e(),f(!1),n()};return T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998] lg:hidden transition-opacity duration-200",onClick:n,"aria-hidden":"true"}),T.jsxs("div",{className:"fixed top-0 left-0 bottom-0 w-[280px] max-w-[80vw] bg-white z-[9999] lg:hidden shadow-2xl\r\n          animate-slide-in-left flex flex-col",role:"dialog","aria-modal":"true","aria-label":"Section navigation",children:[T.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-blue-600 to-indigo-600",children:[T.jsxs("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[T.jsx(oe,{className:"text-white/80","aria-hidden":"true"}),"Sections"]}),T.jsx("button",{onClick:n,className:"p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Close navigation",children:T.jsx(ie,{className:"text-2xl"})})]}),T.jsxs("nav",{className:"flex-1 overflow-y-auto p-2",children:[T.jsxs("button",{onClick:()=>m(-1),className:"w-full text-left px-4 py-3 rounded-lg transition-all min-h-[48px] flex items-center gap-3\n              "+(-1===i?"bg-blue-50 border-l-4 border-blue-600 text-blue-900 font-semibold":"hover:bg-gray-100 active:bg-gray-200 text-gray-700"),style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-bold",children:"i"}),T.jsx("span",{className:"flex-1",children:"Contact Information"})]}),r.map((e,t)=>T.jsxs("button",{onClick:()=>m(t),className:"w-full text-left px-4 py-3 rounded-lg transition-all min-h-[48px] flex items-center gap-3 mt-1\n                "+(i===t?"bg-blue-50 border-l-4 border-blue-600 text-blue-900 font-semibold":"hover:bg-gray-100 active:bg-gray-200 text-gray-700"),style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx("span",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center text-xs font-bold",children:t+1}),T.jsx("span",{className:"flex-1 truncate",children:e.name})]},t))]}),T.jsxs("div",{className:"p-3 border-t border-gray-200 bg-gray-50 space-y-2",children:[T.jsxs("button",{onClick:()=>g(s),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg active:scale-95 transition-all min-h-[48px]",style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx(se,{className:"text-xl"}),T.jsx("span",{children:"Add Section"})]}),T.jsxs("div",{className:"relative",children:[T.jsxs("button",{onClick:()=>f(!p),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-white border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 active:bg-gray-100 transition-all min-h-[48px]",style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx(Q,{className:"text-xl"}),T.jsx("span",{children:"More Options"})]}),p&&T.jsxs("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:[T.jsxs("button",{onClick:()=>g(a),disabled:u,className:"w-full text-left px-4 py-3 hover:bg-blue-50 active:bg-blue-100 transition-colors flex items-center gap-3 border-b border-gray-100 disabled:opacity-50",style:{WebkitTapHighlightColor:"transparent"},children:[u?T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}):T.jsx(Z,{className:"text-blue-600 text-xl"}),T.jsxs("div",{className:"flex-1",children:[T.jsx("div",{className:"font-medium text-gray-900",children:u?"Preparing...":"Save My Work"}),T.jsx("div",{className:"text-xs text-gray-500",children:"Download YAML file"})]})]}),T.jsxs("button",{onClick:()=>g(l),disabled:h,className:"w-full text-left px-4 py-3 hover:bg-green-50 active:bg-green-100 transition-colors flex items-center gap-3 border-b border-gray-100 disabled:opacity-50",style:{WebkitTapHighlightColor:"transparent"},children:[h?T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-green-600 border-t-transparent"}):T.jsx(ee,{className:"text-green-600 text-xl"}),T.jsxs("div",{className:"flex-1",children:[T.jsx("div",{className:"font-medium text-gray-900",children:h?"Loading...":"Load My Work"}),T.jsx("div",{className:"text-xs text-gray-500",children:"Upload YAML file"})]})]}),T.jsxs("button",{onClick:()=>g(c),className:"w-full text-left px-4 py-3 hover:bg-orange-50 active:bg-orange-100 transition-colors flex items-center gap-3 border-b border-gray-100",style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx(te,{className:"text-orange-600 text-xl"}),T.jsxs("div",{className:"flex-1",children:[T.jsx("div",{className:"font-medium text-gray-900",children:"Start Fresh"}),T.jsx("div",{className:"text-xs text-gray-500",children:"Clear template"})]})]}),T.jsxs("button",{onClick:()=>g(d),className:"w-full text-left px-4 py-3 hover:bg-purple-50 active:bg-purple-100 transition-colors flex items-center gap-3",style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx(O,{className:"text-purple-600 text-xl"}),T.jsxs("div",{className:"flex-1",children:[T.jsx("div",{className:"font-medium text-gray-900",children:"Help"}),T.jsx("div",{className:"text-xs text-gray-500",children:"Usage guide"})]})]})]})]}),T.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:T.jsxs(ae,{to:"/contact",onClick:n,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-teal-500 to-cyan-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg active:scale-95 transition-all min-h-[48px]",style:{WebkitTapHighlightColor:"transparent"},children:[T.jsx(le,{className:"text-xl"}),T.jsx("span",{children:"Contact Support"})]})})]})]}),T.jsx("style",{dangerouslySetInnerHTML:{__html:"\n        @keyframes slide-in-left {\n          from {\n            transform: translateX(-100%);\n          }\n          to {\n            transform: translateX(0);\n          }\n        }\n\n        .animate-slide-in-left {\n          animation: slide-in-left 0.3s ease-out;\n        }\n      "}})]})};function eb(e){if(!e)return"";const t=Math.floor(((new Date).getTime()-e.getTime())/1e3);if(t<10)return"just now";if(t<60)return`${t}s ago`;const n=Math.floor(t/60);if(n<60)return`${n}m ago`;const r=Math.floor(n/60);if(r<24)return`${r}h ago`;return`${Math.floor(r/24)}d ago`}function tb({status:e,lastSaved:t}){const n={saved:T.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),saving:T.jsxs("svg",{className:"w-4 h-4 text-blue-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[T.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),T.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),error:T.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},r={saved:t?`Saved ${eb(t)}`:"Saved",saving:"Saving...",error:"Save failed"};return T.jsxs("div",{className:`flex items-center gap-1.5 text-sm ${{saved:"text-gray-600",saving:"text-blue-600",error:"text-red-600"}[e]}`,children:[n[e],T.jsx("span",{children:r[e]})]})}const nb="resume-builder-sidebar-collapsed",rb=({sections:t,onSectionClick:n,activeSectionIndex:r,onAddSection:o,onDownloadResume:i,onPreviewResume:s,onExportYAML:a,onImportYAML:l,onStartFresh:c,onHelp:d,isGenerating:u,isGeneratingPreview:h,previewIsStale:p,loadingSave:f,loadingLoad:m,onCollapseChange:g,saveStatus:b,lastSaved:x,isAnonymous:y,isAuthenticated:v,onSignInClick:w})=>{const[k,C]=e.useState(()=>"true"===localStorage.getItem(nb)),[S,N]=e.useState(0),[j,E]=e.useState(0),M=e.useRef(null);e.useEffect(()=>{const e=()=>{const e=document.querySelector("header"),t=document.querySelector('[class*="bg-red-600"]'),n=document.querySelector("footer.fixed");let r=0;t&&t instanceof HTMLElement&&(r+=t.offsetHeight),e&&e instanceof HTMLElement&&(r+=e.offsetHeight);let o=0;n&&n instanceof HTMLElement&&(o=n.offsetHeight),N(r||72),E(o||60)};e(),window.addEventListener("resize",e);const t=new MutationObserver(e);return t.observe(document.body,{childList:!0,subtree:!0,attributes:!0}),()=>{window.removeEventListener("resize",e),t.disconnect()}},[]),e.useEffect(()=>{null==g||g(k)},[]),e.useEffect(()=>{localStorage.setItem(nb,String(k))},[k]),e.useEffect(()=>{const e=e=>{e.ctrlKey&&"\\"===e.key&&(e.preventDefault(),A())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[k]);const A=()=>{const e=!k;C(e),null==g||g(e)},D=e=>{var t;const n=(null==(t=e.type)?void 0:t.toLowerCase())||"",r=e.name.toLowerCase();return"experience"===n?T.jsx(ue,{className:"text-base"}):"education"===n?T.jsx(he,{className:"text-base"}):"bulleted-list"===n?T.jsx(pe,{className:"text-base"}):"inline-list"===n?T.jsx(fe,{className:"text-base"}):"dynamic-column-list"===n?T.jsx(me,{className:"text-base"}):"icon-list"===n?T.jsx(ge,{className:"text-base"}):"text"===n?T.jsx(be,{className:"text-base"}):r.includes("experience")||r.includes("work")||r.includes("employment")?T.jsx(ue,{className:"text-base"}):r.includes("education")||r.includes("school")||r.includes("academic")?T.jsx(he,{className:"text-base"}):r.includes("certification")||r.includes("certificate")?T.jsx(ge,{className:"text-base"}):r.includes("award")||r.includes("honor")||r.includes("achievement")?T.jsx(xe,{className:"text-base"}):r.includes("skill")||r.includes("technical")||r.includes("competenc")?T.jsx(ye,{className:"text-base"}):r.includes("project")||r.includes("portfolio")?T.jsx(ve,{className:"text-base"}):r.includes("language")?T.jsx(we,{className:"text-base"}):r.includes("volunteer")||r.includes("community")?T.jsx(ke,{className:"text-base"}):r.includes("summary")||r.includes("objective")||r.includes("profile")||r.includes("statement")?T.jsx(Ce,{className:"text-base"}):r.includes("personal")||r.includes("interest")||r.includes("hobby")?T.jsx(Se,{className:"text-base"}):T.jsx(fe,{className:"text-base"})},I=e=>{const t=e.name.toLowerCase();if(t.includes("contact"))return"Contact";if(t.includes("professional summary")||t.includes("summary")||t.includes("objective"))return"Summary";if(t.includes("professional qual")||t.includes("qualification"))return"Quals";if(t.includes("key skill")||t.includes("skill")||t.includes("technical"))return"Skills";if(t.includes("experience")||t.includes("work")||t.includes("employment"))return"Work";if(t.includes("education")||t.includes("school")||t.includes("academic"))return"Edu";if(t.includes("certification")||t.includes("certificate"))return"Certs";if(t.includes("personal")||t.includes("interest")||t.includes("hobby"))return"Personal";if(t.includes("project")||t.includes("portfolio"))return"Projects";if(t.includes("award")||t.includes("honor"))return"Awards";if(t.includes("language"))return"Lang";if(t.includes("volunteer"))return"Volunteer";const n=e.name.split(" ")[0];return n.length>8?n.substring(0,7)+".":n};return T.jsxs("nav",{ref:M,className:"hidden lg:flex flex-col fixed right-0 bg-white/95 backdrop-blur-sm border-l border-gray-200/80 shadow-xl overflow-hidden z-[45] transition-all duration-300 ease-in-out "+(k?"w-[72px]":"w-[280px]"),style:{top:`${S}px`,bottom:`${j}px`},"aria-label":"Section navigation and actions",children:[T.jsxs("div",{className:"flex items-center justify-between px-3 py-3 border-b border-gray-200/60 bg-gray-50/50",children:[!k&&T.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Navigator"}),T.jsx("button",{onClick:A,className:"p-2 hover:bg-white rounded-lg transition-all text-gray-500 hover:text-gray-800 hover:shadow-sm "+(k?"mx-auto":""),"aria-label":k?"Expand sidebar (Ctrl+\\)":"Collapse sidebar (Ctrl+\\)",title:k?"Expand (Ctrl+\\)":"Collapse (Ctrl+\\)",children:T.jsx(ne,{className:"text-lg"})})]}),!y&&b&&T.jsx("div",{className:`border-b border-gray-200/60 ${k?"px-2 py-2":"px-4 py-3"} bg-gray-50/30`,children:k?T.jsxs("div",{className:"flex flex-col items-center gap-1",children:["saved"===b&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),T.jsx("span",{className:"text-[9px] text-gray-500",children:"Saved"})]}),"saving"===b&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"animate-spin rounded-full h-2.5 w-2.5 border-b border-blue-600"}),T.jsx("span",{className:"text-[9px] text-gray-500",children:"..."})]}),"error"===b&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),T.jsx("span",{className:"text-[9px] text-gray-500",children:"Error"})]})]}):T.jsx(tb,{status:b,lastSaved:x??null})}),T.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:T.jsxs("div",{className:""+(k?"py-3 px-1.5":"p-3"),id:"tour-section-navigator",children:[!k&&T.jsx("h2",{className:"text-[11px] font-semibold text-gray-500 uppercase tracking-wider mb-3 px-2",children:"Sections"}),T.jsxs("button",{onClick:()=>n(-1),className:`w-full flex items-center transition-all rounded-lg group ${k?"flex-col gap-1.5 py-2.5 px-1.5 hover:bg-blue-50/80":"flex-row gap-3 px-3 py-2.5 hover:bg-gray-100/80"} ${-1===r?k?"bg-blue-50 text-blue-700":"bg-blue-50/80 border-l-[3px] border-blue-600 text-blue-800 font-medium":"text-gray-700 hover:text-gray-900"}`,children:[T.jsx("div",{className:`flex items-center justify-center ${k?"w-7 h-7":"w-6 h-6"} rounded-md ${-1===r?"bg-blue-100 text-blue-600":"bg-gray-100/80 text-gray-500 group-hover:bg-gray-200/80 group-hover:text-gray-700"}`,children:T.jsx(ce,{className:"text-base"})}),T.jsx("span",{className:""+(k?"text-[11px] font-medium text-center leading-tight":"text-[13px] flex-1 text-left"),children:k?"Contact":"Contact Information"})]}),t.map((e,t)=>T.jsxs("button",{onClick:()=>n(t),className:`w-full flex items-center transition-all rounded-lg group ${k?"flex-col gap-1.5 py-2.5 px-1.5 hover:bg-blue-50/80 mt-1":"flex-row gap-3 px-3 py-2.5 hover:bg-gray-100/80 mt-0.5"} ${r===t?k?"bg-blue-50 text-blue-700":"bg-blue-50/80 border-l-[3px] border-blue-600 text-blue-800 font-medium":"text-gray-700 hover:text-gray-900"}`,children:[T.jsx("div",{className:`flex items-center justify-center ${k?"w-7 h-7":"w-6 h-6"} rounded-md ${r===t?"bg-blue-100 text-blue-600":"bg-gray-100/80 text-gray-500 group-hover:bg-gray-200/80 group-hover:text-gray-700"}`,children:D(e)}),T.jsx("span",{className:""+(k?"text-[11px] font-medium text-center leading-tight":"text-[13px] flex-1 truncate text-left"),title:e.name,children:k?I(e):e.name})]},t))]})}),T.jsx("div",{className:"border-t border-gray-200/60 bg-gradient-to-t from-gray-50/80 to-white",children:T.jsxs("div",{className:""+(k?"py-3 px-2":"p-4"),children:[!k&&T.jsx("h3",{className:"text-[11px] font-semibold text-gray-500 uppercase tracking-wider mb-3 px-1",children:"Actions"}),s&&T.jsxs("button",{id:"tour-preview-button",onClick:s,disabled:h,className:"w-full flex items-center justify-center bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg shadow-md hover:shadow-lg hover:from-blue-500 hover:to-indigo-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed active:scale-[0.98] relative "+(k?"flex-col gap-1 py-2.5 px-1 mb-2":"flex-row gap-2 px-4 py-2.5 mb-2.5"),children:[p&&!h&&T.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-amber-500 rounded-full border-2 border-white animate-pulse"}),T.jsx(re,{className:k?"text-lg":"text-base"}),T.jsx("span",{className:k?"text-[10px] leading-tight font-medium":"text-[13px]",children:h?k?"...":"Loading...":k?"Preview":p?"Refresh Preview":"Preview PDF"})]}),T.jsxs("button",{id:"tour-download-button",onClick:i,disabled:u,className:"w-full flex items-center justify-center bg-gradient-to-r from-emerald-600 to-green-600 text-white font-semibold rounded-lg shadow-md hover:shadow-lg hover:from-emerald-500 hover:to-green-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed active:scale-[0.98] "+(k?"flex-col gap-1 py-2.5 px-1":"flex-row gap-2 px-4 py-2.5 mb-2.5"),children:[T.jsx(Z,{className:k?"text-lg":"text-base"}),T.jsx("span",{className:k?"text-[10px] leading-tight font-medium":"text-[13px]",children:u?k?"...":"Generating...":k?"Download":"Download Resume"})]}),T.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-medium rounded-lg shadow-sm hover:shadow-md hover:from-blue-500 hover:to-indigo-500 transition-all active:scale-[0.98] "+(k?"flex-col gap-1 py-2 px-1 mt-2":"flex-row gap-2 px-4 py-2 mb-3"),children:[T.jsx(se,{className:"text-base"}),T.jsx("span",{className:k?"text-[10px] leading-tight font-medium":"text-[13px]",children:k?"Add":"Add Section"})]}),T.jsxs("div",{className:""+(k?"space-y-0.5 mt-2":"space-y-0.5"),children:[y&&w&&T.jsxs(T.Fragment,{children:[T.jsxs("button",{onClick:w,className:`w-full flex items-center transition-all rounded-lg shadow-sm hover:shadow-md ${k?"flex-col gap-1 py-2.5 px-1 bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500":"flex-row gap-3 px-4 py-2.5 bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-500 hover:to-green-500"} text-white font-semibold`,children:[T.jsx(de,{className:k?"text-base":"text-lg"}),T.jsx("span",{className:""+(k?"text-[10px] leading-tight":"text-[13px]"),children:k?"Cloud":"Save to Cloud"})]}),!k&&T.jsx("p",{className:"text-xs text-gray-500 px-3 pb-2",children:"Free & Permanent Storage"})]}),T.jsxs("button",{id:"tour-backup-button",onClick:a,disabled:f,className:"w-full flex items-center transition-all rounded-md disabled:opacity-50 "+(k?"flex-col gap-1 py-2 px-1 hover:bg-blue-50/80":"flex-row gap-3 px-3 py-2 hover:bg-blue-50/80 text-gray-700 hover:text-blue-700"),children:[T.jsx(Z,{className:"text-blue-600 text-base"}),T.jsxs("div",{className:"flex flex-col "+(k?"items-center":"items-start flex-1"),children:[T.jsx("span",{className:""+(k?"text-[10px] text-gray-600 leading-tight font-medium":"text-[13px]"),children:f?k?"...":"Saving...":k?v?"Backup":"Save":v?"Backup to File":"Save My Work"}),y&&!k&&T.jsx("span",{className:"text-xs text-amber-600 leading-tight",children:"Your only local save"})]})]}),T.jsxs("button",{onClick:l,disabled:m,className:"w-full flex items-center transition-all rounded-md disabled:opacity-50 "+(k?"flex-col gap-1 py-2 px-1 hover:bg-green-50/80":"flex-row gap-3 px-3 py-2 hover:bg-green-50/80 text-gray-700 hover:text-green-700"),children:[T.jsx(ee,{className:"text-green-600 text-base"}),T.jsx("span",{className:""+(k?"text-[10px] text-gray-600 leading-tight font-medium":"text-[13px]"),children:m?k?"...":"Loading...":k?"Load":v?"Import from File":"Load My Work"})]}),T.jsxs("button",{onClick:()=>{c()},className:"w-full flex items-center transition-all rounded-md "+(k?"flex-col gap-1 py-2 px-1 hover:bg-orange-50/80":"flex-row gap-3 px-3 py-2 hover:bg-orange-50/80 text-gray-700 hover:text-orange-700"),children:[T.jsx(te,{className:"text-orange-600 text-base"}),T.jsx("span",{className:""+(k?"text-[10px] text-gray-600 leading-tight font-medium":"text-[13px]"),children:k?"Clear":"Start Fresh"})]}),T.jsxs("button",{onClick:d,className:"w-full flex items-center transition-all rounded-md "+(k?"flex-col gap-1 py-2 px-1 hover:bg-purple-50/80":"flex-row gap-3 px-3 py-2 hover:bg-purple-50/80 text-gray-700 hover:text-purple-700"),children:[T.jsx(O,{className:"text-purple-600 text-base"}),T.jsx("span",{className:""+(k?"text-[10px] text-gray-600 leading-tight font-medium":"text-[13px]"),children:k?"Help":"Help & Tips"})]})]}),T.jsx("div",{className:"border-t border-gray-200/60 "+(k?"pt-2 px-2":"pt-3 px-4"),children:T.jsxs(ae,{to:"/contact",className:"w-full flex items-center transition-all rounded-md "+(k?"flex-col gap-1 py-2 px-1 hover:bg-teal-50/80":"flex-row gap-3 px-3 py-2 hover:bg-teal-50/80 text-gray-700 hover:text-teal-700"),children:[T.jsx(le,{className:"text-teal-600 text-base"}),T.jsx("span",{className:""+(k?"text-[10px] text-gray-600 leading-tight font-medium":"text-[13px]"),children:k?"Support":"Contact Support"})]})})]})}),!k&&T.jsx("div",{className:"px-4 py-2.5 bg-gray-100/50 border-t border-gray-200/40",children:T.jsxs("p",{className:"text-[10px] text-gray-500 text-center",children:["Press"," ",T.jsx("kbd",{className:"px-1.5 py-0.5 bg-white rounded text-[9px] font-mono border border-gray-300 shadow-sm",children:"Ctrl"})," ","+"," ",T.jsx("kbd",{className:"px-1.5 py-0.5 bg-white rounded text-[9px] font-mono border border-gray-300 shadow-sm",children:"\\"})," ","to toggle"]})})]})},ob=({isOpen:e,onClose:t,onConfirm:n,title:r,message:o,confirmText:i="Confirm",cancelText:s="Cancel",confirmButtonClass:a,isDestructive:l=!1,isLoading:c=!1})=>{if(!e)return null;const d=a||(l?"bg-red-600 hover:bg-red-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white");return T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998] transition-opacity duration-200",onClick:t,"aria-hidden":"true"}),T.jsx("div",{className:"fixed z-[9999]\r\n          bottom-0 left-0 right-0\r\n          lg:inset-0 lg:flex lg:items-center lg:justify-center\r\n          animate-slide-up lg:animate-fade-in",role:"dialog","aria-modal":"true","aria-labelledby":"dialog-title","aria-describedby":"dialog-description",children:T.jsxs("div",{className:"bg-white rounded-t-2xl lg:rounded-2xl shadow-2xl\r\n            w-full lg:max-w-md\r\n            max-h-[85vh] lg:max-h-[90vh]\r\n            flex flex-col\r\n            transform transition-transform duration-300",onClick:e=>e.stopPropagation(),children:[T.jsxs("div",{className:"flex items-start justify-between p-6 border-b border-gray-200",children:[T.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[l&&T.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:T.jsx(Ne,{className:"text-red-600 text-xl","aria-hidden":"true"})}),T.jsx("div",{className:"flex-1",children:T.jsx("h2",{id:"dialog-title",className:"text-lg font-bold "+(l?"text-red-900":"text-gray-900"),children:r})})]}),T.jsx("button",{onClick:t,className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors p-1 -mr-1","aria-label":"Close dialog",disabled:c,children:T.jsx(ie,{className:"text-2xl"})})]}),T.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:T.jsx("p",{id:"dialog-description",className:"text-gray-700 leading-relaxed whitespace-pre-line",children:o})}),T.jsxs("div",{className:"p-6 border-t border-gray-200 space-y-3 lg:space-y-0 lg:flex lg:gap-3 lg:justify-end",children:[T.jsx("button",{onClick:t,disabled:c,className:"w-full lg:w-auto px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700\r\n                hover:bg-gray-50 active:bg-gray-100\r\n                transition-colors disabled:opacity-50 disabled:cursor-not-allowed\r\n                min-h-[48px] lg:min-h-[44px]",style:{WebkitTapHighlightColor:"transparent"},children:s}),T.jsx("button",{onClick:()=>{n(),t()},disabled:c,className:`w-full lg:w-auto px-6 py-3 rounded-lg font-medium\n                shadow-md hover:shadow-lg active:scale-95\n                transition-all disabled:opacity-50 disabled:cursor-not-allowed\n                min-h-[48px] lg:min-h-[44px]\n                ${d}`,style:{WebkitTapHighlightColor:"transparent"},children:c?T.jsxs("span",{className:"flex items-center justify-center gap-2",children:[T.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Processing..."]}):i})]})]})}),T.jsx("style",{dangerouslySetInnerHTML:{__html:"\n        @keyframes slide-up {\n          from {\n            transform: translateY(100%);\n          }\n          to {\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes fade-in {\n          from {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          to {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n\n        .animate-slide-up {\n          animation: slide-up 0.3s ease-out;\n        }\n\n        @media (min-width: 1024px) {\n          .lg\\:animate-fade-in {\n            animation: fade-in 0.2s ease-out;\n          }\n        }\n      "}})]})};const ib="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function sb(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function ab(e){return"nodeType"in e}function lb(e){var t,n;return e?sb(e)?e:ab(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function cb(e){const{Document:t}=lb(e);return e instanceof t}function db(e){return!sb(e)&&e instanceof lb(e).HTMLElement}function ub(e){return e instanceof lb(e).SVGElement}function hb(e){return e?sb(e)?e.document:ab(e)?cb(e)?e:db(e)||ub(e)?e.ownerDocument:document:document:document}const pb=ib?e.useLayoutEffect:e.useEffect;function fb(t){const n=e.useRef(t);return pb(()=>{n.current=t}),e.useCallback(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==n.current?void 0:n.current(...t)},[])}function mb(t,n){void 0===n&&(n=[t]);const r=e.useRef(t);return pb(()=>{r.current!==t&&(r.current=t)},n),r}function gb(t,n){const r=e.useRef();return e.useMemo(()=>{const e=t(r.current);return r.current=e,e},[...n])}function bb(t){const n=fb(t),r=e.useRef(null),o=e.useCallback(e=>{e!==r.current&&(null==n||n(e,r.current)),r.current=e},[]);return[r,o]}function xb(t){const n=e.useRef();return e.useEffect(()=>{n.current=t},[t]),n.current}let yb={};function vb(t,n){return e.useMemo(()=>{if(n)return n;const e=null==yb[t]?0:yb[t]+1;return yb[t]=e,t+"-"+e},[t,n])}function wb(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>{const r=Object.entries(n);for(const[o,i]of r){const n=t[o];null!=n&&(t[o]=n+e*i)}return t},{...t})}}const kb=wb(1),Cb=wb(-1);function Sb(e){if(!e)return!1;const{KeyboardEvent:t}=lb(e.target);return t&&e instanceof t}function Nb(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=lb(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const jb=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[jb.Translate.toString(e),jb.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Eb="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Mb(e){return e.matches(Eb)?e:e.querySelector(Eb)}const Tb={display:"none"};function Ob(e){let{id:t,value:r}=e;return n.createElement("div",{id:t,style:Tb},r)}function Ab(e){let{id:t,announcement:r,ariaLiveType:o="assertive"}=e;return n.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":o,"aria-atomic":!0},r)}const Db=e.createContext(null);const Ib={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},Rb={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Pb(t){let{announcements:r=Rb,container:o,hiddenTextDescribedById:i,screenReaderInstructions:s=Ib}=t;const{announce:a,announcement:l}=function(){const[t,n]=e.useState("");return{announce:e.useCallback(e=>{null!=e&&n(e)},[]),announcement:t}}(),c=vb("DndLiveRegion"),[d,u]=e.useState(!1);if(e.useEffect(()=>{u(!0)},[]),function(t){const n=e.useContext(Db);e.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}(e.useMemo(()=>({onDragStart(e){let{active:t}=e;a(r.onDragStart({active:t}))},onDragMove(e){let{active:t,over:n}=e;r.onDragMove&&a(r.onDragMove({active:t,over:n}))},onDragOver(e){let{active:t,over:n}=e;a(r.onDragOver({active:t,over:n}))},onDragEnd(e){let{active:t,over:n}=e;a(r.onDragEnd({active:t,over:n}))},onDragCancel(e){let{active:t,over:n}=e;a(r.onDragCancel({active:t,over:n}))}}),[a,r])),!d)return null;const h=n.createElement(n.Fragment,null,n.createElement(Ob,{id:i,value:s.draggable}),n.createElement(Ab,{id:c,announcement:l}));return o?J.createPortal(h,o):h}var Lb,$b;function zb(){}function Fb(t,n){return e.useMemo(()=>({sensor:t,options:null!=n?n:{}}),[t,n])}($b=Lb||(Lb={})).DragStart="dragStart",$b.DragMove="dragMove",$b.DragEnd="dragEnd",$b.DragCancel="dragCancel",$b.DragOver="dragOver",$b.RegisterDroppable="registerDroppable",$b.SetDroppableDisabled="setDroppableDisabled",$b.UnregisterDroppable="unregisterDroppable";const Bb=Object.freeze({x:0,y:0});function Ub(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Vb(e,t){const n=Nb(e);if(!n)return"0 0";return(n.x-t.left)/t.width*100+"% "+(n.y-t.top)/t.height*100+"%"}function _b(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Hb(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Wb(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function qb(e,t){if(!e||0===e.length)return null;const[n]=e;return n[t]}function Kb(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}const Jb=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Kb(t,t.left,t.top),i=[];for(const s of r){const{id:e}=s,t=n.get(e);if(t){const n=Ub(Kb(t),o);i.push({id:e,data:{droppableContainer:s,value:n}})}}return i.sort(_b)};function Yb(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),s=o-r,a=i-n;if(r<o&&n<i){const n=t.width*t.height,r=e.width*e.height,o=s*a;return Number((o/(n+r-o)).toFixed(4))}return 0}const Gb=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const i of r){const{id:e}=i,r=n.get(e);if(r){const n=Yb(r,t);n>0&&o.push({id:e,data:{droppableContainer:i,value:n}})}}return o.sort(Hb)};function Xb(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Bb}function Qb(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>({...t,top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),{...t})}}const Zb=Qb(1);function ex(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const tx={ignoreTransform:!1};function nx(e,t){void 0===t&&(t=tx);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:r}=lb(e).getComputedStyle(e);t&&(n=function(e,t,n){const r=ex(t);if(!r)return e;const{scaleX:o,scaleY:i,x:s,y:a}=r,l=e.left-s-(1-o)*parseFloat(n),c=e.top-a-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),d=o?e.width/o:e.width,u=i?e.height/i:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}(n,t,r))}const{top:r,left:o,width:i,height:s,bottom:a,right:l}=n;return{top:r,left:o,width:i,height:s,bottom:a,right:l}}function rx(e){return nx(e,{ignoreTransform:!0})}function ox(e,t){const n=[];return e?function r(o){if(null!=t&&n.length>=t)return n;if(!o)return n;if(cb(o)&&null!=o.scrollingElement&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!db(o)||ub(o))return n;if(n.includes(o))return n;const i=lb(e).getComputedStyle(o);return o!==e&&function(e,t){void 0===t&&(t=lb(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const r=t[e];return"string"==typeof r&&n.test(r)})}(o,i)&&n.push(o),function(e,t){return void 0===t&&(t=lb(e).getComputedStyle(e)),"fixed"===t.position}(o,i)?n:r(o.parentNode)}(e):n}function ix(e){const[t]=ox(e,1);return null!=t?t:null}function sx(e){return ib&&e?sb(e)?e:ab(e)?cb(e)||e===hb(e).scrollingElement?window:db(e)?e:null:null:null}function ax(e){return sb(e)?e.scrollX:e.scrollLeft}function lx(e){return sb(e)?e.scrollY:e.scrollTop}function cx(e){return{x:ax(e),y:lx(e)}}var dx,ux;function hx(e){return!(!ib||!e)&&e===document.scrollingElement}function px(e){const t={x:0,y:0},n=hx(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=r.y,isRight:e.scrollLeft>=r.x,maxScroll:r,minScroll:t}}(ux=dx||(dx={}))[ux.Forward=1]="Forward",ux[ux.Backward=-1]="Backward";const fx={x:.2,y:.2};function mx(e,t,n,r,o){let{top:i,left:s,right:a,bottom:l}=n;void 0===r&&(r=10),void 0===o&&(o=fx);const{isTop:c,isBottom:d,isLeft:u,isRight:h}=px(e),p={x:0,y:0},f={x:0,y:0},m=t.height*o.y,g=t.width*o.x;return!c&&i<=t.top+m?(p.y=dx.Backward,f.y=r*Math.abs((t.top+m-i)/m)):!d&&l>=t.bottom-m&&(p.y=dx.Forward,f.y=r*Math.abs((t.bottom-m-l)/m)),!h&&a>=t.right-g?(p.x=dx.Forward,f.x=r*Math.abs((t.right-g-a)/g)):!u&&s<=t.left+g&&(p.x=dx.Backward,f.x=r*Math.abs((t.left+g-s)/g)),{direction:p,speed:f}}function gx(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function bx(e){return e.reduce((e,t)=>kb(e,cx(t)),Bb)}function xx(e,t){if(void 0===t&&(t=nx),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);ix(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const yx=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+ax(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+lx(t),0)}]];class vx{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=ox(t),r=bx(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,i,s]of yx)for(const e of i)Object.defineProperty(this,e,{get:()=>{const t=s(n),i=r[o]-t;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class wx{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var r;null==(r=this.target)||r.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function kx(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return"number"==typeof t?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t&&r>t.y}var Cx,Sx,Nx,jx;function Ex(e){e.preventDefault()}function Mx(e){e.stopPropagation()}(Sx=Cx||(Cx={})).Click="click",Sx.DragStart="dragstart",Sx.Keydown="keydown",Sx.ContextMenu="contextmenu",Sx.Resize="resize",Sx.SelectionChange="selectionchange",Sx.VisibilityChange="visibilitychange",(jx=Nx||(Nx={})).Space="Space",jx.Down="ArrowDown",jx.Right="ArrowRight",jx.Left="ArrowLeft",jx.Up="ArrowUp",jx.Esc="Escape",jx.Enter="Enter",jx.Tab="Tab";const Tx={start:[Nx.Space,Nx.Enter],cancel:[Nx.Esc],end:[Nx.Space,Nx.Enter,Nx.Tab]},Ox=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Nx.Right:return{...n,x:n.x+25};case Nx.Left:return{...n,x:n.x-25};case Nx.Down:return{...n,y:n.y+25};case Nx.Up:return{...n,y:n.y-25}}};class Ax{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new wx(hb(t)),this.windowListeners=new wx(lb(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Cx.Resize,this.handleCancel),this.windowListeners.add(Cx.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Cx.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&xx(n),t(Bb)}handleKeyDown(e){if(Sb(e)){const{active:t,context:n,options:r}=this.props,{keyboardCodes:o=Tx,coordinateGetter:i=Ox,scrollBehavior:s="smooth"}=r,{code:a}=e;if(o.end.includes(a))return void this.handleEnd(e);if(o.cancel.includes(a))return void this.handleCancel(e);const{collisionRect:l}=n.current,c=l?{x:l.left,y:l.top}:Bb;this.referenceCoordinates||(this.referenceCoordinates=c);const d=i(e,{active:t,context:n.current,currentCoordinates:c});if(d){const t=Cb(d,c),r={x:0,y:0},{scrollableAncestors:o}=n.current;for(const n of o){const o=e.code,{isTop:i,isRight:a,isLeft:l,isBottom:c,maxScroll:u,minScroll:h}=px(n),p=gx(n),f={x:Math.min(o===Nx.Right?p.right-p.width/2:p.right,Math.max(o===Nx.Right?p.left:p.left+p.width/2,d.x)),y:Math.min(o===Nx.Down?p.bottom-p.height/2:p.bottom,Math.max(o===Nx.Down?p.top:p.top+p.height/2,d.y))},m=o===Nx.Right&&!a||o===Nx.Left&&!l,g=o===Nx.Down&&!c||o===Nx.Up&&!i;if(m&&f.x!==d.x){const e=n.scrollLeft+t.x,i=o===Nx.Right&&e<=u.x||o===Nx.Left&&e>=h.x;if(i&&!t.y)return void n.scrollTo({left:e,behavior:s});r.x=i?n.scrollLeft-e:o===Nx.Right?n.scrollLeft-u.x:n.scrollLeft-h.x,r.x&&n.scrollBy({left:-r.x,behavior:s});break}if(g&&f.y!==d.y){const e=n.scrollTop+t.y,i=o===Nx.Down&&e<=u.y||o===Nx.Up&&e>=h.y;if(i&&!t.x)return void n.scrollTo({top:e,behavior:s});r.y=i?n.scrollTop-e:o===Nx.Down?n.scrollTop-u.y:n.scrollTop-h.y,r.y&&n.scrollBy({top:-r.y,behavior:s});break}}this.handleMove(e,kb(Cb(d,this.referenceCoordinates),r))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function Dx(e){return Boolean(e&&"distance"in e)}function Ix(e){return Boolean(e&&"delay"in e)}Ax.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Tx,onActivation:o}=t,{active:i}=n;const{code:s}=e.nativeEvent;if(r.start.includes(s)){const t=i.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==o||o({event:e.nativeEvent}),!0)}return!1}}];class Rx{constructor(e,t,n){var r;void 0===n&&(n=function(e){const{EventTarget:t}=lb(e);return e instanceof t?e:hb(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:i}=o;this.props=e,this.events=t,this.document=hb(i),this.documentListeners=new wx(this.document),this.listeners=new wx(n),this.windowListeners=new wx(lb(i)),this.initialCoordinates=null!=(r=Nb(o))?r:Bb,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Cx.Resize,this.handleCancel),this.windowListeners.add(Cx.DragStart,Ex),this.windowListeners.add(Cx.VisibilityChange,this.handleCancel),this.windowListeners.add(Cx.ContextMenu,Ex),this.documentListeners.add(Cx.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Ix(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(Dx(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:r}=this.props;r(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Cx.Click,Mx,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Cx.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:r,props:o}=this,{onMove:i,options:{activationConstraint:s}}=o;if(!r)return;const a=null!=(t=Nb(e))?t:Bb,l=Cb(r,a);if(!n&&s){if(Dx(s)){if(null!=s.tolerance&&kx(l,s.tolerance))return this.handleCancel();if(kx(l,s.distance))return this.handleStart()}return Ix(s)&&kx(l,s.tolerance)?this.handleCancel():void this.handlePending(s,l)}e.cancelable&&e.preventDefault(),i(a)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Nx.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const Px={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Lx extends Rx{constructor(e){const{event:t}=e,n=hb(t.target);super(e,Px,n)}}Lx.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!(!n.isPrimary||0!==n.button)&&(null==r||r({event:n}),!0)}}];const $x={move:{name:"mousemove"},end:{name:"mouseup"}};var zx,Fx;(Fx=zx||(zx={}))[Fx.RightClick=2]="RightClick";(class extends Rx{constructor(e){super(e,$x,hb(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button!==zx.RightClick&&(null==r||r({event:n}),!0)}}];const Bx={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var Ux,Vx,_x,Hx;function Wx(t){let{acceleration:n,activator:r=Ux.Pointer,canScroll:o,draggingRect:i,enabled:s,interval:a=5,order:l=_x.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:h,threshold:p}=t;const f=function(e){let{delta:t,disabled:n}=e;const r=xb(t);return gb(e=>{if(n||!r||!e)return qx;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[dx.Backward]:e.x[dx.Backward]||-1===o.x,[dx.Forward]:e.x[dx.Forward]||1===o.x},y:{[dx.Backward]:e.y[dx.Backward]||-1===o.y,[dx.Forward]:e.y[dx.Forward]||1===o.y}}},[n,t,r])}({delta:h,disabled:!s}),[m,g]=function(){const t=e.useRef(null);return[e.useCallback((e,n)=>{t.current=setInterval(e,n)},[]),e.useCallback(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]}(),b=e.useRef({x:0,y:0}),x=e.useRef({x:0,y:0}),y=e.useMemo(()=>{switch(r){case Ux.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Ux.DraggableRect:return i}},[r,i,c]),v=e.useRef(null),w=e.useCallback(()=>{const e=v.current;if(!e)return;const t=b.current.x*x.current.x,n=b.current.y*x.current.y;e.scrollBy(t,n)},[]),k=e.useMemo(()=>l===_x.TreeOrder?[...d].reverse():d,[l,d]);e.useEffect(()=>{if(s&&d.length&&y){for(const e of k){if(!1===(null==o?void 0:o(e)))continue;const t=d.indexOf(e),r=u[t];if(!r)continue;const{direction:i,speed:s}=mx(e,r,y,n,p);for(const e of["x","y"])f[e][i[e]]||(s[e]=0,i[e]=0);if(s.x>0||s.y>0)return g(),v.current=e,m(w,a),b.current=s,void(x.current=i)}b.current={x:0,y:0},x.current={x:0,y:0},g()}else g()},[n,w,o,g,s,a,JSON.stringify(y),JSON.stringify(f),m,d,k,u,JSON.stringify(p)])}(class extends Rx{constructor(e){super(e,Bx)}static setup(){return window.addEventListener(Bx.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Bx.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return!(o.length>1)&&(null==r||r({event:n}),!0)}}],(Vx=Ux||(Ux={}))[Vx.Pointer=0]="Pointer",Vx[Vx.DraggableRect=1]="DraggableRect",(Hx=_x||(_x={}))[Hx.TreeOrder=0]="TreeOrder",Hx[Hx.ReversedTreeOrder=1]="ReversedTreeOrder";const qx={x:{[dx.Backward]:!1,[dx.Forward]:!1},y:{[dx.Backward]:!1,[dx.Forward]:!1}};var Kx,Jx,Yx;(Jx=Kx||(Kx={}))[Jx.Always=0]="Always",Jx[Jx.BeforeDragging=1]="BeforeDragging",Jx[Jx.WhileDragging=2]="WhileDragging",(Yx||(Yx={})).Optimized="optimized";const Gx=new Map;function Xx(e,t){return gb(n=>e?n||("function"==typeof t?t(e):e):null,[t,e])}function Qx(t){let{callback:n,disabled:r}=t;const o=fb(n),i=e.useMemo(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(o)},[r]);return e.useEffect(()=>()=>null==i?void 0:i.disconnect(),[i]),i}function Zx(e){return new vx(nx(e),e)}function ey(t,n,r){void 0===n&&(n=Zx);const[o,i]=e.useState(null);function s(){i(e=>{if(!t)return null;var o;if(!1===t.isConnected)return null!=(o=null!=e?e:r)?o:null;const i=n(t);return JSON.stringify(e)===JSON.stringify(i)?e:i})}const a=function(t){let{callback:n,disabled:r}=t;const o=fb(n),i=e.useMemo(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(o)},[o,r]);return e.useEffect(()=>()=>null==i?void 0:i.disconnect(),[i]),i}({callback(e){if(t)for(const n of e){const{type:e,target:r}=n;if("childList"===e&&r instanceof HTMLElement&&r.contains(t)){s();break}}}}),l=Qx({callback:s});return pb(()=>{s(),t?(null==l||l.observe(t),null==a||a.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==a||a.disconnect())},[t]),o}const ty=[];function ny(t,n){void 0===n&&(n=[]);const r=e.useRef(null);return e.useEffect(()=>{r.current=null},n),e.useEffect(()=>{const e=t!==Bb;e&&!r.current&&(r.current=t),!e&&r.current&&(r.current=null)},[t]),r.current?Cb(t,r.current):Bb}function ry(t){return e.useMemo(()=>t?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(t):null,[t])}const oy=[];function iy(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return db(t)?t:e}const sy=[{sensor:Lx,options:{}},{sensor:Ax,options:{}}],ay={current:{}},ly={draggable:{measure:rx},droppable:{measure:rx,strategy:Kx.WhileDragging,frequency:Yx.Optimized},dragOverlay:{measure:nx}};class cy extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const dy={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new cy,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:zb},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ly,measureDroppableContainers:zb,windowRect:null,measuringScheduled:!1},uy={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:zb,draggableNodes:new Map,over:null,measureDroppableContainers:zb},hy=e.createContext(uy),py=e.createContext(dy);function fy(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new cy}}}function my(e,t){switch(t.type){case Lb.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Lb.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Lb.DragEnd:case Lb.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Lb.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new cy(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case Lb.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new cy(e.droppable.containers);return s.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:s}}}case Lb.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new cy(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function gy(t){let{disabled:n}=t;const{active:r,activatorEvent:o,draggableNodes:i}=e.useContext(hy),s=xb(o),a=xb(null==r?void 0:r.id);return e.useEffect(()=>{if(!n&&!o&&s&&null!=a){if(!Sb(s))return;if(document.activeElement===s.target)return;const e=i.get(a);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=Mb(e);if(t){t.focus();break}}})}},[o,n,i,a,s]),null}function by(e,t){let{transform:n,...r}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...r}),n):n}const xy=e.createContext({...Bb,scaleX:1,scaleY:1});var yy,vy;(vy=yy||(yy={}))[vy.Uninitialized=0]="Uninitialized",vy[vy.Initializing=1]="Initializing",vy[vy.Initialized=2]="Initialized";const wy=e.memo(function(t){var r,o,i,s;let{id:a,accessibility:l,autoScroll:c=!0,children:d,sensors:u=sy,collisionDetection:h=Gb,measuring:p,modifiers:f,...m}=t;const g=e.useReducer(my,void 0,fy),[b,x]=g,[y,v]=function(){const[t]=e.useState(()=>new Set),n=e.useCallback(e=>(t.add(e),()=>t.delete(e)),[t]);return[e.useCallback(e=>{let{type:n,event:r}=e;t.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,r)})},[t]),n]}(),[w,k]=e.useState(yy.Uninitialized),C=w===yy.Initialized,{draggable:{active:S,nodes:N,translate:j},droppable:{containers:E}}=b,M=null!=S?N.get(S):null,T=e.useRef({initial:null,translated:null}),O=e.useMemo(()=>{var e;return null!=S?{id:S,data:null!=(e=null==M?void 0:M.data)?e:ay,rect:T}:null},[S,M]),A=e.useRef(null),[D,I]=e.useState(null),[R,P]=e.useState(null),L=mb(m,Object.values(m)),$=vb("DndDescribedBy",a),z=e.useMemo(()=>E.getEnabled(),[E]),F=(B=p,e.useMemo(()=>({draggable:{...ly.draggable,...null==B?void 0:B.draggable},droppable:{...ly.droppable,...null==B?void 0:B.droppable},dragOverlay:{...ly.dragOverlay,...null==B?void 0:B.dragOverlay}}),[null==B?void 0:B.draggable,null==B?void 0:B.droppable,null==B?void 0:B.dragOverlay]));var B;const{droppableRects:U,measureDroppableContainers:V,measuringScheduled:_}=function(t,n){let{dragging:r,dependencies:o,config:i}=n;const[s,a]=e.useState(null),{frequency:l,measure:c,strategy:d}=i,u=e.useRef(t),h=function(){switch(d){case Kx.Always:return!1;case Kx.BeforeDragging:return r;default:return!r}}(),p=mb(h),f=e.useCallback(function(e){void 0===e&&(e=[]),p.current||a(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[p]),m=e.useRef(null),g=gb(e=>{if(h&&!r)return Gx;if(!e||e===Gx||u.current!==t||null!=s){const e=new Map;for(let n of t){if(!n)continue;if(s&&s.length>0&&!s.includes(n.id)&&n.rect.current){e.set(n.id,n.rect.current);continue}const t=n.node.current,r=t?new vx(c(t),t):null;n.rect.current=r,r&&e.set(n.id,r)}return e}return e},[t,s,r,h,c]);return e.useEffect(()=>{u.current=t},[t]),e.useEffect(()=>{h||f()},[r,h]),e.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),e.useEffect(()=>{h||"number"!=typeof l||null!==m.current||(m.current=setTimeout(()=>{f(),m.current=null},l))},[l,h,f,...o]),{droppableRects:g,measureDroppableContainers:f,measuringScheduled:null!=s}}(z,{dragging:C,dependencies:[j.x,j.y],config:F.droppable}),H=function(e,t){const n=null!=t?e.get(t):void 0,r=n?n.node.current:null;return gb(e=>{var n;return null==t?null:null!=(n=null!=r?r:e)?n:null},[r,t])}(N,S),W=e.useMemo(()=>R?Nb(R):null,[R]),q=function(){const e=!1===(null==D?void 0:D.autoScrollEnabled),t="object"==typeof c?!1===c.enabled:!1===c,n=C&&!e&&!t;if("object"==typeof c)return{...c,enabled:n};return{enabled:n}}(),K=function(e,t){return Xx(e,t)}(H,F.draggable.measure);!function(t){let{activeNode:n,measure:r,initialRect:o,config:i=!0}=t;const s=e.useRef(!1),{x:a,y:l}="boolean"==typeof i?{x:i,y:i}:i;pb(()=>{if(!a&&!l||!n)return void(s.current=!1);if(s.current||!o)return;const e=null==n?void 0:n.node.current;if(!e||!1===e.isConnected)return;const t=Xb(r(e),o);if(a||(t.x=0),l||(t.y=0),s.current=!0,Math.abs(t.x)>0||Math.abs(t.y)>0){const n=ix(e);n&&n.scrollBy({top:t.y,left:t.x})}},[n,a,l,o,r])}({activeNode:null!=S?N.get(S):null,config:q.layoutShiftCompensation,initialRect:K,measure:F.draggable.measure});const Y=ey(H,F.draggable.measure,K),G=ey(H?H.parentElement:null),X=e.useRef({activatorEvent:null,active:null,activeNode:H,collisionRect:null,collisions:null,droppableRects:U,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:E,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Q=E.getNodeFor(null==(r=X.current.over)?void 0:r.id),Z=function(t){let{measure:n}=t;const[r,o]=e.useState(null),i=Qx({callback:e.useCallback(e=>{for(const{target:t}of e)if(db(t)){o(e=>{const r=n(t);return e?{...e,width:r.width,height:r.height}:r});break}},[n])}),s=e.useCallback(e=>{const t=iy(e);null==i||i.disconnect(),t&&(null==i||i.observe(t)),o(t?n(t):null)},[n,i]),[a,l]=bb(s);return e.useMemo(()=>({nodeRef:a,rect:r,setRef:l}),[r,a,l])}({measure:F.dragOverlay.measure}),ee=null!=(o=Z.nodeRef.current)?o:H,te=C?null!=(i=Z.rect)?i:Y:null,ne=Boolean(Z.nodeRef.current&&Z.rect),re=Xb(oe=ne?null:Y,Xx(oe));var oe;const ie=ry(ee?lb(ee):null),se=function(t){const n=e.useRef(t),r=gb(e=>t?e&&e!==ty&&t&&n.current&&t.parentNode===n.current.parentNode?e:ox(t):ty,[t]);return e.useEffect(()=>{n.current=t},[t]),r}(C?null!=Q?Q:H:null),ae=function(t,n){void 0===n&&(n=nx);const[r]=t,o=ry(r?lb(r):null),[i,s]=e.useState(oy);function a(){s(()=>t.length?t.map(e=>hx(e)?o:new vx(n(e),e)):oy)}const l=Qx({callback:a});return pb(()=>{null==l||l.disconnect(),a(),t.forEach(e=>null==l?void 0:l.observe(e))},[t]),i}(se),le=by(f,{transform:{x:j.x-re.x,y:j.y-re.y,scaleX:1,scaleY:1},activatorEvent:R,active:O,activeNodeRect:Y,containerNodeRect:G,draggingNodeRect:te,over:X.current.over,overlayNodeRect:Z.rect,scrollableAncestors:se,scrollableAncestorRects:ae,windowRect:ie}),ce=W?kb(W,j):null,de=function(t){const[n,r]=e.useState(null),o=e.useRef(t),i=e.useCallback(e=>{const t=sx(e.target);t&&r(e=>e?(e.set(t,cx(t)),new Map(e)):null)},[]);return e.useEffect(()=>{const e=o.current;if(t!==e){n(e);const s=t.map(e=>{const t=sx(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,cx(t)]):null}).filter(e=>null!=e);r(s.length?new Map(s):null),o.current=t}return()=>{n(t),n(e)};function n(e){e.forEach(e=>{const t=sx(e);null==t||t.removeEventListener("scroll",i)})}},[i,t]),e.useMemo(()=>t.length?n?Array.from(n.values()).reduce((e,t)=>kb(e,t),Bb):bx(t):Bb,[t,n])}(se),ue=ny(de),he=ny(de,[Y]),pe=kb(le,ue),fe=te?Zb(te,le):null,me=O&&fe?h({active:O,collisionRect:fe,droppableRects:U,droppableContainers:z,pointerCoordinates:ce}):null,ge=qb(me,"id"),[be,xe]=e.useState(null),ye=function(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}(ne?le:kb(le,he),null!=(s=null==be?void 0:be.rect)?s:null,Y),ve=e.useRef(null),we=e.useCallback((e,t)=>{let{sensor:n,options:r}=t;if(null==A.current)return;const o=N.get(A.current);if(!o)return;const i=e.nativeEvent,s=new n({active:A.current,activeNode:o,event:i,options:r,context:X,onAbort(e){if(!N.get(e))return;const{onDragAbort:t}=L.current,n={id:e};null==t||t(n),y({type:"onDragAbort",event:n})},onPending(e,t,n,r){if(!N.get(e))return;const{onDragPending:o}=L.current,i={id:e,constraint:t,initialCoordinates:n,offset:r};null==o||o(i),y({type:"onDragPending",event:i})},onStart(e){const t=A.current;if(null==t)return;const n=N.get(t);if(!n)return;const{onDragStart:r}=L.current,o={activatorEvent:i,active:{id:t,data:n.data,rect:T}};J.unstable_batchedUpdates(()=>{null==r||r(o),k(yy.Initializing),x({type:Lb.DragStart,initialCoordinates:e,active:t}),y({type:"onDragStart",event:o}),I(ve.current),P(i)})},onMove(e){x({type:Lb.DragMove,coordinates:e})},onEnd:a(Lb.DragEnd),onCancel:a(Lb.DragCancel)});function a(e){return async function(){const{active:t,collisions:n,over:r,scrollAdjustedTranslate:o}=X.current;let s=null;if(t&&o){const{cancelDrop:a}=L.current;if(s={activatorEvent:i,active:t,collisions:n,delta:o,over:r},e===Lb.DragEnd&&"function"==typeof a){await Promise.resolve(a(s))&&(e=Lb.DragCancel)}}A.current=null,J.unstable_batchedUpdates(()=>{x({type:e}),k(yy.Uninitialized),xe(null),I(null),P(null),ve.current=null;const t=e===Lb.DragEnd?"onDragEnd":"onDragCancel";if(s){const e=L.current[t];null==e||e(s),y({type:t,event:s})}})}}ve.current=s},[N]),ke=function(t,n){return e.useMemo(()=>t.reduce((e,t)=>{const{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:n(e.handler,t)}))]},[]),[t,n])}(u,e.useCallback((e,t)=>(n,r)=>{const o=n.nativeEvent,i=N.get(r);if(null!==A.current||!i||o.dndKit||o.defaultPrevented)return;const s={active:i};!0===e(n,t.options,s)&&(o.dndKit={capturedBy:t.sensor},A.current=r,we(n,t))},[N,we]));!function(t){e.useEffect(()=>{if(!ib)return;const e=t.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const t of e)null==t||t()}},t.map(e=>{let{sensor:t}=e;return t}))}(u),pb(()=>{Y&&w===yy.Initializing&&k(yy.Initialized)},[Y,w]),e.useEffect(()=>{const{onDragMove:e}=L.current,{active:t,activatorEvent:n,collisions:r,over:o}=X.current;if(!t||!n)return;const i={active:t,activatorEvent:n,collisions:r,delta:{x:pe.x,y:pe.y},over:o};J.unstable_batchedUpdates(()=>{null==e||e(i),y({type:"onDragMove",event:i})})},[pe.x,pe.y]),e.useEffect(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:r,scrollAdjustedTranslate:o}=X.current;if(!e||null==A.current||!t||!o)return;const{onDragOver:i}=L.current,s=r.get(ge),a=s&&s.rect.current?{id:s.id,rect:s.rect.current,data:s.data,disabled:s.disabled}:null,l={active:e,activatorEvent:t,collisions:n,delta:{x:o.x,y:o.y},over:a};J.unstable_batchedUpdates(()=>{xe(a),null==i||i(l),y({type:"onDragOver",event:l})})},[ge]),pb(()=>{X.current={activatorEvent:R,active:O,activeNode:H,collisionRect:fe,collisions:me,droppableRects:U,draggableNodes:N,draggingNode:ee,draggingNodeRect:te,droppableContainers:E,over:be,scrollableAncestors:se,scrollAdjustedTranslate:pe},T.current={initial:te,translated:fe}},[O,H,me,fe,N,ee,te,U,E,be,se,pe]),Wx({...q,delta:j,draggingRect:fe,pointerCoordinates:ce,scrollableAncestors:se,scrollableAncestorRects:ae});const Ce=e.useMemo(()=>({active:O,activeNode:H,activeNodeRect:Y,activatorEvent:R,collisions:me,containerNodeRect:G,dragOverlay:Z,draggableNodes:N,droppableContainers:E,droppableRects:U,over:be,measureDroppableContainers:V,scrollableAncestors:se,scrollableAncestorRects:ae,measuringConfiguration:F,measuringScheduled:_,windowRect:ie}),[O,H,Y,R,me,G,Z,N,E,U,be,V,se,ae,F,_,ie]),Se=e.useMemo(()=>({activatorEvent:R,activators:ke,active:O,activeNodeRect:Y,ariaDescribedById:{draggable:$},dispatch:x,draggableNodes:N,over:be,measureDroppableContainers:V}),[R,ke,O,Y,x,$,N,be,V]);return n.createElement(Db.Provider,{value:v},n.createElement(hy.Provider,{value:Se},n.createElement(py.Provider,{value:Ce},n.createElement(xy.Provider,{value:ye},d)),n.createElement(gy,{disabled:!1===(null==l?void 0:l.restoreFocus)})),n.createElement(Pb,{...l,hiddenTextDescribedById:$}))}),ky=e.createContext(null),Cy="button";function Sy(t){let{id:n,data:r,disabled:o=!1,attributes:i}=t;const s=vb("Draggable"),{activators:a,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:h,over:p}=e.useContext(hy),{role:f=Cy,roleDescription:m="draggable",tabIndex:g=0}=null!=i?i:{},b=(null==c?void 0:c.id)===n,x=e.useContext(b?xy:ky),[y,v]=bb(),[w,k]=bb(),C=function(t,n){return e.useMemo(()=>t.reduce((e,t)=>{let{eventName:r,handler:o}=t;return e[r]=e=>{o(e,n)},e},{}),[t,n])}(a,n),S=mb(r);pb(()=>(h.set(n,{id:n,key:s,node:y,activatorNode:w,data:S}),()=>{const e=h.get(n);e&&e.key===s&&h.delete(n)}),[h,n]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:e.useMemo(()=>({role:f,tabIndex:g,"aria-disabled":o,"aria-pressed":!(!b||f!==Cy)||void 0,"aria-roledescription":m,"aria-describedby":u.draggable}),[o,f,g,b,m,u.draggable]),isDragging:b,listeners:o?void 0:C,node:y,over:p,setNodeRef:v,setActivatorNodeRef:k,transform:x}}function Ny(){return e.useContext(py)}const jy={timeout:25};function Ey(t){let{animation:r,children:o}=t;const[i,s]=e.useState(null),[a,l]=e.useState(null),c=xb(o);return o||i||!c||s(c),pb(()=>{if(!a)return;const e=null==i?void 0:i.key,t=null==i?void 0:i.props.id;null!=e&&null!=t?Promise.resolve(r(t,a)).then(()=>{s(null)}):s(null)},[r,i,a]),n.createElement(n.Fragment,null,o,i?e.cloneElement(i,{ref:l}):null)}const My={x:0,y:0,scaleX:1,scaleY:1};function Ty(e){let{children:t}=e;return n.createElement(hy.Provider,{value:uy},n.createElement(xy.Provider,{value:My},t))}const Oy={position:"fixed",touchAction:"none"},Ay=e=>Sb(e)?"transform 250ms ease":void 0,Dy=e.forwardRef((e,t)=>{let{as:r,activatorEvent:o,adjustScale:i,children:s,className:a,rect:l,style:c,transform:d,transition:u=Ay}=e;if(!l)return null;const h=i?d:{...d,scaleX:1,scaleY:1},p={...Oy,width:l.width,height:l.height,top:l.top,left:l.left,transform:jb.Transform.toString(h),transformOrigin:i&&o?Vb(o,l):void 0,transition:"function"==typeof u?u(o):u,...c};return n.createElement(r,{className:a,style:p,ref:t},s)}),Iy={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:n}}=e;return[{transform:jb.Transform.toString(t)},{transform:jb.Transform.toString(n)}]},sideEffects:(e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:i,className:s}=e;if(null!=i&&i.active)for(const[e,a]of Object.entries(i.active))void 0!==a&&(o[e]=n.node.style.getPropertyValue(e),n.node.style.setProperty(e,a));if(null!=i&&i.dragOverlay)for(const[e,a]of Object.entries(i.dragOverlay))void 0!==a&&r.node.style.setProperty(e,a);return null!=s&&s.active&&n.node.classList.add(s.active),null!=s&&s.dragOverlay&&r.node.classList.add(s.dragOverlay),function(){for(const[e,t]of Object.entries(o))n.node.style.setProperty(e,t);null!=s&&s.active&&n.node.classList.remove(s.active)}})({styles:{active:{opacity:"0"}}})};function Ry(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return fb((e,i)=>{if(null===t)return;const s=n.get(e);if(!s)return;const a=s.node.current;if(!a)return;const l=iy(i);if(!l)return;const{transform:c}=lb(i).getComputedStyle(i),d=ex(c);if(!d)return;const u="function"==typeof t?t:function(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}={...Iy,...e};return e=>{let{active:i,dragOverlay:s,transform:a,...l}=e;if(!t)return;const c={x:s.rect.left-i.rect.left,y:s.rect.top-i.rect.top},d={scaleX:1!==a.scaleX?i.rect.width*a.scaleX/s.rect.width:1,scaleY:1!==a.scaleY?i.rect.height*a.scaleY/s.rect.height:1},u={x:a.x-c.x,y:a.y-c.y,...d},h=o({...l,active:i,dragOverlay:s,transform:{initial:a,final:u}}),[p]=h,f=h[h.length-1];if(JSON.stringify(p)===JSON.stringify(f))return;const m=null==r?void 0:r({active:i,dragOverlay:s,...l}),g=s.node.animate(h,{duration:t,easing:n,fill:"forwards"});return new Promise(e=>{g.onfinish=()=>{null==m||m(),e()}})}}(t);return xx(a,o.draggable.measure),u({active:{id:e,data:s.data,node:a,rect:o.draggable.measure(a)},draggableNodes:n,dragOverlay:{node:i,rect:o.dragOverlay.measure(l)},droppableContainers:r,measuringConfiguration:o,transform:d})})}let Py=0;const Ly=n.memo(t=>{let{adjustScale:r=!1,children:o,dropAnimation:i,style:s,transition:a,modifiers:l,wrapperElement:c="div",className:d,zIndex:u=999}=t;const{activatorEvent:h,active:p,activeNodeRect:f,containerNodeRect:m,draggableNodes:g,droppableContainers:b,dragOverlay:x,over:y,measuringConfiguration:v,scrollableAncestors:w,scrollableAncestorRects:k,windowRect:C}=Ny(),S=e.useContext(xy),N=(j=null==p?void 0:p.id,e.useMemo(()=>{if(null!=j)return Py++,Py},[j]));var j;const E=by(l,{activatorEvent:h,active:p,activeNodeRect:f,containerNodeRect:m,draggingNodeRect:x.rect,over:y,overlayNodeRect:x.rect,scrollableAncestors:w,scrollableAncestorRects:k,transform:S,windowRect:C}),M=Xx(f),T=Ry({config:i,draggableNodes:g,droppableContainers:b,measuringConfiguration:v}),O=M?x.setRef:void 0;return n.createElement(Ty,null,n.createElement(Ey,{animation:T},p&&N?n.createElement(Dy,{key:N,id:p.id,ref:O,as:c,activatorEvent:h,adjustScale:r,className:d,transition:a,rect:M,style:{zIndex:u,...s},transform:E},o):null))});function $y(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function zy(e,t){return e.reduce((e,n,r)=>{const o=t.get(n);return o&&(e[r]=o),e},Array(e.length))}function Fy(e){return null!==e&&e>=0}const By=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const i=$y(t,r,n),s=t[o],a=i[o];return a&&s?{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}:null},Uy={scaleX:1,scaleY:1},Vy=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:i,overIndex:s}=e;const a=null!=(t=i[n])?t:r;if(!a)return null;if(o===n){const e=i[s];return e?{x:0,y:n<s?e.top+e.height-(a.top+a.height):e.top-a.top,...Uy}:null}const l=function(e,t,n){const r=e[t],o=e[t-1],i=e[t+1];if(!r)return 0;if(n<t)return o?r.top-(o.top+o.height):i?i.top-(r.top+r.height):0;return i?i.top-(r.top+r.height):o?r.top-(o.top+o.height):0}(i,o,n);return o>n&&o<=s?{x:0,y:-a.height-l,...Uy}:o<n&&o>=s?{x:0,y:a.height+l,...Uy}:{x:0,y:0,...Uy}};const _y="Sortable",Hy=n.createContext({activeIndex:-1,containerId:_y,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:By,disabled:{draggable:!1,droppable:!1}});function Wy(t){let{children:r,id:o,items:i,strategy:s=By,disabled:a=!1}=t;const{active:l,dragOverlay:c,droppableRects:d,over:u,measureDroppableContainers:h}=Ny(),p=vb(_y,o),f=Boolean(null!==c.rect),m=e.useMemo(()=>i.map(e=>"object"==typeof e&&"id"in e?e.id:e),[i]),g=null!=l,b=l?m.indexOf(l.id):-1,x=u?m.indexOf(u.id):-1,y=e.useRef(m),v=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(m,y.current),w=-1!==x&&-1===b||v,k=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(a);pb(()=>{v&&g&&h(m)},[v,m,g,h]),e.useEffect(()=>{y.current=m},[m]);const C=e.useMemo(()=>({activeIndex:b,containerId:p,disabled:k,disableTransforms:w,items:m,overIndex:x,useDragOverlay:f,sortedRects:zy(m,d),strategy:s}),[b,p,k.draggable,k.droppable,w,m,x,d,f,s]);return n.createElement(Hy.Provider,{value:C},r)}const qy=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return $y(n,r,o).indexOf(t)},Ky=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:i,newIndex:s,previousItems:a,previousContainerId:l,transition:c}=e;return!(!c||!r)&&((a===i||o!==s)&&(!!n||s!==o&&t===l))},Jy={duration:200,easing:"ease"},Yy="transform",Gy=jb.Transition.toString({property:Yy,duration:0,easing:"linear"}),Xy={roleDescription:"sortable"};function Qy(t){let{animateLayoutChanges:n=Ky,attributes:r,disabled:o,data:i,getNewIndex:s=qy,id:a,strategy:l,resizeObserverConfig:c,transition:d=Jy}=t;const{items:u,containerId:h,activeIndex:p,disabled:f,disableTransforms:m,sortedRects:g,overIndex:b,useDragOverlay:x,strategy:y}=e.useContext(Hy),v=function(e,t){var n,r;if("boolean"==typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(r=null==e?void 0:e.droppable)?r:t.droppable}}(o,f),w=u.indexOf(a),k=e.useMemo(()=>({sortable:{containerId:h,index:w,items:u},...i}),[h,i,w,u]),C=e.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:S,node:N,isOver:j,setNodeRef:E}=function(t){let{data:n,disabled:r=!1,id:o,resizeObserverConfig:i}=t;const s=vb("Droppable"),{active:a,dispatch:l,over:c,measureDroppableContainers:d}=e.useContext(hy),u=e.useRef({disabled:r}),h=e.useRef(!1),p=e.useRef(null),f=e.useRef(null),{disabled:m,updateMeasurementsFor:g,timeout:b}={...jy,...i},x=mb(null!=g?g:o),y=Qx({callback:e.useCallback(()=>{h.current?(null!=f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{d(Array.isArray(x.current)?x.current:[x.current]),f.current=null},b)):h.current=!0},[b]),disabled:m||!a}),v=e.useCallback((e,t)=>{y&&(t&&(y.unobserve(t),h.current=!1),e&&y.observe(e))},[y]),[w,k]=bb(v),C=mb(n);return e.useEffect(()=>{y&&w.current&&(y.disconnect(),h.current=!1,y.observe(w.current))},[w,y]),e.useEffect(()=>(l({type:Lb.RegisterDroppable,element:{id:o,key:s,disabled:r,node:w,rect:p,data:C}}),()=>l({type:Lb.UnregisterDroppable,key:s,id:o})),[o]),e.useEffect(()=>{r!==u.current.disabled&&(l({type:Lb.SetDroppableDisabled,id:o,key:s,disabled:r}),u.current.disabled=r)},[o,s,r,l]),{active:a,rect:p,isOver:(null==c?void 0:c.id)===o,node:w,over:c,setNodeRef:k}}({id:a,data:k,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...c}}),{active:M,activatorEvent:T,activeNodeRect:O,attributes:A,setNodeRef:D,listeners:I,isDragging:R,over:P,setActivatorNodeRef:L,transform:$}=Sy({id:a,data:k,attributes:{...Xy,...r},disabled:v.draggable}),z=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.useMemo(()=>e=>{n.forEach(t=>t(e))},n)}(E,D),F=Boolean(M),B=F&&!m&&Fy(p)&&Fy(b),U=!x&&R,V=U&&B?$:null,_=B?null!=V?V:(null!=l?l:y)({rects:g,activeNodeRect:O,activeIndex:p,overIndex:b,index:w}):null,H=Fy(p)&&Fy(b)?s({id:a,items:u,activeIndex:p,overIndex:b}):w,W=null==M?void 0:M.id,q=e.useRef({activeId:W,items:u,newIndex:H,containerId:h}),K=u!==q.current.items,J=n({active:M,containerId:h,isDragging:R,isSorting:F,id:a,index:w,items:u,newIndex:q.current.newIndex,previousItems:q.current.items,previousContainerId:q.current.containerId,transition:d,wasDragging:null!=q.current.activeId}),Y=function(t){let{disabled:n,index:r,node:o,rect:i}=t;const[s,a]=e.useState(null),l=e.useRef(r);return pb(()=>{if(!n&&r!==l.current&&o.current){const e=i.current;if(e){const t=nx(o.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&a(n)}}r!==l.current&&(l.current=r)},[n,r,o,i]),e.useEffect(()=>{s&&a(null)},[s]),s}({disabled:!J,index:w,node:N,rect:S});return e.useEffect(()=>{F&&q.current.newIndex!==H&&(q.current.newIndex=H),h!==q.current.containerId&&(q.current.containerId=h),u!==q.current.items&&(q.current.items=u)},[F,H,h,u]),e.useEffect(()=>{if(W===q.current.activeId)return;if(null!=W&&null==q.current.activeId)return void(q.current.activeId=W);const e=setTimeout(()=>{q.current.activeId=W},50);return()=>clearTimeout(e)},[W]),{active:M,activeIndex:p,attributes:A,data:k,rect:S,index:w,newIndex:H,items:u,isOver:j,isSorting:F,isDragging:R,listeners:I,node:N,overIndex:b,over:P,setNodeRef:z,setActivatorNodeRef:L,setDroppableNodeRef:E,setDraggableNodeRef:D,transform:null!=Y?Y:_,transition:function(){if(Y||K&&q.current.newIndex===w)return Gy;if(U&&!Sb(T)||!d)return;if(F||J)return jb.Transition.toString({...d,property:Yy});return}()}}function Zy(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const ev=[Nx.Down,Nx.Right,Nx.Up,Nx.Left],tv=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:i,over:s,scrollableAncestors:a}}=t;if(ev.includes(e.code)){if(e.preventDefault(),!n||!r)return;const t=[];i.getEnabled().forEach(n=>{if(!n||null!=n&&n.disabled)return;const i=o.get(n.id);if(i)switch(e.code){case Nx.Down:r.top<i.top&&t.push(n);break;case Nx.Up:r.top>i.top&&t.push(n);break;case Nx.Left:r.left>i.left&&t.push(n);break;case Nx.Right:r.left<i.left&&t.push(n)}});const l=(e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Wb(t),i=[];for(const s of r){const{id:e}=s,t=n.get(e);if(t){const n=Wb(t),r=o.reduce((e,t,r)=>e+Ub(n[r],t),0),a=Number((r/4).toFixed(4));i.push({id:e,data:{droppableContainer:s,value:a}})}}return i.sort(_b)})({collisionRect:r,droppableRects:o,droppableContainers:t});let c=qb(l,"id");if(c===(null==s?void 0:s.id)&&l.length>1&&(c=l[1].id),null!=c){const e=i.get(n.id),t=i.get(c),s=t?o.get(t.id):null,l=null==t?void 0:t.node.current;if(l&&s&&e&&t){const n=ox(l).some((e,t)=>a[t]!==e),o=nv(e,t),i=function(e,t){if(!Zy(e)||!Zy(t))return!1;if(!nv(e,t))return!1;return e.data.current.sortable.index<t.data.current.sortable.index}(e,t),c=n||!o?{x:0,y:0}:{x:i?r.width-s.width:0,y:i?r.height-s.height:0},d={x:s.left,y:s.top};return c.x&&c.y?d:Cb(d,c)}}}};function nv(e,t){return!(!Zy(e)||!Zy(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}const rv=({id:e,children:t,disabled:n=!1})=>{const{attributes:r,listeners:o,setNodeRef:i,transform:s,transition:a,isDragging:l}=Qy({id:e,disabled:n}),c={transform:jb.Transform.toString(s),transition:a};return T.jsxs("div",{ref:i,style:c,className:"relative group rounded-2xl "+(l?"opacity-60 scale-105 shadow-2xl z-50":"transition-all duration-200 ease-out"),...r,children:[!n&&T.jsx("div",{...o,className:"absolute left-2 top-6 w-6 h-6 flex items-center justify-center rounded-lg \r\n                     text-gray-300 hover:text-blue-600 hover:bg-blue-50/50 \r\n                     cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 \r\n                     transition-all duration-150 ease-out z-10","aria-label":"Drag to reorder section",title:"Drag to reorder section",children:T.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[T.jsx("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"}),T.jsx("path",{d:"M6 6a2 2 0 110-4 2 2 0 010 4zM6 12a2 2 0 110-4 2 2 0 010 4zM6 18a2 2 0 110-4 2 2 0 010 4z"}),T.jsx("path",{d:"M14 6a2 2 0 110-4 2 2 0 010 4zM14 12a2 2 0 110-4 2 2 0 010 4zM14 18a2 2 0 110-4 2 2 0 010 4z"})]})}),T.jsx("div",{className:`\n        ${n?"":"pl-2"} \n        ${l?"pointer-events-none":""}\n        transition-all duration-200 ease-out rounded-2xl\n        group-hover:shadow-xl group-hover:border-blue-200/60\n      `,children:t})]})},ov=[{id:"status-safety",targetElementId:"header-auth-status",visibleFor:"all",title:{authenticated:"Cloud Saving Active",anonymous:"Your Work is Unsaved"},content:{authenticated:{simpleContent:{icon:"â˜ï¸",description:"Your resume automatically saves to the cloud every few seconds. Access your resume from the My Resumes dashboard anytime."}},anonymous:{simpleContent:{icon:"âš ï¸",description:"Your work is not saved. Clear your cache or use a different device and it's gone. Sign In for free to keep your resume safe."}}},badge:{text:"Free cloud backup available",type:"warning",showForAnonymousOnly:!0},ctaButton:{text:"Enable Free Cloud Saving",action:"sign-in",showForAnonymousOnly:!0}},{id:"my-resumes",targetElementId:"tour-my-resumes-link",visibleFor:"authenticated",title:{authenticated:"Your Dashboard",anonymous:"Your Dashboard"},content:{authenticated:{simpleContent:{icon:"ðŸ“š",description:"Access all your resume versions here. Create tailored resumes for different jobs - we save up to 5 versions."}},anonymous:{simpleContent:{icon:"ðŸ“š",description:"N/A"}}}},{id:"navigation",targetElementId:"tour-section-navigator",visibleFor:"all",title:{authenticated:"Build Your Sections",anonymous:"Build Your Sections"},content:{authenticated:{simpleContent:{icon:"ðŸ§­",description:"Use the Menu to add new sections, view and jump between sections. Reorder them by dragging on the Editor page."}},anonymous:{simpleContent:{icon:"ðŸ§­",description:"Use the Menu to add new sections, view and jump between sections. Reorder them by dragging on the Editor page."}}}},{id:"formatting",targetElementId:"tour-bubble-menu",visibleFor:"all",title:{authenticated:"Quick Formatting",anonymous:"Quick Formatting"},content:{authenticated:{simpleContent:{icon:"âœ¨",description:"Select any text to reveal formatting options. Make text bold, italic, underlined, or add hyperlinks anywhere."}},anonymous:{simpleContent:{icon:"âœ¨",description:"Select any text to reveal formatting options. Make text bold, italic, underlined, or add hyperlinks anywhere."}}}},{id:"export",targetElementId:"tour-download-button",visibleFor:"all",title:{authenticated:"Download PDF",anonymous:"Download PDF"},content:{authenticated:{simpleContent:{icon:"ðŸ“¥",description:"Ready to apply? Click Download Resume to export a professional PDF. Your formatting and styling transfer perfectly."}},anonymous:{simpleContent:{icon:"ðŸ“¥",description:"Ready to apply? Click Download Resume to export a professional PDF. Please Login to save your resume for future edits."}}}}];function iv({isOpen:t,onClose:n,isAnonymous:r,isAuthenticated:o,onSignInClick:i,onTourComplete:s}){var a;const[l,c]=e.useState(0),d=e.useMemo(()=>ov.filter(e=>!e.visibleFor||"all"===e.visibleFor||("authenticated"===e.visibleFor?o:"anonymous"!==e.visibleFor||r)),[o,r]);if(e.useEffect(()=>{t&&c(0)},[t]),!t)return null;const u=d[l],h=0===l,p=l===d.length-1,f=r?u.title.anonymous:u.title.authenticated,m=r?u.content.anonymous:u.content.authenticated,g=u.badge&&(!u.badge.showForAnonymousOnly||r),b=(null==(a=u.ctaButton)?void 0:a.showForAnonymousOnly)&&r,x=()=>{s(),n()},y=()=>{s(),n()};return T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999]",onClick:x}),T.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[9999] p-4 pointer-events-none",children:T.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full border border-gray-200 relative pointer-events-auto",onClick:e=>e.stopPropagation(),children:[T.jsx("button",{onClick:x,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors text-sm font-medium z-10",children:"Skip Tour"}),T.jsxs("div",{className:"p-8 pt-10",children:[T.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:f}),g&&T.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium mb-4 "+("info"===u.badge.type?"bg-blue-50 text-blue-700 border border-blue-200":"warning"===u.badge.type?"bg-amber-50 text-amber-700 border border-amber-200":"bg-green-50 text-green-700 border border-green-200"),children:[T.jsxs("span",{children:["info"===u.badge.type&&"ðŸ’¡","warning"===u.badge.type&&"âš ï¸","success"===u.badge.type&&"âœ“"]}),T.jsx("span",{children:u.badge.text})]}),T.jsx("div",{className:"space-y-5 mb-6 mt-6",children:m.simpleContent?T.jsxs("div",{className:"flex gap-4",children:[T.jsx("div",{className:"text-3xl flex-shrink-0",children:m.simpleContent.icon}),T.jsx("div",{className:"flex-1",children:T.jsx("p",{className:"text-gray-700 text-base leading-relaxed",children:m.simpleContent.description})})]}):m.items?m.items.map((e,t)=>T.jsxs("div",{className:"flex gap-4",children:[T.jsx("div",{className:"text-2xl flex-shrink-0",children:e.icon}),T.jsxs("div",{className:"flex-1",children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-1",children:e.heading}),T.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:e.description})]})]},t)):null}),b&&T.jsx("button",{onClick:()=>{i()},className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold py-3 px-6 rounded-lg hover:from-blue-500 hover:to-indigo-500 transition-all shadow-md hover:shadow-lg mb-4",children:u.ctaButton.text}),T.jsx("div",{className:"flex items-center justify-center gap-2 mb-6",children:d.map((e,t)=>T.jsx("button",{onClick:()=>c(t),className:"transition-all rounded-full "+(t===l?"bg-blue-600 w-8 h-2":"bg-gray-300 hover:bg-gray-400 w-2 h-2"),"aria-label":`Go to step ${t+1} of ${d.length}`},t))}),T.jsxs("div",{className:"flex items-center justify-between gap-4",children:[T.jsx("button",{onClick:()=>{h||c(l-1)},disabled:h,className:"px-6 py-2.5 rounded-lg font-medium transition-all "+(h?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"),children:"Previous"}),T.jsx("button",{onClick:()=>{p?y():c(l+1)},className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-500 transition-all shadow-sm hover:shadow-md",children:p?"Get Started":"Next"})]})]})]})})]})}function sv(...e){return e.filter(Boolean).join(" ")}function av({isOpen:t,onClose:n,isAnonymous:r,onSignInClick:o}){return t?T.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:T.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[T.jsx("div",{className:"p-6 border-b border-gray-200 flex-shrink-0",children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Help & Tips"}),T.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:T.jsx(ie,{className:"w-6 h-6"})})]})}),T.jsxs(lt.Group,{as:"div",className:"flex-1 flex flex-col overflow-hidden",children:[T.jsxs(lt.List,{className:"flex border-b border-gray-200 px-6 flex-shrink-0",children:[T.jsx(lt,{as:e.Fragment,children:({selected:e})=>T.jsx("button",{className:sv("py-3 px-4 font-medium text-sm transition-all border-b-2 -mb-px",e?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900 hover:border-gray-300"),children:"Editor Guide"})}),T.jsx(lt,{as:e.Fragment,children:({selected:e})=>T.jsx("button",{className:sv("py-3 px-4 font-medium text-sm transition-all border-b-2 -mb-px",e?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900 hover:border-gray-300"),children:"Saving & Data"})}),T.jsx(lt,{as:e.Fragment,children:({selected:e})=>T.jsx("button",{className:sv("py-3 px-4 font-medium text-sm transition-all border-b-2 -mb-px",e?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900 hover:border-gray-300"),children:"FAQs"})})]}),T.jsxs(lt.Panels,{className:"p-6 overflow-y-auto flex-1",children:[T.jsx(lt.Panel,{children:T.jsx(lv,{})}),T.jsx(lt.Panel,{children:r?T.jsx(cv,{onSignInClick:o}):T.jsx(dv,{})}),T.jsx(lt.Panel,{children:T.jsx(uv,{})})]})]})]})}):null}function lv(){return T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Formatting Text"}),T.jsx("p",{className:"text-gray-600 mb-2",children:"Select any text to reveal the formatting toolbar (bubble menu). You can:"}),T.jsxs("ul",{className:"list-disc pl-5 text-gray-600 space-y-1",children:[T.jsxs("li",{children:["Make text ",T.jsx("strong",{children:"bold"}),", ",T.jsx("em",{children:"italic"}),", or ",T.jsx("u",{children:"underlined"})]}),T.jsx("li",{children:"Add hyperlinks to portfolios, LinkedIn, GitHub, etc."}),T.jsx("li",{children:"Clear formatting to start fresh"})]})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Reordering Sections"}),T.jsx("p",{className:"text-gray-600",children:"Drag and drop sections in the sidebar (desktop) or bottom navigation (mobile) to reorder them. Customize your resume structure to highlight what matters most."})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Adding Sections"}),T.jsx("p",{className:"text-gray-600",children:'Click the "Add Section" button to insert new sections like Skills, Projects, Certifications, or custom sections. You can add as many as you need.'})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Keyboard Shortcuts"}),T.jsxs("ul",{className:"list-disc pl-5 text-gray-600 space-y-1",children:[T.jsxs("li",{children:[T.jsx("kbd",{className:"px-2 py-1 bg-gray-100 border border-gray-300 rounded text-xs",children:"Ctrl+\\"})," - Toggle sidebar (desktop)"]}),T.jsxs("li",{children:[T.jsx("kbd",{className:"px-2 py-1 bg-gray-100 border border-gray-300 rounded text-xs",children:"Ctrl+B"})," - Bold text"]}),T.jsxs("li",{children:[T.jsx("kbd",{className:"px-2 py-1 bg-gray-100 border border-gray-300 rounded text-xs",children:"Ctrl+I"})," - Italic text"]})]})]})]})}function cv({onSignInClick:e}){return T.jsxs("div",{className:"space-y-6",children:[T.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-500 p-4 rounded-r-lg",children:T.jsxs("div",{className:"flex items-start",children:[T.jsx("span",{className:"text-amber-600 text-xl mr-3",children:"âš ï¸"}),T.jsxs("div",{children:[T.jsx("h3",{className:"font-semibold text-amber-900 mb-2",children:"Your data is stored locally"}),T.jsxs("p",{className:"text-amber-800 text-sm",children:["Your resume is currently saved in your browser's local storage. If you clear your browser data or use a different device, your work will be lost.",T.jsx("strong",{className:"block mt-2",children:"We highly recommend creating a free account to save your resume securely in the cloud."})]})]})]})}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"How to Save Your Work (Manual)"}),T.jsxs("ol",{className:"list-decimal pl-5 text-gray-600 space-y-2",children:[T.jsxs("li",{children:["Click ",T.jsx("strong",{children:'"Backup to File"'})," in the sidebar to download a .yaml file"]}),T.jsx("li",{children:"Store this file somewhere safe (email it to yourself, save to cloud drive, etc.)"}),T.jsxs("li",{children:["To restore later, click ",T.jsx("strong",{children:'"Load My Work"'})," and upload the .yaml file"]})]})]}),e&&T.jsx("button",{onClick:e,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold py-3 px-6 rounded-lg hover:from-blue-500 hover:to-indigo-500 transition-all shadow-md hover:shadow-lg",children:"Create Free Account (Recommended)"})]})}function dv(){return T.jsxs("div",{className:"space-y-6",children:[T.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg",children:T.jsxs("div",{className:"flex items-start",children:[T.jsx("span",{className:"text-green-600 text-xl mr-3",children:"âœ“"}),T.jsxs("div",{children:[T.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"Your data is secure"}),T.jsx("p",{className:"text-green-800 text-sm",children:"Your resume is automatically saved to the cloud with enterprise-grade encryption via Supabase. You can access it from any device, anytime."})]})]})}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Cloud Storage Features"}),T.jsxs("ul",{className:"list-disc pl-5 text-gray-600 space-y-2",children:[T.jsxs("li",{children:[T.jsx("strong",{children:"Auto-save every few seconds"})," - No need to click save, your work is continuously backed up"]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Access from any device"})," - Edit your resume from desktop, tablet, or mobile"]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Up to 5 resumes stored"})," - Create different versions for different roles"]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Bank-level encryption (AES-256)"})," - Your data is protected with the same security used by financial institutions"]})]})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Additional Backup Options"}),T.jsx("p",{className:"text-gray-600 mb-2",children:"While your resume is safe in the cloud, you can still create local backups:"}),T.jsxs("ul",{className:"list-disc pl-5 text-gray-600 space-y-1",children:[T.jsxs("li",{children:["Click ",T.jsx("strong",{children:'"Backup to File"'})," to download a .yaml file for extra peace of mind"]}),T.jsxs("li",{children:["Click ",T.jsx("strong",{children:'"Download Resume"'})," to save a PDF copy"]})]})]})]})}function uv(){return T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Is this ATS-compatible?"}),T.jsx("p",{className:"text-gray-600",children:"Yes! Our templates are designed to pass Applicant Tracking Systems (ATS) used by top companies. We use clean formatting, standard fonts, and avoid complex graphics that can confuse ATS scanners."})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Can I customize the template?"}),T.jsx("p",{className:"text-gray-600",children:'Currently, we offer the "Modern" template with a professional, clean design. You can customize all content, reorder sections, and format text to match your needs.'})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"What format does it export to?"}),T.jsx("p",{className:"text-gray-600",children:"Your resume exports as a high-quality PDF file, ready to send to employers or upload to job boards. The PDF preserves all formatting and looks professional on any device."})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"How many resumes can I save?"}),T.jsx("p",{className:"text-gray-600",children:"Free accounts can save up to 5 resumes in the cloud. This lets you create different versions tailored to specific roles or industries."})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Is my data private?"}),T.jsx("p",{className:"text-gray-600",children:"Absolutely. Your resume data is encrypted (AES-256) and stored securely on Supabase servers. We never share your personal information with third parties. You can delete your data at any time."})]})]})}const hv=({isOpen:t,onClose:n,onSignUp:r})=>{const o=e.useRef(null),i=e.useRef(null);if(e.useEffect(()=>{t&&i.current&&i.current.focus()},[t]),e.useEffect(()=>{const e=e=>{"Escape"===e.key&&t&&n()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[t,n]),e.useEffect(()=>{if(!t||!o.current)return;const e=o.current,n=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=n[0],i=n[n.length-1],s=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===r&&(e.preventDefault(),null==i||i.focus()):document.activeElement===i&&(e.preventDefault(),null==r||r.focus()))};return e.addEventListener("keydown",s),()=>e.removeEventListener("keydown",s)},[t]),!t)return null;return J.createPortal(T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"fixed inset-0 z-[9998] bg-black/50 backdrop-blur-sm animate-fade-in",onClick:e=>{e.target===e.currentTarget&&n()},"aria-hidden":"true"}),T.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:T.jsxs("div",{ref:o,role:"dialog","aria-modal":"true","aria-labelledby":"celebration-modal-title","aria-describedby":"celebration-modal-description",className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 sm:p-8 max-h-[90vh] overflow-y-auto animate-modal-enter",children:[T.jsxs("div",{className:"w-20 h-20 mx-auto mb-6 relative",children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-400 via-emerald-500 to-teal-600 rounded-full flex items-center justify-center animate-scale-in shadow-lg",children:T.jsx("svg",{className:"w-12 h-12 text-white animate-checkmark-draw",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:T.jsx("polyline",{points:"20 6 9 17 4 12",style:{strokeDasharray:"24",strokeDashoffset:"0"}})})}),T.jsx("div",{className:"absolute inset-0 bg-green-400 rounded-full animate-ping opacity-20"})]}),T.jsx("h2",{id:"celebration-modal-title",className:"text-2xl sm:text-3xl font-bold text-center mb-4 text-gray-900",children:"Resume Downloaded Successfully! ðŸŽ‰"}),T.jsx("p",{className:"text-lg text-gray-700 text-center mb-4",children:"Your PDF has been saved to your device."}),T.jsx("div",{id:"celebration-modal-description",className:"bg-amber-50 border-l-4 border-amber-400 p-4 mb-4",children:T.jsxs("p",{className:"text-sm text-amber-800",children:[T.jsx("span",{className:"font-semibold",children:"âš ï¸ Warning:"})," Since you are a guest, this resume is only saved in your browser's temporary cache. If you clear your cache, you will lose this data."]})}),T.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Create a free account to save this version securely to the cloud and edit it anytime."}),T.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3 justify-center",children:[T.jsx("button",{onClick:n,className:"bg-gray-100 text-gray-700 font-medium px-8 py-3.5 rounded-xl hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2",children:"No thanks, I'll risk it"}),T.jsx("button",{ref:i,onClick:r,className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 text-white font-semibold px-8 py-3.5 rounded-xl shadow-lg hover:shadow-xl transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2",children:"Save to Cloud (Free)"})]})]})}),T.jsx("style",{children:"\n        @keyframes scale-in {\n          0% {\n            transform: scale(0);\n            opacity: 0;\n          }\n          50% {\n            transform: scale(1.1);\n          }\n          100% {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n\n        @keyframes checkmark-draw {\n          0% {\n            stroke-dashoffset: 24;\n          }\n          100% {\n            stroke-dashoffset: 0;\n          }\n        }\n\n        @keyframes modal-enter {\n          0% {\n            opacity: 0;\n            transform: scale(0.9) translateY(20px);\n          }\n          100% {\n            opacity: 1;\n            transform: scale(1) translateY(0);\n          }\n        }\n\n        @keyframes fade-in {\n          0% {\n            opacity: 0;\n          }\n          100% {\n            opacity: 1;\n          }\n        }\n\n        .animate-scale-in {\n          animation: scale-in 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;\n        }\n\n        .animate-checkmark-draw {\n          animation: checkmark-draw 0.6s ease-in-out 0.3s forwards;\n        }\n\n        .animate-modal-enter {\n          animation: modal-enter 0.3s ease-out forwards;\n        }\n\n        .animate-fade-in {\n          animation: fade-in 0.2s ease-out forwards;\n        }\n      "})]}),document.body)};const pv=e=>{let{transform:t}=e;return{...t,x:0}},fv=e=>{let{transform:t,draggingNodeRect:n,windowRect:r}=e;return n&&r?function(e,t,n){const r={...e};return t.top+e.y<=n.top?r.y=n.top-t.top:t.bottom+e.y>=n.top+n.height&&(r.y=n.top+n.height-t.bottom),t.left+e.x<=n.left?r.x=n.left-t.left:t.right+e.x>=n.left+n.width&&(r.x=n.left+n.width-t.right),r}(t,n,r):t},mv=e.lazy(()=>Re(()=>import("./NotFound-B0m5iaQ3.js"),__vite__mapDeps([0,1,2]))),gv=e.lazy(()=>Re(()=>import("./ErrorPage-CBulQK1d.js"),__vite__mapDeps([3,1,2]))),bv=()=>T.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:T.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-8 shadow-lg",children:[T.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),T.jsx("p",{className:"text-xl text-gray-600",children:"Loading..."})]})}),xv=new Set(["location.png","email.png","phone.png","linkedin.png","github.png","twitter.png","website.png","pinterest.png","medium.png","youtube.png","stackoverflow.png","behance.png","dribbble.png","company.png","company_google.png","company_amazon.png","company_apple.png","school.png","school_harvard.png","school_oxford.png","school_berkeley.svg","certification_aws.png","certification_azure.png","certification_k8s.png","certification_google.png","certification_devops.png","certification_scrum.png"]),yv=()=>{const{resumeId:t}=je(),{isAtBottom:r,setIsAtBottom:o,setIsSidebarCollapsed:i}=Ee(),[s,a]=e.useState(null),[l,c]=e.useState([]),[d,u]=e.useState(null),[h,p]=e.useState(!1),[f,m]=e.useState(!0),[g,b]=e.useState(null),[x,y]=e.useState(null),v=(()=>{const[t,n]=e.useState({}),r=e.useRef(new Set),o=e.useCallback(e=>{var t;const n=(null==(t=e.name.split(".").pop())?void 0:t.toLowerCase())||"png";let o,i=0;do{o=`${Math.random().toString(36).substring(2,15)}.${n}`,i++}while(r.current.has(o)&&i<100);return i>=100&&(o=`${Date.now()}_${Math.random().toString(36).substring(2,8)}.${n}`),o},[]),i=e.useCallback(e=>{if(e.size>51200){const t=Math.round(e.size/1024),n=Math.round(50);throw new Error(`Icon "${e.name}" is too large (${t} KB). Maximum allowed size is ${n} KB. Please compress the image or use a smaller file.`)}const t=o(e),i={file:e,filename:t,uploadedAt:new Date};return n(e=>({...e,[t]:i})),r.current.add(t),t},[o]),s=e.useCallback((e,t)=>{const o={file:e,filename:t,uploadedAt:new Date};n(e=>({...e,[t]:o})),r.current.add(t)},[]),a=e.useCallback(e=>{const n=t[e];return n?n.file:null},[t]),l=e.useCallback(e=>{n(t=>{const n={...t};return delete n[e],n}),r.current.delete(e)},[]),c=e.useCallback(()=>{n({}),r.current.clear()},[]),d=e.useCallback(()=>Object.keys(t),[t]),u=e.useCallback(()=>Object.keys(t).length,[t]),h=e.useCallback(e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)}),[]),p=e.useCallback((e,t)=>{var n;const r=e.split(","),o=(null==(n=r[0].match(/:(.*?);/))?void 0:n[1])||"application/octet-stream",i=atob(r[1]),s=i.length,a=new Uint8Array(s);for(let l=0;l<s;l++)a[l]=i.charCodeAt(l);return new File([a],t,{type:o})},[]),f=e.useCallback(async e=>{const n=e||Object.keys(t),r={};for(const i of n){const e=t[i];if(e)try{const t=await h(e.file);r[i]={data:t,type:e.file.type,size:e.file.size,uploadedAt:e.uploadedAt.toISOString()}}catch(o){}}return r},[t,h]),m=e.useCallback(async e=>{const t={};for(const[n,i]of Object.entries(e))try{const e=p(i.data,n);t[n]={file:e,filename:n,uploadedAt:new Date(i.uploadedAt)},r.current.add(n)}catch(o){}n(e=>({...e,...t}))},[p]),g=e.useCallback(async()=>({icons:await f(),version:"1.0",timestamp:(new Date).toISOString()}),[f]),b=e.useCallback(async e=>{e.icons&&await m(e.icons)},[m]);return{registerIcon:i,registerIconWithFilename:s,getIconFile:a,removeIcon:l,clearRegistry:c,getRegisteredFilenames:d,getRegistrySize:u,exportIconsForYAML:f,importIconsFromYAML:m,exportForStorage:g,importFromStorage:b}})(),{isAnonymous:w,session:k,loading:C}=Me(),S=!!k&&!w,{hasShownDownloadToast:N,markDownloadToastShown:M,hasShownIdleNudge:O,markIdleNudgeShown:A}=Te(),[D,I]=e.useState(!1),[R,P]=e.useState(t||null),[L,$]=e.useState(!!t),F=e.useCallback(e=>e.map(e=>{if("icon-list"===e.type){const t=e.content.map(e=>{const{iconFile:t,iconBase64:n,...r}=e;return{certification:r.certification||"",issuer:r.issuer||"",date:r.date||"",icon:r.icon?r.icon.startsWith("/icons/")?r.icon.replace("/icons/",""):r.icon:null}});return{...e,content:t}}if(ut(e)||ht(e)){const t=Array.isArray(e.content)?e.content.map(e=>{const{iconFile:t,iconBase64:n,...r}=e;return{...r,icon:r.icon?r.icon.startsWith("/icons/")?r.icon.replace("/icons/",""):r.icon:null}}):e.content;return{...e,content:t}}return e}),[]),{previewUrl:B,isGenerating:U,error:V,isStale:_,generatePreview:H}=function({contactInfo:t,sections:n,templateId:r,iconRegistry:o,processSections:i}){const[s,a]=e.useState(null),[l,c]=e.useState(!1),[d,u]=e.useState(null),[h,p]=e.useState(null),[f,m]=e.useState(""),g=e.useRef(null),b=e.useRef(null),x=e.useCallback(()=>{if(!t)return"";const e=JSON.stringify({contactInfo:t,sections:n});let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r&=r;return r.toString(36)},[t,n]),y=x(),v=""!==f&&y!==f;e.useEffect(()=>()=>{s&&URL.revokeObjectURL(s),b.current&&URL.revokeObjectURL(b.current),g.current&&clearTimeout(g.current)},[s]);const w=e.useCallback(async()=>{if(t&&r){c(!0),u(null);try{const e=i(n),l=gr.dump({contact_info:t,sections:e}),c=new FormData,d=new Blob([l],{type:"application/x-yaml"});c.append("yaml_file",d,"resume.yaml"),c.append("template",r);const u=dt();c.append("session_id",u);const h=pt(n);for(const t of h){const e=o.getIconFile(t);e&&c.append("icons",e,t)}const f=await Pe(c);b.current&&URL.revokeObjectURL(b.current),b.current=s;const x=URL.createObjectURL(f);a(x),p(new Date),m(y),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{},3e4)}catch(e){const t=e instanceof Error?e.message:"Failed to generate preview";u(t)}finally{c(!1)}}else u("Missing contact information or template")},[t,n,r,o,i,s]),k=e.useCallback(()=>{s&&URL.revokeObjectURL(s),a(null),p(null),m(""),u(null),g.current&&clearTimeout(g.current)},[s]);return{previewUrl:s,isGenerating:l,error:d,lastGenerated:h,isStale:v,generatePreview:w,clearPreview:k}}({contactInfo:s,sections:l,templateId:d,iconRegistry:v,processSections:F}),W=n.useMemo(()=>{const e=v.getRegisteredFilenames(),t={};return e.forEach(e=>{const n=v.getIconFile(e);n&&(t[e]=n)}),t},[v.getRegisteredFilenames().join(",")]),{saveStatus:q,lastSaved:K,saveNow:J,resumeId:Y}=function({resumeId:t,resumeData:n,icons:r,enabled:o,session:i}){const[s,a]=e.useState("saved"),[l,c]=e.useState(null),[d,u]=e.useState(t),h=e.useRef(null),p=e.useRef(""),f=async e=>"string"==typeof e?e:new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)}),m=e.useCallback(async()=>{var e;if(!o)return null;try{if(a("saving"),!i)throw new Error("No active session");const e=51200,t=Object.entries(r).map(async([t,n])=>{let r=0;if(n instanceof File)r=n.size;else if("string"==typeof n){const e=n.split(",")[1]||n;r=Math.ceil(3*e.length/4)}return r>e?(Math.round(r/1024),null):{filename:t,data:await f(n)}}),o=(await Promise.all(t)).filter(e=>null!==e),s={id:d,title:(()=>{const e=n.sections.find(e=>"experience"===e.type);if(e&&Array.isArray(e.content)&&e.content.length>0){const t=e.content[0];if("object"==typeof t&&null!==t&&"title"in t&&t.title)return t.title}if(n.contact_info.name){const e=n.template_id.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return`${n.contact_info.name} - ${e}`}return`Resume - ${(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"})}`})(),template_id:n.template_id,contact_info:n.contact_info,sections:n.sections,icons:o};if(!d&&window.location.pathname.includes("/editor/"))return a("error"),null;const l=await j.post("/api/resumes",s);return!d&&l.resume_id&&u(l.resume_id),a("saved"),c(new Date),l.resume_id}catch(t){if(a("error"),t instanceof E&&"RESUME_LIMIT_REACHED"===(null==(e=t.data)?void 0:e.error_code))throw new Error("RESUME_LIMIT_REACHED");return null}},[o,d,n,r,i]),g=e.useCallback(async()=>(h.current&&(clearTimeout(h.current),h.current=null),await m()),[m]);return e.useEffect(()=>{if(!o)return;const e=Object.entries(r).reduce((e,[t,n])=>{let r=0;if(n instanceof File)r=n.size;else if("string"==typeof n){const e=n.split(",")[1]||n;r=Math.ceil(3*e.length/4)}return e[t]=r,e},{}),t=JSON.stringify({contact_info:n.contact_info,sections:n.sections,iconMetadata:e});return t!==p.current?(p.current=t,h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{m().catch(e=>{})},800),()=>{h.current&&clearTimeout(h.current)}):void 0},[o,n,r,m]),e.useEffect(()=>{if(!o)return;const e=()=>{document.hidden&&"saving"!==s&&g().catch(e=>{})};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[o,s,g]),{saveStatus:s,lastSaved:l,saveNow:g,resumeId:d}}({resumeId:R,resumeData:s&&d?{contact_info:s,sections:l,template_id:d}:{contact_info:{},sections:[],template_id:""},icons:W,enabled:!(!d||!s||L||C),session:k});e.useEffect(()=>{Y&&Y!==R&&P(Y)},[Y,R]);const[G,X]=e.useState(!1),[Q,Z]=e.useState(!1),[ee,te]=e.useState(null),[ne,re]=e.useState(""),[oe,ie]=e.useState(!1),se=e.useRef(null),ae=e.useRef(null),le=e.useRef([]),ce=e.useRef(null),[de,ue]=e.useState(!1),[he,pe]=e.useState(!1),[fe,me]=e.useState(!1),[ge,be]=e.useState(!1),xe=e.useRef(null),[ye,ve]=e.useState(!1),[we,ke]=e.useState(null),[Ce,Se]=e.useState(!1),[Ne,Re]=e.useState(!1),[Be,Ue]=e.useState(null),[Ve,_e]=e.useState(!1),[He,We]=e.useState(-1),[qe,Ke]=e.useState(!1),[Je,Ye]=e.useState(!1),[Ge,Xe]=e.useState(!1),[Qe,Ze]=e.useState(!1),[et,tt]=e.useState(null),[nt,rt]=e.useState(null),[ot,it]=e.useState({}),[st,at]=e.useState(new Set),lt=e.useRef({}),ct=e.useRef(0),ft=e.useRef(null),mt=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.useMemo(()=>[...n].filter(e=>null!=e),[...n])}(Fb(Lx,{activationConstraint:{distance:8}}),Fb(Ax,{coordinateGetter:tv})),gt=e.useCallback(async e=>{if(w||!s||!d)return!0;if("saving"===q){const e=1e4,t=Date.now();for(;"saving"===q&&Date.now()-t<e;)await new Promise(e=>setTimeout(e,100));return"error"!==q}try{return null!==await J()||"error"!==q||(Oe.error(`Failed to save changes before ${e}. Please try again.`),!1)}catch(t){return t instanceof Error&&"RESUME_LIMIT_REACHED"===t.message?(I(!0),!1):(Oe.error(`Failed to save changes before ${e}. Please try again.`),!1)}},[w,s,d,q,J]);e.useEffect(()=>{if(t||L)return;if(!d)return;if(s&&l.length>0)return;(async()=>{try{m(!0);const{yaml:e,supportsIcons:t}=await $e(d),n=gr.load(e);a(n.contact_info);const r=yr(n.sections),o=F(r);c(o),p(t),y({contactInfo:n.contact_info,sections:o})}catch(e){b("Failed to load template. Please check your connection and try again.")}finally{m(!1)}})()},[d,t,L]),e.useEffect(()=>{if(C)return;if(!t||!Ae)return;(async()=>{try{if(m(!0),!k)return void Oe.error("Please sign in to load saved resumes");const{resume:n}=await j.get(`/api/resumes/${t}`);a(n.contact_info),c(n.sections),u(n.template_id),P(n.id);const r="modern-with-icons"===n.template_id;p(r),v.clearRegistry();for(const t of n.icons||[])try{const e=await fetch(t.storage_url),n=await e.blob(),r=new File([n],t.filename,{type:n.type});v.registerIconWithFilename(r,t.filename)}catch(e){}Oe.success("Resume loaded successfully"),$(!1)}catch(n){Oe.error(n instanceof Error?n.message:"Failed to load resume"),$(!1)}finally{m(!1)}})()},[t,C,k]);const{preferences:bt,setPreference:xt,isLoading:yt}=De({session:k,authLoading:C}),vt=!bt.tour_completed&&!yt,wt=e.useCallback(async()=>{await xt("tour_completed",!0)},[xt]),[kt,Ct]=e.useState(!1),[St,Nt]=e.useState(!1),[jt,Et]=e.useState(!1);e.useEffect(()=>{vt&&setTimeout(()=>me(!0),1500)},[vt]);const Mt=async()=>{me(!1),await wt()};e.useEffect(()=>{if(w&&!O&&!C)return xe.current=setTimeout(()=>{be(!0),A(),setTimeout(()=>be(!1),1e4)},3e5),()=>{xe.current&&clearTimeout(xe.current)}},[w,O,C,A]);const Tt=(e,t)=>{const n=[...l];n[e]=t,c(n)},Ot=e=>{te(e),re(l[e].name)},At=()=>{if(null===ee)return;const e=[...l];e[ee].name=ne,c(e),te(null)},Dt=()=>{re(""),te(null)},It=e=>{var t;ke({type:"section",sectionIndex:e,sectionName:null==(t=l[e])?void 0:t.name}),ve(!0)},Rt=(e,t)=>{var n;ke({type:"entry",sectionIndex:e,entryIndex:t,sectionName:null==(n=l[e])?void 0:n.name}),ve(!0)},Pt=e=>{We(e);const t=-1===e?ae.current:le.current[e];if(t){const e=-100,n=t.getBoundingClientRect().top+window.pageYOffset+e;window.scrollTo({top:n,behavior:"smooth"})}};e.useEffect(()=>{const e=()=>{const e=window.scrollY+window.innerHeight/3;if(ae.current){const t=ae.current.getBoundingClientRect(),n=t.top+window.scrollY;if(e>=n&&e<n+t.height)return void We(-1)}for(let t=0;t<le.current.length;t++){const n=le.current[t];if(n){const r=n.getBoundingClientRect(),o=r.top+window.scrollY;if(e>=o&&e<o+r.height)return void We(t)}}};return window.addEventListener("scroll",e,{passive:!0}),e(),()=>window.removeEventListener("scroll",e)},[l.length]);const Lt=async()=>{if(await gt("export YAML"))try{Ye(!0),await new Promise(e=>setTimeout(e,1e3));const e=F(l),t=pt(e),n=t.length>0?await v.exportIconsForYAML(t):{},r={contact_info:s,sections:e};Object.keys(n).length>0&&(r.__icons__=n);const o=gr.dump(r),i=new Blob([o],{type:"application/x-yaml"}),a=URL.createObjectURL(i),c=document.createElement("a");c.href=a,c.download="resume.yaml",c.click();const d=Object.keys(n).length,u=d>0?`Resume saved successfully with ${d} embedded icon${1===d?"":"s"}!`:"Resume saved successfully!";Oe.success(u)}catch(e){Oe.error("Save failed. Check browser settings and try again.")}finally{Ye(!1)}},$t=async e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];n&&(Ue(n),Re(!0),e.target.value="")},zt=async()=>{try{if(!(await gt("download PDF")))return;if((null==s?void 0:s.linkedin)&&!Vt(s.linkedin))return void Oe.error("Please enter a valid LinkedIn URL or leave it empty");if(h){const{valid:e,missingIcons:t}=Ht();if(!e)return void Wt(t,L)}X(!0);const e=F(l),t=gr.dump({contact_info:s,sections:e}),n=new FormData,r=new Blob([t],{type:"application/x-yaml"});n.append("yaml_file",r,"resume.yaml"),n.append("template",d||"modern-no-icons");const o=dt();if(n.append("session_id",o),h){const e=pt(l);for(const t of e){const e=v.getIconFile(t);e&&n.append("icons",e,t)}}const{pdfBlob:i,fileName:a}=await ze(n),c=URL.createObjectURL(i),u=document.createElement("a");u.href=c,u.download=a,document.body.appendChild(u),u.click(),document.body.removeChild(u),Oe.success("Resume downloaded successfully!"),w&&!N?(M(),setTimeout(()=>{Et(!0)},500)):w||setTimeout(()=>{Oe("Need to continue on another device? Save your work via the â‹® menu",{icon:"â„¹ï¸"})},2e3)}catch(e){const t=e instanceof Error?e.message:"Unknown error";Oe.error(`Resume generation failed: ${t}`)}finally{X(!1)}},Ft=()=>ue(!de),Bt=async()=>{if(await gt("preview")){if(h){const{valid:e,missingIcons:t}=Ht();if(!e)return void Wt(t,L)}B&&!_||await H(),Z(!0)}},Ut=async()=>{Ze(!0),await new Promise(e=>setTimeout(e,300)),ie(!0),Ze(!1)},Vt=e=>{if(!e.trim())return!0;const t=e.toLowerCase().trim();return/^(https?:\/\/)?([\w\d]+\.)?linkedin\.com\/(?:public-profile\/)?(in|pub)\/[\w-]{3,100}\/?$/.test(t)},_t=(e,t,n)=>{lt.current[e]&&clearTimeout(lt.current[e]),lt.current[e]=setTimeout(()=>{const r=function(e,t,n){const r=function(e,t){if(!t)return"";const n=t.trim().replace(/\/+$/,"");switch(e){case"stackoverflow":const e=n.match(/\/users\/\d+\/([\w\-]+)/i);return e?e[1]:n.split("/").pop()||"";case"medium":const t=n.split("/").pop()||"";return t.startsWith("@")?t:`@${t}`;case"twitter":return`@${n.split("/").pop()||""}`;case"youtube":const r=n.split("/");return r[r.length-1]||"";default:return n.split("/").pop()||""}}(e,t);switch(e){case"linkedin":return n||r||"LinkedIn Profile";case"github":return r||"GitHub";case"twitter":return r||"Twitter";case"website":try{return new URL(t.startsWith("http")?t:`https://${t}`).hostname.replace("www.","")}catch{return"Website"}case"medium":return r||"Medium";case"youtube":return r||"YouTube";case"stackoverflow":return r||"Stack Overflow";case"behance":return r||"Behance";case"dribbble":return r||"Dribbble";case"pinterest":return r||"Pinterest";default:return r||e}}(t,n,null==s?void 0:s.name);a(t=>{if(!t)return null;const n=[...t.social_links||[]];return n[e]&&(n[e]={...n[e],display_text:r}),{...t,social_links:n}}),at(t=>new Set(t).add(e))},500)},Ht=e.useCallback(()=>{if(!h)return{valid:!0,missingIcons:[]};const e=pt(l),t=[];for(const n of e){v.getIconFile(n)||(xv.has(n)||t.push(n))}return{valid:0===t.length,missingIcons:t}},[l,v,h]),Wt=e.useCallback((e,t=!1)=>{if(t)Oe.error(`âš ï¸ Unable to load ${e.length} icon(s) from cloud storage\n\nThis can happen if:\nâ€¢ Icons failed to upload when resume was last saved\nâ€¢ Temporary storage connectivity issue\n\nTo fix:\n1. Re-upload the missing icons using the icon picker\n2. Save your resume\n3. Icons will then be available on next edit\n\nMissing icons:\n${e.map(e=>`â€¢ ${e}`).join("\n")}`,{duration:15e3,style:{whiteSpace:"pre-line",maxWidth:"600px"}});else{const t=e.map(e=>{const t=[];return l.forEach(n=>{if(ut(n)||ht(n)){n.content.forEach((r,o)=>{r.icon===e&&t.push(`${n.name} â†’ Entry ${o+1}`)})}else if("icon-list"===n.type){n.content.forEach((r,o)=>{r.icon===e&&t.push(`${n.name} â†’ Item ${o+1}`)})}}),`â€¢ ${e}${t.length>0?" (used in: "+t.join(", ")+")":""}`}).join("\n");Oe.error(`Missing Icons (${e.length}):\n${t}\n\nPlease upload these icons or remove them from your sections.`,{duration:12e3,style:{whiteSpace:"pre-line"}})}},[l]),qt=()=>{Se(!0)};e.useEffect(()=>{const e=e=>{if(he){e.target.closest(".advanced-menu-container")||pe(!1)}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[he]),e.useEffect(()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&e.shiftKey&&"P"===e.key&&(e.preventDefault(),Bt())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[Bt]);const Kt=e.useCallback(()=>{const e=window.scrollY,t=window.innerHeight,n=document.documentElement.scrollHeight;o(t+e>=n-150),ct.current=e},[o]);return e.useEffect(()=>{const e=()=>{requestAnimationFrame(Kt)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[Kt]),e.useEffect(()=>{if(w||!s||!d)return;const e=e=>{if("saving"===q||"error"===q)return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[w,s,d,q]),e.useEffect(()=>{ft.current=async()=>{if(!w&&s&&d&&"saving"!==q)try{await J();const e=Y||R;e&&Le(e)}catch(e){}}},[w,s,d,q,J,Y,R]),e.useEffect(()=>()=>{ft.current&&ft.current()},[]),f?T.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:T.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-8 shadow-lg",children:[T.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),T.jsx("p",{className:"text-xl text-gray-600",children:"Loading your resume builder..."})]})}):g?T.jsx(e.Suspense,{fallback:T.jsx(bv,{}),children:T.jsx(gv,{})}):d||t?T.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[T.jsxs("div",{className:"mx-auto px-4 sm:px-6 lg:px-8 pt-6 pb-72 sm:pb-56 lg:pb-12 max-w-4xl lg:max-w-none transition-all duration-300 "+(qe?"lg:mr-[88px]":"lg:mr-[296px]"),children:[s&&T.jsx("div",{ref:ae,children:T.jsx(Cr,{contactInfo:s,onUpdate:a,socialLinkErrors:ot,onSocialLinkChange:(e,t,n)=>{var r,o;if(a(r=>{if(!r)return null;const o=[...r.social_links||[]];return o[e]||(o[e]={platform:"",url:"",display_text:""}),o[e]={...o[e],[t]:n},{...r,social_links:o}}),"url"===t){const t=null==(r=null==s?void 0:s.social_links)?void 0:r[e],o=(null==t?void 0:t.platform)||"";if(!n.trim())return it(t=>{const n={...t};return delete n[e],n}),a(t=>{if(!t)return null;const n=[...t.social_links||[]];return n[e]&&(n[e]={...n[e],display_text:""}),{...t,social_links:n}}),void at(t=>{const n=new Set(t);return n.delete(e),n});if(o){const t=kr(o,n);!t.valid&&t.error?it(n=>({...n,[e]:t.error||""})):(it(t=>{const n={...t};return delete n[e],n}),_t(e,o,n))}}else if("platform"===t){const t=null==(o=null==s?void 0:s.social_links)?void 0:o[e],r=(null==t?void 0:t.url)||"";if(r&&n){const t=kr(n,r);!t.valid&&t.error?it(n=>({...n,[e]:t.error||""})):(it(t=>{const n={...t};return delete n[e],n}),_t(e,n,r))}}else"display_text"===t&&at(t=>{const n=new Set(t);return n.delete(e),n})},onAddSocialLink:()=>{a(e=>{if(!e)return null;const t=e.social_links||[];return{...e,social_links:[...t,{platform:"",url:"",display_text:""}]}})},onRemoveSocialLink:e=>{a(t=>{if(!t)return null;const n=(t.social_links||[]).filter((t,n)=>n!==e);return{...t,social_links:n}}),it(t=>{const n={...t};return delete n[e],n}),at(t=>{const n=new Set(t);return n.delete(e),n}),lt.current[e]&&(clearTimeout(lt.current[e]),delete lt.current[e])},autoGeneratedIndexes:st})}),T.jsx(Sr,{}),T.jsxs(wy,{sensors:mt,collisionDetection:Jb,onDragStart:e=>{const{active:t}=e;tt(t.id);const n=parseInt(t.id);rt(l[n])},onDragEnd:e=>{const{active:t,over:n}=e;if(t.id!==(null==n?void 0:n.id)){const e=parseInt(t.id),r=parseInt(null==n?void 0:n.id);void 0!==e&&void 0!==r&&(c(t=>$y(t,e,r)),Oe.success("Section reordered successfully!"))}tt(null),rt(null)},onDragCancel:()=>{tt(null),rt(null)},modifiers:[pv,fv],children:[T.jsx(Wy,{items:l.map((e,t)=>t.toString()),strategy:Vy,children:l.map((e,t)=>ut(e)?T.jsx(rv,{id:t.toString(),disabled:!1,children:T.jsx("div",{ref:e=>{le.current[t]=e,t===l.length-1&&(se.current=e)},children:T.jsx(Wg,{sectionName:e.name,experiences:e.content,onUpdate:n=>Tt(t,{...e,content:n}),onTitleEdit:()=>Ot(t),onTitleSave:At,onTitleCancel:Dt,onDelete:()=>It(t),onDeleteEntry:e=>Rt(t,e),isEditingTitle:ee===t,temporaryTitle:ne,setTemporaryTitle:re,supportsIcons:h,iconRegistry:v})})},t):ht(e)?T.jsx(rv,{id:t.toString(),disabled:!1,children:T.jsx("div",{ref:e=>{le.current[t]=e,t===l.length-1&&(se.current=e)},children:T.jsx(qg,{sectionName:e.name,education:e.content,onUpdate:n=>Tt(t,{...e,content:n}),onTitleEdit:()=>Ot(t),onTitleSave:At,onTitleCancel:Dt,onDelete:()=>It(t),onDeleteEntry:e=>Rt(t,e),isEditingTitle:ee===t,temporaryTitle:ne,setTemporaryTitle:re,supportsIcons:h,iconRegistry:v})})},t):"icon-list"===e.type?T.jsx(rv,{id:t.toString(),disabled:!1,children:T.jsx("div",{ref:e=>{le.current[t]=e,t===l.length-1&&(se.current=e)},children:T.jsx(Yg,{data:e.content,onUpdate:n=>Tt(t,{...e,content:n}),onDelete:()=>It(t),onDeleteEntry:e=>Rt(t,e),sectionName:e.name,onEditTitle:()=>Ot(t),onSaveTitle:At,onCancelTitle:Dt,isEditing:ee===t,temporaryTitle:ne,setTemporaryTitle:re,iconRegistry:v})})},t):T.jsx(rv,{id:t.toString(),disabled:!1,children:T.jsx("div",{ref:e=>{le.current[t]=e,t===l.length-1&&(se.current=e)},children:T.jsx(Jg,{section:e,onUpdate:e=>Tt(t,e),onEditTitle:()=>Ot(t),onSaveTitle:At,onCancelTitle:Dt,onDelete:()=>It(t),onDeleteEntry:e=>Rt(t,e),isEditing:ee===t,temporaryTitle:ne,setTemporaryTitle:re})})},t))}),T.jsx(Ly,{modifiers:[pv],children:et&&nt?T.jsx("div",{className:"drag-overlay",children:"Experience"===nt.name?T.jsx(Wg,{sectionName:nt.name,experiences:nt.content,onUpdate:()=>{},onTitleEdit:()=>{},onTitleSave:()=>{},onTitleCancel:()=>{},onDelete:()=>{},isEditingTitle:!1,temporaryTitle:"",setTemporaryTitle:()=>{},supportsIcons:h,iconRegistry:v}):"Education"===nt.name?T.jsx(qg,{sectionName:nt.name,education:nt.content,onUpdate:()=>{},onTitleEdit:()=>{},onTitleSave:()=>{},onTitleCancel:()=>{},onDelete:()=>{},isEditingTitle:!1,temporaryTitle:"",setTemporaryTitle:()=>{},supportsIcons:h,iconRegistry:v}):"icon-list"===nt.type?T.jsx(Yg,{data:nt.content,onUpdate:()=>{},onDelete:()=>{},sectionName:nt.name,onEditTitle:()=>{},onSaveTitle:()=>{},onCancelTitle:()=>{},isEditing:!1,temporaryTitle:"",setTemporaryTitle:()=>{},iconRegistry:v}):T.jsx(Jg,{section:nt,onUpdate:()=>{},onEditTitle:()=>{},onSaveTitle:()=>{},onCancelTitle:()=>{},onDelete:()=>{},isEditing:!1,temporaryTitle:"",setTemporaryTitle:()=>{}})}):null})]}),r&&T.jsx("div",{className:"fixed left-0 right-0 z-50 transition-all duration-300 bottom-80 sm:bottom-64 lg:bottom-48 px-4 lg:hidden",children:T.jsx("div",{className:"max-w-screen-lg mx-auto",children:T.jsx("div",{className:"bg-white/50 backdrop-blur-sm rounded-full shadow-sm border border-white/30 h-0.5 w-full"})})}),T.jsx("div",{className:"hidden md:flex lg:hidden fixed z-[60] bg-gradient-to-r from-slate-50/80 via-blue-50/80 to-indigo-50/80 backdrop-blur-sm shadow-lg transition-all duration-300\n            left-auto right-6 border border-gray-200/60 rounded-2xl w-auto max-w-none "+(r?"bottom-24":"bottom-6"),children:T.jsx("div",{className:"flex items-center justify-between gap-2 sm:gap-4 p-4 lg:p-6 max-w-screen-lg mx-auto lg:max-w-none",children:T.jsx(Xg,{onAddSection:Ut,onGenerateResume:zt,onExportYAML:Lt,onImportYAML:$t,onToggleHelp:Ft,onLoadEmptyTemplate:qt,loadingAddSection:Qe,generating:G,loadingSave:Je,loadingLoad:Ge,showAdvancedMenu:he,setShowAdvancedMenu:pe,mode:"integrated"})})}),T.jsx(Qg,{onNavigationClick:()=>_e(!0),onPreviewClick:Bt,onDownloadClick:zt,isSaving:"saving"===q,isGenerating:G,isGeneratingPreview:U,previewIsStale:_,lastSaved:K,saveError:"error"===q}),T.jsx(Zg,{isOpen:Ve,onClose:()=>_e(!1),sections:l,onSectionClick:Pt,activeSectionIndex:He,onAddSection:Ut,onExportYAML:Lt,onImportYAML:()=>{var e;return null==(e=ce.current)?void 0:e.click()},onStartFresh:qt,onHelp:Ft,loadingSave:Je,loadingLoad:Ge}),T.jsx(rb,{sections:l,onSectionClick:Pt,activeSectionIndex:He,onAddSection:Ut,onDownloadResume:zt,onPreviewResume:Bt,onExportYAML:Lt,onImportYAML:()=>{var e;return null==(e=ce.current)?void 0:e.click()},onStartFresh:qt,onHelp:Ft,isGenerating:G,isGeneratingPreview:U,previewIsStale:_,loadingSave:Je,loadingLoad:Ge,onCollapseChange:e=>{Ke(e),i(e)},saveStatus:q,lastSaved:K,isAnonymous:w,isAuthenticated:S,onSignInClick:()=>Nt(!0)}),T.jsx("input",{ref:ce,type:"file",accept:".yaml,.yml",className:"hidden",onChange:$t}),r&&T.jsx("div",{className:"fixed left-0 right-0 z-50 transition-all duration-300 bottom-64 sm:bottom-48 lg:bottom-20 px-4 lg:hidden",children:T.jsx("div",{className:"max-w-screen-lg mx-auto",children:T.jsx("div",{className:"bg-white/50 backdrop-blur-sm rounded-full shadow-sm border border-white/30 h-0.5 w-full"})})})]}),T.jsx(iv,{isOpen:fe,onClose:Mt,isAnonymous:w,isAuthenticated:S,onSignInClick:()=>Ct(!0),onTourComplete:Mt}),T.jsx(Ie,{isOpen:kt,onClose:()=>Ct(!1),onSuccess:()=>{Ct(!1),Oe.success("Welcome! Your resume will now be saved to the cloud.")}}),T.jsx(Ie,{isOpen:St,onClose:()=>Nt(!1),onSuccess:()=>{Nt(!1),Oe.success("Welcome! Your resume will now be saved to the cloud.")}}),T.jsx(hv,{isOpen:jt,onClose:()=>Et(!1),onSignUp:()=>{Et(!1),Nt(!0)}}),T.jsx(av,{isOpen:de,onClose:()=>ue(!1),isAnonymous:w,onSignInClick:()=>{ue(!1),Nt(!0)}}),oe&&T.jsx(Gg,{onClose:()=>ie(!1),onSelect:e=>{const t=(e=>{const t={experience:"New Experience Section",education:"New Education Section",text:"New Text Section","bulleted-list":"New Bulleted List Section","inline-list":"New Inline List Section","dynamic-column-list":"New Dynamic Column List Section","icon-list":"New Icon List Section"}[e]||"New Section",n=l.map(e=>e.name.toLowerCase());if(!n.includes(t.toLowerCase()))return t;let r=2,o=`${t} ${r}`;for(;n.includes(o.toLowerCase());)r++,o=`${t} ${r}`;return o})(e);let n;n="experience"===e?[{company:"",title:"",dates:"",description:[""],icon:null}]:"education"===e?[{degree:"",school:"",year:"",field_of_study:"",icon:null}]:["bulleted-list","inline-list","dynamic-column-list","icon-list"].includes(e)?[]:"";const r={name:t,type:e,content:n};c(e=>[...e,r]),ie(!1),setTimeout(()=>{var e;null==(e=se.current)||e.scrollIntoView({behavior:"smooth"})},100)},supportsIcons:h}),T.jsx(ob,{isOpen:ye,onClose:()=>{ve(!1),ke(null)},onConfirm:()=>{if(we){if("section"===we.type){const e=l.filter((e,t)=>t!==we.sectionIndex);c(e),Oe.success(`Section "${we.sectionName}" deleted`)}else if("entry"===we.type&&void 0!==we.entryIndex){const e=[...l],t=e[we.sectionIndex];if(Array.isArray(t.content)){const n=t.content.filter((e,t)=>t!==we.entryIndex);e[we.sectionIndex]={...t,content:n},c(e),Oe.success(`Entry deleted from "${t.name}"`)}}ke(null),ve(!1)}},title:"section"===(null==we?void 0:we.type)?"Delete Section?":"Delete Entry?",message:"section"===(null==we?void 0:we.type)?`Are you sure you want to delete the "${we.sectionName}" section? This will remove all content in this section and cannot be undone.`:"Are you sure you want to delete this entry? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",isDestructive:!0}),T.jsx(ob,{isOpen:Ce,onClose:()=>Se(!1),onConfirm:async()=>{if(x){if(!w&&s&&l.length>0){if(!(await gt("start fresh")))return void Se(!1)}Se(!1),Ye(!0);try{a({name:"",location:"",email:"",phone:"",linkedin:"",linkedin_display:""});const e=x.sections.map(e=>({...e,content:Array.isArray(e.content)?[]:""}));c(e),v.clearRegistry(),Oe.success("Template cleared successfully!")}catch(e){Oe.error("Failed to clear template")}finally{Ye(!1)}}},title:"Start Fresh?",message:"Starting fresh will permanently delete all your current work. This action cannot be undone. Are you sure you want to continue?",confirmText:"Start Fresh",cancelText:"Cancel",isDestructive:!0,isLoading:Je}),T.jsx(ob,{isOpen:Ne,onClose:()=>{Re(!1),Ue(null)},onConfirm:async()=>{if(!Be)return;if(Re(!1),!w&&s&&l.length>0){if(!(await gt("import YAML")))return void Ue(null)}Xe(!0);const e=new FileReader;e.onload=async e=>{var t;try{await new Promise(e=>setTimeout(e,1200));const n=gr.load(null==(t=e.target)?void 0:t.result);a(n.contact_info),n.__icons__&&Object.keys(n.__icons__).length>0&&await v.importIconsFromYAML(n.__icons__);const r=yr(n.sections),o=F(r);if(!h){const e=pt(o);e.length>0&&Oe(`This template doesn't support icons. ${e.length} icon(s) were found in the imported file and will be ignored.`,{duration:8e3,icon:"âš ï¸"})}c(o),y({contactInfo:n.contact_info,sections:o}),$(!1),Oe.success("Resume loaded successfully!")}catch(n){Oe.error("Invalid file format. Please upload a valid resume file.")}finally{Xe(!1),Ue(null)}},e.readAsText(Be)},title:"Confirm Import?",message:"Importing this will override your existing content.",confirmText:"Confirm Import",cancelText:"Cancel Import",isDestructive:!0,isLoading:Ge}),T.jsx(Fe,{isOpen:Q,onClose:()=>{Z(!1)},previewUrl:B,isGenerating:U,isStale:_,error:V,onRefresh:async()=>{if(await gt("refresh preview")){if(h){const{valid:e,missingIcons:t}=Ht();if(!e)return void Wt(t,L)}await H()}},onDownload:zt}),T.jsx(br,{isOpen:D,onClose:()=>I(!1)}),ge&&z.createPortal(T.jsx("div",{className:"fixed top-20 right-6 z-[70] bg-blue-600 text-white text-sm px-4 py-3 rounded-lg shadow-xl animate-bounce",children:T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("span",{children:"ðŸ’¡"}),T.jsx("span",{children:"Don't forget to save your progress permanently"}),T.jsx("button",{onClick:()=>be(!1),className:"ml-2 hover:opacity-75 text-white",children:"âœ•"})]})}),document.body)]}):T.jsx(e.Suspense,{fallback:T.jsx(bv,{}),children:T.jsx(mv,{})})};export{yv as default};
